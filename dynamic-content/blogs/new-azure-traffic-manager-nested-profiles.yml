### YamlMime:Yaml
ms.openlocfilehash: 9fd50b2b7cb9f241877d47d7d6ade72e068454ee
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139902501"
Slug: new-azure-traffic-manager-nested-profiles
Title: '새로 만들기: Azure Traffic Manager 중첩 프로필'
Summary: 이제 Azure 고객은 트래픽 관리를 위해 중첩 프로필을 만들 수 있습니다. 이렇게 하면 더 크고 복잡한 배포의 요구를 지원하기 위해 강력한 부하 분산 및 장애 조치(failover) 체계를 만드는 데 엄청난 유연성이 있습니다.
Content: >-
  Azure Traffic Manager 중첩된 Traffic Manager 프로필에 대한 지원을 발표하게 되어 기쁩니다. 이 기능을 사용하면 더 크고 복잡한 배포의 요구를 지원하기 위해 보다 유연하고 강력한 부하 분산 및 장애 조치(failover) 체계를 만들 수 있습니다.


  이 기능은 이제 REST API 및 PowerShell cmdlet을 통해 지원됩니다.

  <h1>소개</h1>

  Traffic Manager 사용하면 여러 Azure 배포에서 들어오는 트래픽의 부하를 분산할 수 있습니다. Traffic Manager 사용하도록 설정된 주요 시나리오에는 최종 사용자를 가장 가까운 배포로 안내하여 애플리케이션 성능을 개선하고 서비스를 모니터링하고 서비스가 중단될 때 자동 장애 조치(failover)를 제공하여 고가용성을 사용하도록 설정하는 것이 포함됩니다. 또한 <a href="https://azure.microsoft.com/blog/2014/06/26/azure-traffic-manager-external-endpoints-and-weighted-round-robin-via-powershell/">최근에 Azure 외부의 가중 트래픽 배포 및 엔드포인트에 대한 지원을 발표</a>했으며, 이를 통해 장애 조치(failover-to-cloud), 버스트-클라우드 및 온-프레미스에서 클라우드로의 마이그레이션과 같은 다양한 추가 시나리오를 사용할 수 있습니다.


  오늘 중첩된 Traffic Manager 프로필이라는 또 다른 새로운 기능을 발표하게 되어 기쁩니다. 이 기능을 사용하면 더 크고 복잡한 배포의 요구를 지원하기 위해 보다 유연하고 강력한 부하 분산 및 장애 조치(failover) 체계를 만들 수 있습니다.


  중첩 프로필은 <a href="https://msdn.microsoft.com/en-us/library/azure/hh758255.aspx">REST API</a> 및 PowerShell cmdlet을 통해서만 만들 수 있습니다(<a href="https://azure.microsoft.com/en-us/documentation/articles/install-configure-powershell/">Azure PowerShell 시작하는 방법은</a> 다음과 같습니다. 버전 0.8.8 이상이 필요합니다.) Azure 관리 포털을 통해 만들 수 없습니다.


  이 블로그 게시물의 나머지 부분에서는 몇 가지 예제를 사용하여 이 기능의 기능 및 사용 방법을 설명합니다.

  <h2>예제 1: 성능 부하 분산을 사용하여 새 배포 평가판</h2>

  애플리케이션이 미국 동부, 미국 서부, 유럽 북부, 유럽 서부, 동아시아 및 동남 아시아와 같은 여러 Azure 지역에 배포되었다고 가정합니다. Traffic Manager '성능' 부하 분산 방법을 사용하여 사용자에게 가장 가까운 지역에 트래픽을 분산합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/1.-Performance-Load-Balancing.png"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border-width: 0px;" title="1. 성능 Load-Balancing" alt="1. Performance Load-Balancing" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1.-Performance-Load-Balancing_thumb.png" width="614" height="286" border="0" /></a>


  이제 광범위하게 롤아웃하기 전에 소수의 사용자를 대상으로 서비스 업데이트를 시도한다고 가정합니다. 이를 위해 적은 비율의 트래픽을 평가판 배포로 보낼 수 있는 '가중 라운드 로빈' 부하 분산 방법을 사용하려고 합니다. 이전에는 이를 성능 부하 분산과 결합할 수 없었습니다. 이제 중첩된 프로필을 사용하여 두 가지 작업을 모두 수행할 수 있습니다.


  방법은 다음과 같습니다. 유럽 북부에서 새 배포를 평가하려는 경우를 가정해 보겠습니다. 기존 배포와 함께 평가판 배포를 설정하고 이러한 두 엔드포인트와 가중 라운드 로빈 부하 분산 방법을 사용하여 Traffic Manager 프로필을 만듭니다. 그런 다음 성능 부하 분산 방법을 사용하는 '부모' 프로필에 이 '자식' 프로필을 <i>엔드포인트로</i> 추가합니다.


  다음 다이어그램 및 PowerShell 코드 조각은 이 예제를 보여 줍니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/2.-Nested-Load-Balancing-Performance-Weights.png"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border-width: 0px;" title="2. 중첩된 부하 분산, 성능 가중치" alt="2. Nested Load-Balancing, Performance   Weights" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2.-Nested-Load-Balancing-Performance-Weights_thumb.png" width="614" height="439" border="0" /></a>

  <pre class="prettyprint"># Create child profile


  $child = New-AzureTrafficManagerProfile -Name "eunorth-child" -DomainName "eunorth.trafficmanager.net" -LoadBalancingMethod "RoundRobin" -Ttl 30 -MonitorProtocol "Http" -MonitorPort 80 -MonitorRelativePath "/"


  $child = Add-AzureTrafficManagerEndpoint -TrafficManagerProfile $child -DomainName "eunorth.cloudapp.net" -Status "Enabled" -Type "CloudService" -Weight 99


  $child = Add-AzureTrafficManagerEndpoint -TrafficManagerProfile $child -DomainName "eunorth-new.cloudapp.net" -Status "Enabled" -Type "CloudService" -Weight 1


  Set-AzureTrafficManagerProfile –TrafficManagerProfile $child


  # Create parent profile


  $parent = New-AzureTrafficManagerProfile -Name "parent" -DomainName "myapp.trafficmanager.net" -LoadBalancingMethod "Performance" -Ttl 30 -MonitorProtocol "Http" -MonitorPort 80 -MonitorRelativePath "/"


  $parent = Add-AzureTrafficManagerEndpoint -TrafficManagerProfile $parent -DomainName "eunorth.trafficmanager.net" -Status "Enabled" -Type "TrafficManager" -Location "North Europe"


  $parent = Add-AzureTrafficManagerEndpoint -TrafficManagerProfile $parent -DomainName "euwest.cloudapp.net" -Status "Enabled" -Type "CloudService"


  # Repeat above line for other endpoints


  Set-AzureTrafficManagerProfile –TrafficManagerProfile $parent</pre>

  이 구성에서 부모 프로필을 통해 전달된 트래픽은 여러 지역 간에 정상적으로 분산됩니다. 유럽 북부 내에서 할당한 가중치에 따라 기존 배포와 평가판 배포 간에 트래픽이 전달됩니다.


  성능 부하 분산 방법을 사용하는 부모에 자식 프로필을 할당할 때 자식 프로필의 위치를 지정했습니다(외부 엔드포인트의 위치를 지정하는 것과 정확히 동일한 방식으로 유형 = 'Any'를 사용하여 이전 <a href="https://azure.microsoft.com/blog/2014/06/26/azure-traffic-manager-external-endpoints-and-weighted-round-robin-via-powershell/">블로그 게시물</a> 참조).

  <h2>중첩 프로필의 엔드포인트 모니터링</h2>

  Traffic Manager 각 서비스 엔드포인트의 상태를 적극적으로 모니터링합니다(방법은 다음과 같습니다). 엔드포인트가 비정상 상태로 확인되는 경우 Traffic Manager는 사용자를 대체 엔드포인트로 보내므로 서비스의 전반적인 가용성이 유지됩니다. 이 엔드포인트 모니터링 및 장애 조치(failover) 동작은 모든 부하 분산 방법('장애 조치(failover)' 방법뿐만 아니라)에 사용할 수 있습니다.


  중첩 프로필의 경우 엔드포인트 모니터링이 약간 다르게 작동합니다. 부모 프로필이 자식 프로필을 중첩된 엔드포인트로 구성된 경우 부모는 자식 프로필을 직접 검색하지 않습니다. 대신 자식 프로필 엔드포인트의 상태는 자식 프로필의 전체 상태를 계산하는 데 사용되며, 이는 부모 프로필이 트래픽을 자식으로 보낼지 여부를 결정합니다.


  이전 예제로 돌아가기: 유럽 북부의 기존 배포가 실패한다고 가정합니다. 기본적으로 '자식' 프로필은 평가판 배포로 모든 트래픽을 전달합니다. 또한 실패하면 부모 프로필은 모든 자식 엔드포인트가 비정상이므로 자식 프로필이 트래픽을 수신하지 않아야 하며 모든 유럽 북부 트래픽을 다른 지역으로 장애 조치(failover)하도록 결정합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/3.-MinChildEndpoints-1.png"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="3. MinChildEndpoints = 1" alt="3. MinChildEndpoints = 1" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3.-MinChildEndpoints-1_thumb.png" width="614" height="439" border="0" /></a>


  이 배열에 만족하거나 평가판 배포가 모든 유럽 북부 트래픽에 대한 장애 조치(failover)로 사용되어서는 안 된다고 우려할 수 있습니다. 평가판 배포의 상태에 <i>관계없이</i> 유럽 북부의 기존 배포가 실패하는 경우 다른 지역으로 장애 조치(failover)하는 것이 좋습니다. 부모 프로필에서 자식 프로필을 엔드포인트로 구성할 때 자식 프로필에서 사용할 수 있어야 하는 최소 엔드포인트 수를 결정하는 'MinChildEndpoints' 매개 변수를 지정할 수도 있습니다. 이 임계값(기본값은 1)보다 낮으면 부모 프로필은 전체 자식 프로필을 사용할 수 없는 것으로 간주하고 대신 다른 부모 프로필 엔드포인트로 트래픽을 전달합니다.


  아래 예제에서는 MinChildEndpoints가 2로 설정된 상태에서 유럽 북부에서의 배포 <i>가</i> 실패하면 부모 프로필에서 자식 프로필이 트래픽을 수신하지 않아야 하며 사용자가 다른 지역으로 전달되도록 결정합니다.

  <h3><a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/4.-MinChildEndpoints-2.png"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="4. MinChildEndpoints = 2" alt="4. MinChildEndpoints = 2" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4.-MinChildEndpoints-2_thumb.png" width="614" height="439" border="0" /></a></h3>

  자식 프로필이 '장애 조치( failover)' 부하 분산 방법을 사용하는 경우 해당 자식에 대한 모든 트래픽은 단일 엔드포인트에서 수신됩니다. 따라서 이 경우 MinChildEndpoints 설정에 '1'이 아닌 작은 값이 지정됩니다.

  <h2>예제 2: 장애 조치(failover) In-Geo</h2>

  원래 예제(첫 번째 그림)에서 엔드포인트(예: 유럽 북부)가 실패하면 해당 엔드포인트로 전달된 모든 트래픽이 다른 엔드포인트, 모든 지역에 분산됩니다(이 동작은 '다음으로 가장 가까운' 엔드포인트의 오버로드를 방지하도록 설계된 Traffic Manager 성능 부하 분산 방법의 기본 동작임).


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/5.-Performance-Failover.png"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="5. 성능 장애 조치(failover)" alt="5. Performance Failover" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5.-Performance-Failover_thumb.png" width="614" height="286" border="0" /></a>


  그러나 기본 설정에 따라 유럽 북부 트래픽이 유럽 서부로 장애 조치(failover)되는 것을 선호하며, 두 엔드포인트를 모두 사용할 수 없는 경우에만 다른 곳으로 직접 전송하는 것을 선호한다고 가정합니다. 다음과 같이 장애 조치(failover) 부하 분산 방법을 사용하는 자식 프로필을 만들어 이 작업을 수행할 수 있습니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/6.-Performance-with-in-Geo-Failover.png"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="6. 지역 내 장애 조치(failover)를 사용하는 성능" alt="6. Performance with in-Geo Failover" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6.-Performance-with-in-Geo-Failover_thumb.png" width="614" height="439" border="0" /></a>


  부모 프로필의 6개 엔드포인트를 모두 6개의 자식 프로필로 바꿔 지역 내 장애 조치(failover)를 제공하는 모든 지역에 대해 이 패턴을 반복할 수 있습니다.

  <h2>예제 3: Per-Endpoint 모니터링 설정</h2>

  Traffic Manager를 사용하여 기존 온-프레미스 웹 사이트와 Azure에서 호스트되는 새로운 클라우드 기반 버전 사이에서 원활하게 트래픽을 마이그레이션하고 있다고 가정하겠습니다.기존 사이트의 경우 홈페이지(경로 '/')를 사용하여 사이트 상태를 모니터링하려고 하지만, 새로운 클라우드 기반 버전의 경우에는 추가 검사를 포함하는 사용자 지정 모니터링 페이지(경로 ‘/monitor.aspx’)를 구현합니다.


  Traffic Manager 프로필의 모니터링 설정은 프로필 내의 모든 엔드포인트에 적용됩니다. 즉, 이전에 두 사이트에서 동일한 경로를 사용해야 했습니다.이제 중첩된 Traffic Manager 프로필이 릴리스되면 사이트당 자식 프로필을 사용하여 사이트당 다양한 모니터링 설정을 정의할 수 있습니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/7.-Per-Endpoint-Monitoring-Settings.png"><img style="padding-top: 0px; padding-left: 0px; padding-right: 0px; border: 0px;" title="7.Per-Endpoint 모니터링 설정" alt="7. Per-Endpoint Monitoring Settings" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7.-Per-Endpoint-Monitoring-Settings_thumb.png" width="614" height="392" border="0" /></a>

  <h1>FAQ</h1>

  <b>Azure 관리 포털을 통해 중첩 프로필을 사용할 수 있나요?</b>


  중첩된 Traffic Manager 프로필은 현재 REST API 및 PowerShell cmdlet을 통해서만 구성할 수 있습니다. Azure 관리 포털을 통해 만들 수 없습니다.


  그러나 Azure 관리 포털을 계속 사용하여 중첩된 프로필을 사용하여 프로필의 상태를 확인하고, 엔드포인트 사용 및 사용 안 함 또는 모니터링 설정 구성과 같은 해당 프로필의 다른 설정을 관리할 수도 있습니다.


  <b>트래픽 관리자가 지원하는 중첩 계층 수는 얼마나 되나요?</b>


  프로필을 최대 10개 수준까지 중첩할 수 있습니다(이유는 상상할 수 없지만!) '루프'는 허용되지 않습니다.


  <b>다른 엔드포인트 유형(Cloud Services, 웹 사이트 및 외부 엔드포인트)을 동일한 Traffic Manager 프로필에 중첩된 '자식' 프로필과 혼합할 수 있나요?</b>


  예. 프로필 내에서 서로 다른 유형의 엔드포인트를 결합하는 방법에는 제한이 없습니다.


  <b>중첩 프로필에는 요금 청구 모델이 어떻게 적용되나요?</b>


  Traffic Manager 청구에는 모니터링되는 엔드포인트당 및 백만 개의 DNS 쿼리당 두 가지 구성 요소가 있습니다(자세한 내용은 <a href="https://azure.microsoft.com/en-us/pricing/details/traffic-manager/">가격 책정 페이지</a> 참조). 중첩 프로필에 적용되는 방법은 다음과 같습니다.

  <ul>
   <li>모니터링되는 엔드포인트당: 부모 프로필에서 엔드포인트로 구성된 경우 자식 프로필에 대한 요금이 부과되지 않습니다. 기본 서비스를 모니터링하는 자식 프로필의 엔드포인트의 경우 요금이 일반적인 방식으로 청구됩니다.</li>
   <li>백만 DNS 쿼리당: 각 쿼리는 한 번만 계산됩니다. 자식 프로필의 엔드포인트를 반환하는 부모 프로필에 대한 쿼리는 부모 프로필에 대해서만 요금이 청구됩니다.</li>
  </ul>

  <b>Azure Traffic Manager 대한 자세한 내용은 어디에서 확인할 수 있나요?</b>


  Azure Portal에는 Traffic Manager 서비스 및 시나리오에 대한 <a href="https://azure.microsoft.com/en-us/documentation/services/traffic-manager/">개요</a>가 포함되어 있습니다. <a href="https://azure.microsoft.com/en-us/pricing/details/traffic-manager/">또한 가격 책정</a> 및 <a href="https://azure.microsoft.com/en-us/support/legal/sla/">SLA</a> 세부 정보도 포함합니다.


  MSDN에는 Traffic Manager 부하 분산 방법 및 엔드포인트 모니터링 및 구성에 대한 설명을 포함하여 보다 자세한 개요가 포함되어 있습니다.MSDN은 Traffic Manager <a href="https://msdn.microsoft.com/en-us/library/azure/hh758255.aspx" target="_blank">REST API</a>, <a href="https://msdn.microsoft.com/en-us/library/azure/microsoft.windowsazure.management.trafficmanager(v=azure.11).aspx" target="_blank">.NET 관리 라이브러리</a> 및 PowerShell cmdlet에 대한 참조 설명서도 호스팅합니다.


  <a href="https://azure.microsoft.com/blog/2014/06/26/azure-traffic-manager-external-endpoints-and-weighted-round-robin-via-powershell/" target="_blank">이 이전 블로그 게시물</a>에서는 외부 엔드포인트 및 가중 프로필 구성을 포함하여 Azure Traffic Manager PowerShell을 시작하는 방법을 설명합니다.


  AZURE의 유료 지원 계획 외에도 <a href="https://social.msdn.microsoft.com/Forums/windowsazure/en-US/home?forum=windowsazureconnectivity">MSDN 포럼</a>을 사용하여 DNS 또는 Traffic Manager 관련된 Azure의 모든 측면에 대해 질문할 수 있습니다. 기능 제안은 피드백 <a href="https://feedback.azure.com/forums/217313-networking-dns-traffic-manager-vpn-vnet/category/77466-domain-name-service-dns-traffic-manager">사이트에</a> 게시해야 하며, 여기서 기존 제안에 대해 투표할 수도 있습니다.
