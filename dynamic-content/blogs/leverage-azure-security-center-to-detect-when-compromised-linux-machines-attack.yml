### YamlMime:Yaml
ms.openlocfilehash: 049064b849ba62d4432e919dbc9f8624cd1574ec
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139908321"
Slug: leverage-azure-security-center-to-detect-when-compromised-linux-machines-attack
Title: Azure Security Center를 활용하여 손상된 Linux 머신 공격 시기 감지
Summary: 공격자가 컴퓨터를 손상하는 경우 일반적으로 목표를 염두에 두고 있습니다. 일부 공격자는 피해자의 컴퓨터에 있는 정보를 찾고 있거나 피해자 네트워크의 다른 컴퓨터에 대한 액세스를 찾고 있습니다. 공격자는 컴퓨터 자체의 처리 능력을 사용하거나 다른 공격의 시작 지점으로 컴퓨터를 사용할 계획도 있습니다.
Content: "<p>공격자가 컴퓨터를 손상하는 경우 일반적으로 목표를 염두에 두고 있습니다. 일부 공격자는 피해자 컴퓨터에 있는 정보를 찾고 있거나 피해자&rsquo; 네트워크의 다른 컴퓨터에&rsquo; 대한 액세스를 찾고 있습니다. 공격자는 컴퓨터 자체의 처리 능력을 사용하거나 다른 공격의 시작 지점으로 컴퓨터를 사용할 계획도 있습니다. Microsoft Azure Linux VM(가상 머신)에서 가장 일반적으로 공격자가 암호 화폐 마이닝 소프트웨어를 설치하고 실행하는 것을 볼 수 있습니다. 이 블로그 게시물은 공격자가 손상된 컴퓨터를 다른 공격의 시작 지점으로 사용하려는 경우 후자에 초점을 맞춥니다.</p>\n\n<p>ASC(<a href=\"https://azure.microsoft.com/en-us/services/security-center/\" target=\"_blank\">Azure Security Center</a>)는 여러 Linux 배포판에서 실행되는 에이전트<a href=\"https://github.com/Microsoft/OMS-Agent-for-Linux#supported-linux-operating-systems\" target=\"_blank\">를 활용합니다</a>. 감사가 활성화되면 프로세스 생성 이벤트를 포함한 로그를 수집합니다. 이러한 작업은 검색 파이프라인을 통해 실행되어 악의적이고 의심스러운 활동을 찾습니다. 경고는 ASC 포털을 통해 표시됩니다.</p>\n\n<p>Microsoft 위협 인텔리전스 센터는 정교한 하이브리드 Linux 허니팟 서비스를 포함하여 새로운 새로운 위협을 식별하는 다양한 방법을 사용합니다. 허니팟은 공격을 받고 사이버 공격자를 유인하여 자신을 드러내도록 설정된 미끼 시스템입니다.</p>\n\n<p>이 게시물에서는 허니팟에 대한 공격이 고객 머신 내의 IP에서 시작된 최근 몇 가지 사례에 대해 설명합니다. 각 경우에 손상된 고객 VM에 대한 악의적인 동작으로 인해 이미 Azure Security Center를 통해 경고가 발생했습니다. 이러한 공격을 분석하면 공격자&rsquo; 동작에 대한 더 큰 인사이트를 얻을 수 있습니다. 이를 통해 추가 탐지 개발을 통해 고객에게 더 많은 공격 동작을 표시하고 공격 종단 간을 보다 완벽하게 파악할 수 있습니다.</p>\n\n<h2>초기 침입</h2>\n\n<p>아래 다이어그램은 공격 설정을 보여 줍니다. 분석에 따르면 기본 암호가 있는 Apache Cassandra 계정이 처음에 Azure VM을 손상시키는 데 사용되었음을 알 수 있습니다. 액세스 권한이 확보되면 공격은 허니팟 (1) 및 기타 목표 (2)에 접근했습니다. 공격자가 이 VM에 로그인하는 데 사용한 두 개의 IP 주소(3, 4)를 확인했으며, 그 중 하나는 허니팟(5)도 공격했습니다. 눈에 띄는 또 다른 것은 공격자가 사용 중인 두 개의 IP가 동일한 처음 두 개의 옥릿을 공유하고 루마니아로 해결되었다는 것입니다. 우리는 나중에이 사실로 돌아올 것입니다.</p>\n\n<p><br>\n<a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a0e205ec-c338-4eda-ac43-f0920cc89d01.png\"><img alt=\"Connections\" border=\"0\" height=\"306\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/78e80717-6ba1-4802-b386-ef437fd36bb7.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"연결\" width=\"607\"></a></p>\n\n<h2>침입 분석</h2>\n\n<p>고객 가상 머신에 대한 <a href=\"https://azure.microsoft.com/en-us/blog/how-azure-security-center-helps-detect-attacks-against-your-linux-machines/\" target=\"_blank\">일반적인 공격</a> 중 하나는 무차별 암호 대입 공격이며, 이로 인해 암호화 동전 마이닝 맬웨어가 빠르게 설치됩니다. 이 경우 악의적인 사용자가 약간 다른 작업을 수행하고 있었습니다.</p>\n\n<h3>호스트 열거형</h3>\n\n<p>초기 손상 후 공격자는 몇 가지 열거형 및 속도 테스트 스크립트를 호스트하는 도메인 nasapaul.com perl 기반 호스트 열거형 스크립트를 끌어당겼습니다. Azure Security Center는 알려진 악성 소스&rdquo; 경고에서 검색된 파일 다운로드를 통해 &ldquo;이 동작을 표시합니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/31b58859-fddd-43fe-bf18-40f28dea0437.png\"><img alt=\"Download Source\" border=\"0\" height=\"408\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/beaec564-af69-4e4d-a8ac-54c41e2669f8.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"원본 다운로드\" width=\"512\"></a></p>\n\n<p>이 스크립트는<strong> /proc/cpuinfo</strong> 파일에서 특정 정보를 검색하여 공격자가 어떤 종류의 컴퓨터에 있는지 알 수 있도록 합니다. 일부 명령은 아래 텍스트 상자에서 실행되는 것을 볼 수 있습니다. 동일한 스크립트는 nasapaul.com 제공하는 서비스인 속도 테스트도 실행합니다.</p>\n\n<pre>\nCPU=$(grep &ndash;m 1 &ldquo;model name&rdquo; /proc/cpuinfo | cut &ndash;d: &ndash;f2 | sed-e &lsquo;s/^ */ /&rsquo; |sed &ndash;e &lsquo;s/$/ / &lsquo;)\n\nCPUS=$ (grep &ndash;c ^processor /proc/cpuinfo)\n\nSTEP=$ (grep &ndash;m 1 &ldquo;stepping&rdquo; /proc/cpuinfo | cut &ndash;d: &ndash;f2 | sed &ndash;e &lsquo;s/^ */ / &lsquo; | sed &ndash;e &lsquo;s/$/ / &lsquo;) \n\nBOGO=$ (grep &ndash;m 1 &ldquo;stepping&rdquo; /proc/cpuinfo | cut &ndash;d: &ndash;f2 | sed &ndash;e &lsquo;s/^ */ / &lsquo; | sed &ndash;e &lsquo;s/$/ / &lsquo;)\n\nOS=$ (lsb_release &ndash;si)\n\nram=$ (free &ndash;m | grep &ndash;oP &lsquo;\\d+&rsquo; | head &ndash;n 1)\n\nVER=$ (uname &ndash;a)\n\nuptime=$ (&lt;/proc/uptime)\n\nuptime=$ {uptime%%. *} bold=$ (tput bold)\n\nzile=$ ( ( uptime%60 ( )\n\nsecunde=$ ( ( uptime%60 ) )\n\nminute=$ ( ( uptime/60%60 ) )\n\nore=$ ( ( uptime/60/60%24 ) )\n\nvid=$ (lspci | grep VGA |cut -f5- -d &lsquo; &lsquo;)\n\nDISK=$ (df &ndash;h --total | grep total |awk &lsquo; {printf &ldquo;&rdquo; $2 &ldquo;B\\n\\n&rdquo; } &lsquo; )</pre>\n\n<h2>초기 악용</h2>\n\n<p>해당 세션이 종료되었지만 공격자는 새 세션을 시작하고 보안 FTP 서버에 대한 연결을 만들고 일부 파일을 끌어당겼습니다. 그런 다음 실행을 위해 파일을 수정했습니다.</p>\n\n<pre>\nchmod +x 1 cyberinfo cybernetikrandom go h4e petarda port pscan2 screen speedtestvps.py sshd</pre>\n\n<p>이 파일 집합은 알려진 해킹 그룹의 도구 키트입니다. 공격자는 go 파일을 사용하여 &ldquo;두 개의 서로 다른 클래스 B IP 범위에 대해 pscan2&rdquo; 및 &ldquo;sshd&rdquo;를 실행 &ldquo;&rdquo; 합니다. 즉, 65,000개가 넘는 주소에 대해 검사를 실행했습니다. 또한 조사 결과 서비스 거부 공격에 사용되는 perl 스크립트로 표시된 h4e&rdquo; 도구를 &ldquo;사용했습니다. 텍스트 파일 &ldquo;포트&rdquo; 는 검사 결과, 일반적으로 IP가 수신 대기하는 내용 및 열려 있는 포트를 보유합니다. 이러한 명령이 성공적으로 완료되었는지는&rsquo; 확실하지 않지만 2시간 후에 공격자가 모두 삭제하고 다른 키트를 끌어당겼습니다.</p>\n\n<h2>암호 스프레이</h2>\n\n<p>이번에는 공격자가 Wget을 사용하여 공개 웹 사이트에서 도구 키트를 풀다운했습니다. 이전과 마찬가지로 도구를 끌어낸 다음 실행을 위해 모두 수정했습니다.</p>\n\n<pre>\nchmod +x a all classes co gasite.txt hu pass range scan.log ssh2 x\n\n/bin/bash ./a ##.49\n./ssh2 1500 -b ##.49 pass 22 &quot;uname -a &amp; lscpu&quot;\n/bin/bash ./a ###.66\n./ssh2 1500 -b ###.66 pass 22 &quot;uname -a &amp; lscpu&quot;\nnano gasite.txt</pre>\n\n<p>그런 다음 여러 클래스 B 범위에 대해 동일한 단순 패턴이 반복됩니다. 파일 &ldquo;a&rdquo;는 클래스 B 범위의 처음 두 옥릿을 입력으로 사용한 다음 ssh2&rdquo;를 호출&ldquo;합니다. &ldquo;ssh2&rdquo; 는 여러 스레드, 범위, 암호 파일(&ldquo;이 경우 35,000개 이상의 사용자/암호 조합을 포함하는 전달&rdquo; ), 포트 번호 및 실행할 초기 명령에 대한 입력을 사용합니다. 파일 &ldquo;gasite.txt&rdquo; 출력을 수집합니다.</p>\n\n<p>나중에 클래스 폴더와 함께 사용되는 파일&ldquo;과 &ldquo;범위&rdquo;가 &ldquo;표시됩니다&rdquo;.&rdquo; &ldquo;클래스&rdquo; 폴더에는 IP 범위가 있는 26개의 클라우드 및 호스팅 회사에 대한 세부 정보가 있습니다. Microsoft는 다른 모든 주요 공급자와 함께 있습니다. 파일 &ldquo;공동&rdquo; 및 &ldquo;범위&rdquo; 는 초기 두 8진수만 전체 IP로 확장합니다.</p>\n\n<p>공격자&rsquo;는 모든&rdquo; 파일, &ldquo;hu&rdquo; 또는 &ldquo;x&rdquo; 파일을 &ldquo;실행하는 것처럼 보이지는 않았지만 모두 IP 범위 구성, 특히 IP의 전체 4개 8진수 작성과 관련이 있습니다. ssh2&rdquo; 실행 파일에서 &ldquo;사용할 수 있습니다.</p>\n\n<p>도구 키트를 분석하는 데 약간의 노력이 걸렸습니다. 출력 파일 &ldquo; 이름gasite.txtfound.txt&rdquo; &rdquo; 변환 &ldquo; 되고 &ldquo;ssh2&rdquo; 파일은 UPX를 사용하여 압축 및/또는 난독 제거된 ssh 스캐너의 사용자 지정 루마니아어 버전입니다. 압축을 풀면 루마니아어 문자열이 통과되었습니다(아래 이미지 참조). 레드 팀의 몇 가지 추가 연구는 원래 ssh2 소스 코드와 공격자 또는 동일한 실행 파일을 사용하는 사람이 코드에 대한 도움을 받고있는 포럼을 추적했습니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/98eaf4ef-3eb7-458c-aa3b-db90ef1cd5f6.png\"><img alt=\"strings\" border=\"0\" height=\"526\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4c9d4fe4-6e36-4375-a976-f95a4748fb43.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"문자열\" width=\"512\"></a></p>\n\n<h2>결과: Azure Security Center의 향상된 동작 분석</h2>\n\n<p>침입을 조사하는 동안 새 분석에 포함하거나 기존 분석을 개선하기 위해 여러 고유 TTP를 가져올 수 있었습니다. 그들은 더 나은 암호 스프레이 감지 및 공격자 호스트 열거형의 향상된 범위와 같은 것들을 발견했습니다. 또한 기존 분석이 예상대로 실행되었는지 확인할 수 있었습니다. 목표는 동일한 침입에 대해 고객에게 여러 중복 경고를 표시하는 것이&rsquo; 아니라 공격자&rsquo; 작업의 전체 범위에 대한 인사이트를 제공하는 것입니다. 또한 이 공격의 배후에 있는 행위자가 기술의 일부 측면을 바꿀 수 있음을 인정합니다. 공격 수명 주기 동안 탐지 범위가 클수록 공격자 방법론의 변화에 대한 복원력이 높아집니다. 또한 이 공격자가 사용하는 특정 기술은 다른 공격자에 의해 사용될 수 있으며&rsquo;, Wed는 이러한 기술을 포착하는 것을 좋아합니다.</p>\n\n<h2>권장 작업</h2>\n\n<p><strong>Azure Security Center에서 정기적으로 경고를 검토합니다</strong>. 고객은 이 침입에 대해 여러 Azure Security Center 경고를 받았고 악의적인 활동이 곧 중지되었고 다시 나타나지 않았습니다. Azure Security Center는 모든 경고를 <a href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-managing-and-responding-alerts\" target=\"_blank\">보안 경고</a>의 중앙 집중식 위치에 통합합니다. 이렇게 하면 경고의 심각도를 쉽게 확인하고 응답의 우선 순위를 지정하는 데 도움이 됩니다. 각 경고는 인시던트에 대한 자세한 설명과 문제를 해결하는 방법에 대한 단계를 제공합니다. 추가 조사를 위해 공격에 관련된 모든 엔터티를 &ldquo;볼 수 있는 대화형 시각적 방법인 조사 경로&rdquo;에서 경고를 검토할 수 있습니다.</p>\n\n<p><strong>정기적으로 암호를 변경합니다</strong>. Azure Security Center가 활동에 대해 경고하는 동안 좋은 암호 위생을 통해 침입을 방지할 수 있었습니다. 공격자 도구 키트의 많은 사용자 이름 및 암호 조합 중에서 좋은 청크는 소프트웨어를 처음 설치할 때 생성되는 기본값입니다. 이러한 기본 암호를 변경하거나 <a href=\"https://techcommunity.microsoft.com/t5/Azure-Active-Directory-Identity/Announcing-password-less-login-identity-governance-and-more-for/ba-p/262472\" target=\"_blank\">암호 없는</a> 암호를 사용하면 암호가 사용자에 대해 사용되지 않도록 방지할 수 있습니다.</p>\n\n<h2>맺음말</h2>\n\n<p>우리 팀은 사이버 보안 문제의 양쪽 끝을 작동합니다. 우리는 공공 및 내부 보안 연구를 통해 지속적으로 탐지를 개선하고 구체화합니다. 또한 외부 위협을 핵심 입력으로 모니터링하여 탐지 범위가 Microsoft와 고객 모두가 직면한 공격과 가장 관련성이 있는지 확인합니다. Azure에 Linux 머신이 있는 경우 Azure Security Center를 사용하여 머신을 모니터링하고 다른 컴퓨터를 대상으로 지정하지 못하도록 하는 것이 좋습니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e6dd6687-444e-4c2a-b95b-be4682ed5d37.jpg\"><img alt=\"Slide1\" border=\"0\" height=\"90\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2981dffe-95cb-4ad6-add2-2b713179edfe.jpg\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"Slide1\" width=\"881\"></a></p>\n\n<p>Microsoft는 수행할 수 있는 작업 외에도 Azure 플랫폼을 보호하는 데 도움이 되는 몇 가지 물리적 인프라 및 운영 제어 기능을 갖추고 있습니다. Microsoft에는 3,500명 이상의 사이버 보안 전문가가 1년 24/7, 365일 동안 인프라 및 서비스에 대한 보안 위협을 보호, 감지 및 대응하는 데 도움을 줍니다. 이러한 팀 중 하나는 Microsoft 위협 인텔리전스 센터 팀입니다. Azure에서 악의적인 활동으로부터 보호하기 위해 팀과 작업하는 방법에 대해 자세히 알아보려면 <a href=\"https://www.youtube.com/watch?v=n58eHSLoU9w\" target=\"_blank\">최신 Microsoft Mechanics 비디오를 시청</a>하세요.</p>\n\n<h2>기타 리소스</h2>\n\n<ul>\n <li>우리의 허니팟과 사용 방법에 대한 자세한 내용은 로스 베빙턴&rsquo; 블루 햇 이야기, &ldquo;<a href=\"https://www.youtube.com/watch?v=abamlxFHElw\" target=\"_blank\">매트릭스는 당신을 가지고 - 속임수를 사용하여 Linux를 보호 - BlueHat 2018</a>&rdquo;.</li>\n <li><a href=\"https://github.com/Microsoft/OMS-Agent-for-Linux\" target=\"_blank\">Linux용 OMS 에이전트는 Linux</a> 서버, Docker 컨테이너 및 Nagios, Zabbix 및 System Center 같은 모니터링 도구에서 운영 데이터(Syslog, 성능, 경고, 인벤토리)에 대한 풍부하고 실시간 분석을 가능하게 합니다.</li>\n <li><a href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-detection-capabilities\" target=\"_blank\">Azure Security Center 및 Its&rsquo; 고급 검색 기능에</a> 대해 알아봅니다.</li>\n <li><a href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-managing-and-responding-alerts\" target=\"_blank\">Azure Security Center에서 보안 경고 관리 및 대응을</a> 시작하는 방법을 알아봅니다.</li>\n <li><a href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-recommendations\" target=\"_blank\">Azure Security Center의 보안 권장 사항 관리 및 Azure</a> 리소스를 보호하는 방법에 대해 알아봅니다.</li>\n <li><a href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-monitoring\" target=\"_blank\">Azure Security Center의 보안 상태 모니터링 및 Azure</a> 리소스의 상태를 모니터링하는 방법에 대해 자세히 알아봅니다.</li>\n <li><a href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-partner-solutions\" target=\"_blank\">Azure Security Center를 사용하여 파트너 솔루션 모니터링</a>에 대해 알아봅니다.</li>\n <li>서비스 사용에 대한 질문과 대답을 보려면 <a href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-faq\" target=\"_blank\">Azure Security Center FAQ</a> 를 살펴보세요.</li>\n <li>최신 <a href=\"https://blogs.msdn.com/b/azuresecurity/\" target=\"_blank\">Azure Security 블로그</a> 뉴스 및 정보를 가져옵니다.</li>\n</ul>"
