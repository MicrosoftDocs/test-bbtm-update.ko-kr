### YamlMime:Yaml
ms.openlocfilehash: 96e3419fceaa7d716dc128022e51fdbdb076714d
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139911013"
Slug: how-to-tell-if-you-are-out-of-room
Title: 방이 밖인지 알려주는 방법
Summary: '[이 문서는 SQL Azure 팀에서 제공했습니다.] SQL Azure 데이터베이스의 크기가 제한됩니다. 한 가지 이유는 데이터가 사용자 이상으로 증가하는 경우 깜짝 청구서를 보내지 않기&rsquo; 때문입니다.'
Content: "<p>[이 문서는 SQL Azure 팀에서 제공했습니다.]</p><p>SQL Azure 데이터베이스의 크기가 제한됩니다. 한 가지 이유는 데이터가 예상을 뛰어넘는 경우 깜짝 청구서를 보내지 않기&rsquo; 때문입니다. 데이터베이스의 상한을 항상 늘리거나 줄일 수 있습니다(최대 50기가바이트). 그러나 이 작업은 자동으로 수행되지 않습니다. 이 문서에서는 데이터베이스를 더 크게 만들고, 현재 한도를 쿼리하고, 현재 크기를 파악하고, 크기 오류를 검색하는 등 SQL Azure 데이터베이스의 크기를 처리하는 다양한 트릭과 팁을 설명합니다.</p>  <p>시작하기 전에 주의해야 할 한 가지 사항은 데이터베이스 한도에 따라 요금이 부과되지 않으며 데이터베이스가 각 버전의 범위에 따라 실제로 보유하고 있는 데이터에 대한 요금이 청구됩니다. 웹 버전의 경우 해당 범위는 0-1GB 및 1-5기가바이트입니다. 비즈니스 에디션의 경우 해당 범위는 0-10기가바이트, 10-20기가바이트, 20-30기가바이트, 30-40기가바이트 및 40-50기가바이트입니다.</p>  <h2>현재 상한</h2>  <p>이 Transact-SQL 쿼리를 사용하여 SQL Azure 데이터베이스의 현재 상한을 쿼리할 수 있습니다.</p>  <pre class=\"csharpcode\"><span class=\"kwrd\">SELECT</span> DATABASEPROPERTYEX (<span class=\"str\">'AdventureWorksLTAZ2008R2'</span> , <span class=\"str\">'MaxSizeInBytes'</span> )</pre>  <p>    </p>  <p>물론 속성 이름이 <b>MaxSizeInBytes</b>이므로 결과는 바이트 단위이므로 SQL Azure <a href=\"https://en.wikipedia.org/wiki/Gigabyte\">기가바이트</a>가 1,000,000,000바이트가 아닌 1,073,741,824바이트라고 믿습니다. 한 가지 주의해야 할 점은 데이터베이스 인수가 현재 데이터베이스와 동일해야 합니다. 그렇지 않으면 결과는 NULL이 됩니다.</p>  <h2>현재 크기</h2>  <p>아래 쿼리를 사용하여 데이터베이스의 현재 크기를 쿼리할 수 있습니다.</p>  <pre class=\"csharpcode\"><span class=\"kwrd\">SELECT</span> <span class=\"kwrd\">SUM</span>(reserved_page_count) * 8192  <span class=\"kwrd\">FROM</span>    sys.dm_db_partition_stats</pre>  <p>    </p>  <p>이 쿼리의 결과는 바이트 단위로 반환되며, 이를 사용하여 위의 쿼리에서 얻은 현재 상한과 비교할 수 있습니다. 팝 퀴즈: 현재 크기는 언제 현재 제한보다 커지나요? 대답: 절대로 안 됩니다. 제한을 초과하는 데이터를 업데이트하거나 삽입하려고 하면 SQL 오류가 발생합니다.</p>  <h2>크기 오류 검색</h2>  <p>SQL Azure 데이터베이스의 공간이 부족하면 오류 40544가 &ldquo; 발생합니다. 오류 메시지는 <i>데이터베이스의 크기 할당량에 도달했습니다. 가능한 해결 방법은 데이터를 분할 또는 삭제하거나 인덱스를 삭제하거나 설명서를 참조하세요. </i>&ldquo;</p>  <p>SQL Server Management Studio 다음과 같습니다.&nbsp;</p>  <p style=\"color: red\">Msg 40544, 수준 20, 상태 5, 줄 1 <br>데이터베이스가 크기 할당량에 도달했습니다. 데이터를 분할 또는 삭제하거나 인덱스를 삭제하거나 가능한 해결 방법에 대한 설명서를 참조하십시오. 코드: 524289</p>  <p>C# 코드에서 이 오류를 트래핑하려는 경우 다음을 수행할 수 있습니다.</p>  <pre class=\"csharpcode\"><span class=\"kwrd\">try</span>  {      <span class=\"rem\">// ...</span>  }  <span class=\"kwrd\">catch</span> (SqlException sqlException)  {      <span class=\"kwrd\">switch</span> (sqlException.Number)      {          <span class=\"rem\">// The database has reached its size quota. Partition or delete data,</span>          <span class=\"rem\">// drop indexes, or consult the documentation for possible resolutions. </span>          <span class=\"kwrd\">case</span> 40544:              <span class=\"kwrd\">break</span>;      }  }</pre>  <p>    </p>  <h2>데이터베이스 한도 자동 증가</h2>  <p>데이터베이스가 현재 상한을 초과할 때 한도를 늘리는 것이 좋을까&rsquo;요? SQL Azure 데이터베이스 한도를 기반으로 하지 않고 사용 중인 데이터에 대해서만 요금을 청구하기 때문에 자동 증가를 거의 수행합니다. 예를 들어 .8기가바이트의 데이터와 5GB의 상한이 있는 경우 0-1기가바이트 범위만 청구됩니다. 데이터베이스가 1기가바이트보다 크면 오류가 발생하지 않습니다. 그러나 그 날부터는 1-5기가바이트 범위에 대한 요금이 청구됩니다. 본질적으로 이것은 자동 증가이며, 데이터베이스를 자동으로 확장할 수 있는 최대값을 알려주고 사용 중인 범위에 대해서만 요금을 청구합니다. 현재 범위를 벗어나는 경우 오류 없이 다음 범위에 대해 자동으로 요금이 청구됩니다.</p>  <p>이 자동 증가의 주의 사항은 현재 SQL Azure 웹 버전과 비즈니스 버전 간에 이동할&rdquo; 수 &ldquo;없다는 것입니다. 1, 5, 10, 20, 30, 40 및 50기가바이트 데이터베이스 한도를 가질 수 있습니다. 1기가바이트 데이터베이스와 5기가바이트 데이터베이스는 더 큰 데이터베이스 한도를 얻기 위해 BUSINESS 버전으로 변경해야 하는 WEB Edition의 일부입니다. 즉, 데이터베이스가 증가함에 따라 해당 증가를 추적하고 Transact-SQL(다음 섹션의 코드 참조)를 실행하여 버전을 변경해야 합니다.</p>  <h3>코딩 버전 변경 내용</h3>  <p>SQL Server 오류 번호가 40544인 예외가 발견되었을 때마다 데이터베이스 한도 또는 버전을 자동으로 늘리기 위해 약간의 C# 코드 데이터 계층을 작성하려고 했습니다. 데이터베이스가 계속 증가할 수 있도록 Windows Azure 웹 역할에 추가해야 합니다.</p>  <p>그러나 이 개념에는 동시성 문제가 있습니다. 웹 사이트에서 초당 수천 개의 연결을 받고 있으며 데이터베이스가 가득 찼을 때 Windows Azure 서버의 스레드 3~4개에 오류가 40544가 표시되었다고 가정해 보겠습니다&rsquo;. 스레드는 모두 데이터베이스 크기를 늘리려고 시도하므로 데이터베이스 크기가 필요 이상으로 커지게 됩니다. 한 번에 하나의 스레드만 데이터베이스 크기를 늘릴 수 있고 진행 스레드는 아무 작업도 수행하지 않도록 개념을 트랜잭션으로 래핑하는 것이 해결될 수 있습니다. 그러나 SQL Azure ALTER DATABASE 문(데이터베이스 크기를 늘리기 위한 문)은 일괄 처리로 실행되어야 하며 트랜잭션으로 래핑할 수 없습니다.</p>  <p>40544 오류를 처리하고 데이터베이스 버전을 자동으로 늘리기 위한 우아한 솔루션을 고민하고 있습니다. 내가 하나를 찾을 경우 나는 그것에 대해 블로그 것입니다. 아이디어가 있는 경우 아래의 의견에 게시합니다.</p>  <h2>데이터베이스 크기 변경</h2>  <p>한도를 자동으로 변경할 수는&rsquo; 없지만 일부 Transact-SQL 사용할 수 있습니다. 여기서 데이터베이스 한도를 변경하는 방법에 대해 자세히 블로그에 게시했습니다. 데이터베이스 버전을 변경하려면 다음과 같이 ALTER DATABASE 구문을 사용할 수 있습니다.</p>  <pre class=\"csharpcode\"><span class=\"kwrd\">ALTER</span> <span class=\"kwrd\">DATABASE</span> AdventureWorksLTAZ2008R2 <span class=\"kwrd\">MODIFY</span> (EDITION=<span class=\"str\">'BUSINESS'</span>, MAXSIZE=10GB)</pre>  <p>    </p>  <p>제한되는 데이터베이스의 크기를 조정하고 크기를 축소할 수 있습니다. 흥미롭게도 데이터베이스 크기를 줄이려고 할 때 해당 옵션에 대한 데이터가 너무 많으면 다음 오류가 발생합니다.</p>  <p style=\"color: red\">Msg 60003, Level 16, State 1, Line 1 <br>결과 누적 데이터베이스 크기가 데이터베이스 sku 제한을 초과하여 작업이 실패했습니다.</p>  <h2>요약</h2>  <p>질문, 우려 사항, 의견이 있나요? 아래에 게시하고 우리는 그들을 해결하기 위해 노력할 것입니다.</p>"
