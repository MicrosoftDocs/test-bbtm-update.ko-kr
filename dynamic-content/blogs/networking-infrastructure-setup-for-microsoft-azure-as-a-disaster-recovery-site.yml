### YamlMime:Yaml
ms.openlocfilehash: 39c340db78b2afc4672343c87f072f45fa3e63df
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139899644"
Slug: networking-infrastructure-setup-for-microsoft-azure-as-a-disaster-recovery-site
Title: 재해 복구 사이트로 Microsoft Azure 위한 네트워킹 인프라 설정
Summary: 이 게시물에서는 예제의 도움으로 필요한 네트워킹 인프라를 설정하는 방법을 설명하고 온-프레미스 및 Azure에서 네트워킹을 설치한 다음 테스트 장애 조치(failover) 및 계획된 장애 조치(failover)를 수행하는 방법을 마무리하는 방법을 알아봅니다.
Content: >-
  <h1 align="center"></h1>

  ASR(Azure Site Recovery)는 Microsoft Azure가 가상 머신에 대한 재해 복구 사이트로 사용되도록 할 수 있습니다. Azure Site </a> Recovery를 사용하여 Azure에 대한 재해 복구 미리 보기의 Azure Site Recoveryannouncement" href="https://aka.ms/e2a_networking_brad" target="_blank">를 사용하여 Azure에 대한 재해 복구 미리 보기의 발표에 대해 <a title="Brad Anderson의 블로그를 참조하여 ASR에 대해 자세히 알 수 있습니다.


  관리자가 애플리케이션에 재해 복구 기능을 추가하는 것을 고려할 때 최소한의 가동 중지 시간으로 장애 조치(failover) 후 사용자가 애플리케이션에 액세스할 수 있도록 네트워킹 인프라를 고려하고 계획해야 합니다. 이 게시물에서는 예제의 도움을 받아 필요한 네트워킹 인프라를 설정하는 방법을 설명합니다. 먼저 애플리케이션을 설명한 다음 온-프레미스 및 Azure에서 네트워킹을 설정하는 방법을 살펴본 다음 테스트 장애 조치(failover) 및 계획된 장애 조치(failover)를 수행하는 방법을 마무리합니다.


  &nbsp;

  <h1>1. 애플리케이션</h1>

  이 예제에서는 SQL Server 백 엔드로 사용하는 2계층 IIS 기반 애플리케이션을 사용합니다.


  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/app.jpg"><img class="size-full wp-image-183741 aligncenter" alt="app" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/app.jpg" width="583" height="307" /></a>


  &nbsp;


  위의 다이어그램에는 Active Directory 설정이 있는 Contoso라는 조직이 있습니다. SQL Server 백 엔드로 사용하는 두 계층 IIS 웹 애플리케이션이 있습니다. SQL Server Windows 인증을 사용하여 인증되고 모든 가상 머신이 도메인에 가입되어 contoso.com 조직의 프레미스 내에 있는 사용자와 모바일 인력이 애플리케이션에 액세스합니다. 조직 프레미스에 없는 직원은 VPN을 사용하여 조직의 네트워크에 연결합니다.


  &nbsp;

  <h1>2. 온-프레미스 네트워크</h1>

  contoso.com 위한 온-프레미스 인프라는 VMM 2012 R2 서버에서 관리됩니다. VMM 서버에 Application Network라는 VLAN 기반 논리 네트워크가 생성되었습니다. 이 논리 네트워크를 사용하여 Application VM Network라는 VM 네트워크를 만듭니다. 애플리케이션의 모든 가상 머신은 고정 IP를 사용하므로 고정 IP 풀도 논리 네트워크에 대해 정의됩니다. 참고: 가상 머신이 DHCP를 사용하도록 구성된 경우 고정 IP 풀이 필요하지 않습니다.


  <b>논리 네트워크</b> <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/2.jpg"><img class="size-medium wp-image-181854 aligncenter" alt="2" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2-636x70.jpg" width="636" height="70" /></a> <b></b>


  <b>VM 네트워크</b> <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/3.jpg"><img class="size-medium wp-image-181864 aligncenter" alt="3" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3-636x60.jpg" width="636" height="60" /></a>세 가상 머신에서 SQL 백 엔드 및 IIS 프런트 엔드인 도메인 컨트롤러가 위의 단계에서 설명한 VM 네트워크에 추가됩니다. 다음은 각 가상 머신에 제공되는 정적 IP입니다.

  <ul>
   <li>Active Directory 및 DNS – 192.168.0.3</li>
   <li>SQL 백 엔드 – 192.168.0.21</li>
   <li>IIS 프런트 엔드 – 192.168.0.22</li>
  </ul>

  &nbsp;

  <h1>3. Azure Network</h1>

  Azure Virtual Network에 대한 기본 사항을 알아보려면 Azure Virtual Network 개요를 참조하세요. AzureNetwork라는 Azure Virtual Network는 Microsoft Azure 만들어집니다. 이 네트워크를 만드는 동안 온-프레미스 DNS 서버의 IP는 DNS 서버 IP(이 경우 192.168.0.3)로 제공됩니다. 지점 및 사이트 간 연결뿐만 아니라 사이트 간 연결도 이 네트워크에서 사용하도록 설정됩니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/4.jpg"><img class="size-medium wp-image-181874 aligncenter" alt="4" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4-572x369.jpg" width="572" height="369" /></a>


  AzureNetwork의 경우 주소 범위 10.0.0.0 – 10.0.0.255를 사용합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/5.jpg"><img class="alignnone size-medium wp-image-181884" alt="5" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5-636x272.jpg" width="636" height="272" /></a>


  두 가지 주요 지점에 대해 온-프레미스 주소 범위와 다른 주소 범위를 사용하는 것이 중요합니다.

  <ul>
   <li>온-프레미스 네트워크를 사용하여 사이트 간 연결을 설정하려고 합니다. S2S 게이트웨이는 네트워크의 양쪽에 동일한 IP 범위를 가질 수 없습니다.</li>
   <li>온-프레미스에서 실행되는 애플리케이션이 여러 개 있는 경우 전체 서브넷이 아닌 일부 애플리케이션만 장애 조치(failover)하는 기능이 필요합니다.</li>
  </ul>

  &nbsp;


  <b>참고</b>: 위의 두 요구 사항이 없는 경우 온-프레미스 주소 범위와 정확히 유사한 주소 범위를 정의했을 수 있습니다.


  &nbsp;

  <h1>4. 사이트 간 연결 및 AD 복제 설정</h1>

  애플리케이션이 한 사이트에서 다른 사이트로 원활하게 이동할 수 있도록 Azure의 네트워크는 온-프레미스 네트워크의 확장일 뿐입니다. Azure를 사용하면 Azure에서 만든 가상 네트워크에 사이트 간 연결을 추가할 수 있습니다. 사이트를 만들 때 또는 나중에 사이트 연결을 추가할 수 있습니다. Azure <a title=" 가상 네트워크에 사이트 간 연결을 추가하는 단계별 가이드는 Azure 가상 네트워크에" href="https://aka.ms/e2a_networking_s2s" target="_blank"> 사이트 간 연결을</a>  추가하는 단계별 가이드입니다.나중에 사이트 연결에 사이트를 추가하려는 경우에도 유사한 단계를 수행할 수 있습니다.


  두 사이트 간의 연결이 설정되면 Azure에서 Active Directory 및 DNS 서버를 만들 수 있습니다. 이렇게 하면 Azure에서 실행되는 애플리케이션이 각 이름 조회 및 인증 요청에 대한 온-프레미스 AD 및 DNS로 이동하지 않아도 됩니다. 아래 단계에 따라 Azure에서 Active Directory를 만듭니다.

  <ol>
   <li>Active Directory 사이트 및 서비스를 사용하여 온-프레미스 Active Directory에서 AzureSite에 대한 별도의 사이트를 만드는 것이 좋습니다.</li>
   <li>3단계에서 만든 네트워크에서 IaaS VM 만들기</li>
   <li>서버 관리자를 사용하여 Active Directory Domain Services 및 DNS 서버 역할 설치</li>
   <li>서버를 도메인 컨트롤러로 승격하는 동안 온-프레미스 도메인 contoso.com 이름을 지정합니다. IaaS 가상 머신은 온-프레미스 DNS 서버의 IP를 DNS로 제공한 3단계에서와 같이 contoso.com 확인할 수 있어야 합니다.</li>
   <li>Active Directory 사이트를 만든 경우 AzureSite라는 Active Directory 사이트에 이 Active Directory를 추가합니다.</li>
  </ol>

  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6.jpg"><img class="alignnone size-full wp-image-181894" alt="6" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6.jpg" width="551" height="181" /></a>


  이제 Azure에서 실행되는 DNS 서버가 있으므로 지금부터 만든 IaaS 가상 머신에 이 서버를 사용하는 것이 좋습니다. 이렇게 하려면 AzureNetwork로 이동하여 DNS 서버 IP를 수정하여 위의 단계에서 만든 가상 머신의 IP를 제공합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/7.jpg"><img class="alignnone size-medium wp-image-181904" alt="7" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7-636x298.jpg" width="636" height="298" /></a> <b> </b>


  <b>AD 복제 빈도:</b> ACTIVE Directory 사이트 및 서비스를 사용하여 DNS 레코드 복제 빈도를 변경할 수 있습니다. Active Directory 사이트" href="https://aka.ms/e2a_networking_adrep" target="_blank"> 간 복제를 예약하기 위해 <a title="이 문서를 따를 수 있습니다.</a>


  <b>Active Directory 및 DNS를 Azure에 복제해야 합니까? </b> 전체 사이트 재해를 계획하는 경우 Active Directory를 Azure에 복제해야 합니다. 그러나 한 번에 일부 애플리케이션에 대해서만 계획된 장애 조치(failover)를 수행하고 애플리케이션이 Active Directory 및 DNS와의 통신과 관련하여 너무 번잡하지 않은 경우 Active Directory 및 DNS를 Azure에 복제하지 않도록 선택할 수 있습니다. 이러한 경우 Azure에서 만든 네트워크에서 온-프레미스 DNS 서버의 IP를 제공할 수 있습니다.


  &nbsp;

  <h1>5. 지점 및 사이트 연결 설정</h1>

  애플리케이션이 Azure로 장애 조치되면 모바일 인력이 액세스할 수 있도록 유지하려고 합니다. 이를 위해서는 AzureNetwork에 대한 지점 및 사이트 간 연결을 만들어야 합니다. 이 문서에서는 Azure 가상 네트워크에 지점 및 사이트 vpn을 설정하는 단계별 가이드를 제공합니다. 이 설정이 완료되면 그림은 아래 다이어그램과 같습니다.


  &nbsp;


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/8.jpg"><img class="size-medium wp-image-181974 aligncenter" alt="8" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8-423x369.jpg" width="423" height="369" /></a>

  <h1></h1>

  <h1>6. 테스트 네트워크 만들기</h1>

  Azure Site Recovery는 프로덕션 워크로드에 영향을 주지 않고 테스트 장애 조치(failover)를 수행할 수 있는 기능을 제공합니다. 이 단계에서는 별도의 Azure 가상 네트워크가 필요합니다. 다른 네트워크를 만들고 3단계에서 만든 네트워크에서 사용한 것과 동일한 IP 범위를 사용합니다. 이 네트워크 AzureTestNetwork를 호출하겠습니다. 사이트 연결에 사이트를 추가하고 네트워크에서 사이트 연결을 가리키지 마세요.


  &nbsp;

  <h1>7. Azure Site Recovery 설정</h1>

  인프라를 설정했으므로 ASR에서 다음 단계를 완료해야 합니다.

  <ol>
   <li>클라우드 구성</li>
   <li>AzureNetwork에 '애플리케이션 VM 네트워크' 매핑</li>
   <li>에서 보호 사용
  <ol>
   <li>Active Directory – AD를 Azure로 복제하는 데 AD 복제를 사용하지만 테스트 장애 조치(failover) 중에 AD 인스턴스가 필요합니다. ASR을 사용하여 AD에서도 보호를 사용하도록 설정하는 이유입니다. 테스트 장애 조치(failover)에서 AD를 사용하는 방법은 섹션 9의 이 블로그 뒷부분에 설명되어 있습니다.</li>
   <li>IIS 프런트 엔드</li>
   <li>SQL 백 엔드</li>
  </ol>

  </li>

  </ol>

  이 게시물은 ASR 시작 가이드" href="https://aka.ms/e2a_networking_tutorial" target="_blank">ASR 시작 가이드 및 <a title="ASR 배포 가이드" href="https://aka.ms/e2a_networking_depguide" target="_blank">ASR 배포 가이드</a></a>에서 <a title="잘 설명되므로 이러한 단계에 대한 세부 정보로 이동하지 않습니다. 이 설정이 완료되면 그림이 다음 다이어그램과 같이 표시됩니다.


  &nbsp;


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/9.jpg"><img class="size-medium wp-image-181984 aligncenter" alt="9" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9-430x369.jpg" width="430" height="369" /></a>

  <h1></h1>

  <h1>8. 복구 계획 만들기</h1>

  IIS 프런트 엔드와 SQL 백 엔드라는 두 개의 VM을 추가하여 복구 계획을 만듭니다. 그런 다음, 하나 이상의 그룹을 추가하고 가상 머신 IIS 프런트 엔드를 Group2로 이동하여 복구 계획을 사용자 지정합니다. IIS 프런트 엔드 VM이 시작되기 전에 먼저 백 엔드 VM을 SQL 장애 조치(failover)하여 IIS 애플리케이션이 성공적으로 작동할 수 있도록 합니다. 복구 계획은 다음과 같습니다. <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/10.jpg"><img class="alignnone size-medium wp-image-181814" alt="10" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/10-636x291.jpg" width="636" height="291" /></a>

  <h1>9. 테스트 장애 조치(failover) 또는 DR 드릴 수행</h1>

  조직은 재해 복구 설정의 준비 상태와 규정 준수 요구 사항을 확인하기 위해 정기적으로 테스트 장애 조치(failover) 또는 DR 훈련을 수행해야 합니다. ASR은 프로덕션 워크로드에 영향을 주지 않고 테스트 장애 조치를 수행하는 기능을 제공합니다. 테스트 장애 조치(failover) 또는 DR 훈련을 수행하기 위해 6단계에서 테스트 네트워크를 사용합니다. DR 드릴을 실행하려면 아래 단계를 수행합니다.

  <ol>
   <li>ASR에서 AD 가상 머신으로 이동하여 AzureTestNetwork에서 테스트 장애 조치(failover)를 수행합니다.</li>
   <li>AzureTestNetwork에서 AD용 IaaS 가상 머신이 만들어지면 이 가상 머신에 제공된 IP를 확인합니다.</li>
   <li>IP가 AzureTestNetwork의 DNS에 제공된 것과 동일하지 않은 경우 DNS IP를 AD VM에 있는 IP로 수정합니다. Azure는 가상 네트워크에 정의된 IP 범위의 4<sup>번째</sup> IP에서 IP를 제공하기 시작합니다. 네트워크에 추가된 IP 범위가 10.0.0.0 – 10.0.0.255이면 이 네트워크에서 만들어진 첫 번째 VM은 IP 10.0.0.4를 가져옵니다. AD는 DR 드릴에서 장애 조치된 첫 번째 컴퓨터이므로 이 VM이 가져올 IP를 예측하여 AzureTestNetwork의 DNS IP로 추가할 수 있습니다.</li>
   <li>8단계에서 만든 복구 계획으로 이동하여 AzureTestNetwork에서 테스트 장애 조치를 수행합니다. 가상 머신이 장애 조치(failover)하고 Azure에서 시작될 때 AzureTestNetwork에서 장애 조치(failover)된 DNS에 등록합니다. 이 후에 AzureTestNetwork에서 실행되는 AD-DNS VM은 복구 계획에서 두 가상 머신에 대한 업데이트된 IP를 갖게 됩니다. 이 IP는 가상 머신이 고정 IP를 사용하는 경우에도 가상 머신의 온-프레미스 IP와 다를 수 있습니다.</li>
   <li>AzureTestNetwork에서 IaaS 가상 머신 만들기</li>
   <li>이제 다음을 사용하여 이 IaaS VM에서 IIS 애플리케이션에 액세스할 수 있어야 합니다. https://iisfrontend/</li>
   <li>테스트가 완료되면 ASR의 작업 보기에서 테스트 장애 조치 완료를 표시할 수 있습니다. 그러면 AzureTestNetwork에서 만든 가상 머신이 삭제됩니다.</li>
  </ol>

  &nbsp;


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/11.jpg"><img class="size-medium wp-image-181994 aligncenter" alt="11" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/11-442x369.jpg" width="442" height="369" /></a>


  &nbsp;

  <h1>10. 계획된 장애 조치(failover) 수행</h1>

  애플리케이션의 계획된 장애 조치(failover)를 수행하려면 8단계에서 만든 복구 계획으로 이동한 다음 계획된 장애 조치(failover)를 실행해야 합니다. 계획된 장애 조치(failover)가 완료되고 가상 머신이 Azure에서 시작되면 Azure를 실행하는 DNS에서 해당 IP를 업데이트합니다. 새 IP는 4단계에서 설정한 복제 빈도에 따라 온-프레미스에서 실행되는 DNS로 전파됩니다. Active Directory 사이트 및 서비스로 이동하여 NTDS 설정까지 사이트, 도메인 컨트롤러 중 하나를 확장하여 DNS 레코드의 주문형 복제를 수행할 수도 있습니다. NTDS 설정을 마우스 오른쪽 단추로 클릭하면 선택한 도메인 컨트롤러에 복제할 수 있는 옵션이 제공됩니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/12.jpg"><img class="size-medium wp-image-181834 aligncenter" alt="12" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/12-636x338.jpg" width="636" height="338" /></a>


  DNS 레코드가 복제되고 DNS 레코드의 TTL(Time-To-Live)이 만료되면 온-프레미스 클라이언트 또는 P2S VPN을 사용하여 AzureNetwork에 연결된 클라이언트에서 애플리케이션에 액세스할 수 있어야 합니다.


  &nbsp;


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/09/13.jpg"><img class="size-medium wp-image-182004 aligncenter" alt="13" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/13-389x369.jpg" width="389" height="369" /></a>


  &nbsp;


  &nbsp;


  이 게시물에서는 SQL Server 백 엔드로 사용하는 2계층 IIS 기반 웹 애플리케이션에 대한 재해 복구를 설정하는 방법을 검토했습니다. DR 드릴 또는 계획된 장애 조치(failover)를 수행할 수 있도록 도메인 컨트롤러와 dns를 설정하는 방법을 살펴보었습니다. 또한 최종 사용자가 장애 조치(failover) 후에도 애플리케이션에 원활하게 액세스할 수 있도록 Azure 가상 네트워크를 사용하여 사이트 간 및 지점 및 사이트 간 연결을 설정하는 방법을 살펴보았습니다.


  추가 질문이 있는 경우 MSDN</a>의 <a title="MSDNAzure" href="https://aka.ms/e2a_networking_forum" target="_blank"> Site Recovery 포럼에서 Azure Site Recovery 포럼을 방문하여 추가 정보를 확인하고 다른 고객과 소통하세요.


   <a title="추가 제품 정보를 확인하여 추가 제품 정보를</a>" href="https://aka.ms/e2a_networking_productinfo" target="_blank"> 확인하고 무료 <a title="Azure 평가판" href="https://aka.ms/e2a_networking_trial" target="_blank"></a>에 등록하여 Azure Site Recovery를 사용하여 Microsoft Azure 사용해 볼 수도 있습니다.
