### YamlMime:Yaml
ms.openlocfilehash: beb436c97e39040424b81ff1fe63b0248b405046
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139897972"
Slug: how-to-load-balance-internal-servers
Title: 내부 서버를 Load-Balance 방법
Summary: >-
  편집자 주: 이 블로그 게시물은 Windows Azure 고객 자문 팀의 프로그램 관리자인 Chris Clayton이 작성했습니다.


  저는 2009년부터 Windows Azure와 함께 일해 왔습니다. 이 시간 동안 나는 했다...
Content: >-
  <strong>편집기 참고 사항: </strong> 이 블로그 게시물은 Windows Azure 고객 자문 팀의 프로그램 관리자인 <a href="https://social.technet.microsoft.com/profile/chris%20clayton%20(azurecat)/?ws=usercard-inline" target="_blank">Chris Clayton</a>이 작성했습니다.


  저는 2009년부터 Windows Azure와 함께 일해 왔습니다. 이 기간 동안 저는 크고 작은 조직의 많은 고객을 위한 솔루션을 설계하는 데 도움을 줄 수 있는 기회를 가졌습니다. 솔루션이 증가함에 따라 내부 서버의 부하를 분산해야 하는 경우가 많습니다. 이 게시물 당시 Windows Azure에는 부하 분산을 해결하기 위한 기본 제공 솔루션이 없습니다. 그러나 퍼블릭 엔드포인트에 대한 ACL(액세스 제어 목록)이 도입되어 Azure 서비스 및 구성 요소에서 지원되는 표준 Windows 이를 달성할 수 있습니다.


  내 예제에서는 ASP.NET Web API 사용하여 노출되는 내부 서비스의 외관으로 작동하는 가상 머신에서 실행되는 IIS(인터넷 정보 서비스) 서버의 부하를 분산하려고 합니다. 각 IIS 서버에서 공유하는 공용 부하 분산 엔드포인트를 만들어 모든 공용 엔드포인트에 액세스하는 Windows Azure에서 표준 부하 분산 장치를 사용하여 쿼리의 부하를 분산할 수 있습니다.


  나는 인터넷에있는 사람이 내 서비스에 액세스 할 수있을 것이라고 우려했다. 그러나 엔드포인트에 ACL을 적용하면 클라우드 서비스에만 액세스를 제한할 수 있습니다. ACL은 다음 그래픽과 같이 내 클라우드 서비스 내에서 들어오는 쿼리만 부하가 분산된 엔드포인트에 액세스할 수 있도록 제한을 추가합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/02/8304.a.jpg-550x0.jpg"><img class="alignnone size-medium wp-image-134181" alt="8304.a.jpg-550x0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8304.a.jpg-550x0-520x369.jpg" width="520" height="369" /></a>


  이것은 좋았습니다! 그것은 거의 너무 쉬웠다. 그래서 저는 제 결정의 의미를 고려하여 시간을 보냈고, 여기에 제가 내놓은 장단점이 있습니다.


  <strong>장점</strong>

  <ul>
   <li>파트너 솔루션을 찾을 필요 없이 부하가 분산된 ASP.NET Web API 계층을 달성했습니다.</li>
   <li>Microsoft에서 지원하는 서비스 및 기능을 사용했는데, 지원되는 구성을 제공하여 원하는 것을 정확하게 수행할 수 있게 해 주었습니다.</li>
   <li>제품 팀과 솔루션을 논의했고, 현재 이 기능을 제공하지 않기 때문에 지원되는 구현이라는 데 동의했습니다.</li>
  </ul>

  <strong>죄수</strong>

  <ul>
   <li>Windows Azure의 클라우드 서비스에서 만들 수 있는 공용 포트 수는 현재 25개이며 이 포트 중 하나로 계산됩니다.</li>
   <li>단일 클라우드 서비스의 모든 통신은 동일한 공용 IP 주소에서 제공됩니다. 즉, 모든 클라이언트가 TCP에 의해 적용되는 것과 동일한 64K 연결 제한을 공유합니다. 이 제한은 동일한 원본 포트 및 원본 IP 주소에서 동일한 대상 포트 및 대상 IP 주소로의 연결에 적용됩니다.</li>
   <li>ACL은 IaaS(Infrastructure as a Service) 솔루션으로만 지원되며, PaaS(Platform as a Service) 솔루션이 없습니다.</li>
  </ul>

  <strong>완화 방법</strong>


  단점이 있는 솔루션과 마찬가지로 일반적으로 이를 완화하는 창의적인 방법이 있습니다. 클라우드 서비스에 적용되는 제한 사항(예: 최대 공용 포트 수 및 클라우드 서비스당 단일 IP 주소)에서 파생된 처음 두 가지 단점을 반영했습니다. 가상 머신을 여러 클라우드 서비스에 분산할 수 있다는 것을 깨달았습니다. 가상 네트워크를 사용하여 분할하고 통신 기능을 유지할 수 있습니다. 그러나 이를 위해서는 ACL에서 추가 IP 주소를 구성해야 합니다.


  <strong>단계별 솔루션</strong>


  따라서 두 가상 머신에서 부하 분산 솔루션을 설정하는 방법은 다음과 같습니다.


  IIS용으로 완전히 구성된 두 개의 가상 머신으로 시작했고, Windows PowerShell 사용하여 각각에 할당된 ACL을 사용하여 부하가 분산된 엔드포인트를 만들었습니다.


  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7485.b.png-550x0.png"><img class="alignnone size-full wp-image-134171" alt="7485.b.png-550x0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7485.b.png-550x0.png" width="550" height="131" /></a>


  내 가상 머신이 포함된 클라우드 서비스의 대시보드 보기로 이동하여 허용해야 하는 공용 IP 주소를 빠르게 찾을 수 있습니다. 내 대시보드의 다음 이미지에서 볼 수 있듯이 내 클라우드 서비스의 IP 주소는 137.135.81.135입니다.


  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7115.c.png-550x0.png"><img class="alignnone size-full wp-image-134161" alt="7115.c.png-550x0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7115.c.png-550x0.png" width="550" height="367" /></a>


  Windows PowerShell 열고 Windows Azure 모듈의 cmdlet을 활용하는 다음 명령을 실행합니다. 이러한 명령은 포트 80에서 수신 대기하고 내 클라우드 서비스의 IP 주소(137.135.81.135)에 대한 액세스를 제한하도록 ACL이 설정된 각 가상 머신에 새 엔드포인트를 만듭니다.


  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2086.d.JPG-550x0.jpg"><img class="alignnone size-full wp-image-134151" alt="2086.d.JPG-550x0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2086.d.JPG-550x0.jpg" width="550" height="278" /></a>


  부하 분산 장치가 작동하는지 테스트하기 위해 가상 머신의 이름을 나타내는 텍스트를 표시하도록 기본 IIS 페이지를 변경했습니다. 클라우드 서비스 외부에서 가상 머신에 액세스하려고 합니다. 물론 충분합니다! ACL은 해당 작업을 수행하고 있습니다.


  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1385.e.png-550x0.png"><img class="alignnone size-full wp-image-134141" alt="1385.e.png-550x0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1385.e.png-550x0.png" width="550" height="324" /></a>


  원격 데스크톱을 사용하여 클라우드 서비스 내의 가상 머신에 연결하고 동일한 테스트를 시도합니다. 이번에는 가상 머신의 이름을 가진 웹 사이트가 표시됩니다.


  <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5852.f.png-550x0.png"><img class="alignnone size-full wp-image-134131" alt="5852.f.png-550x0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5852.f.png-550x0.png" width="550" height="356" /></a>


  페이지가 계속 새로 고쳐지도록 하여 부하 분산 장치가 내 요청을 처리할 때 가상 머신의 이름이 변경되는 것을 확인합니다.


  Windows Azure 내에서 사용할 수 있는 기존 지원되는 서비스의 구성을 통해 내부 IaaS 가상 머신의 부하를 분산하는 기능을 만들었습니다. 이 솔루션에는 몇 가지 주의 사항이 있습니다(이 게시물의 앞부분에서 설명한 대로). 하지만 내 의견으로는, 그것은 많은 상황에 대 한 매우 허용.


  여러분의 의견에 감사드립니다. 크리스 클레이튼에서 저에게 이메일을 보내 주시기 바랍니다.
