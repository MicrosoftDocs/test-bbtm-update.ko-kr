### YamlMime:Yaml
ms.openlocfilehash: 8e216047d8eee20490fe8f3a432f9bb8dd599599
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139901977"
Slug: vm-image-blog-post
Title: VM 이미지
Summary: 드럼 롤, 제발.최신 Microsoft Azure 런타임 릴리스를 통해 새로운 VM 이미지 엔터티인 OS 이미지의 후속 버전을 발표하게 되어 기쁩니다.잠깐만 기다리세요... 예, 여러분 중 일부는 ...
Content: >-
  드럼 롤, 제발.최신 Microsoft Azure 런타임 릴리스를 통해 새로운 VM 이미지 엔터티인 OS 이미지의 후속 버전을 발표하게 되어 기쁩니다.잠깐만 기다리세요... 예, 여러분 중 일부는이 익숙한 소리를 생각할 수 있습니다.이 기능은 실제로 샌프란시스코에서 열린 <a href="https://www.buildwindows.com/">//build 컨퍼런스에서</a> 1주일 전에 소개된 많은 흥미로운 새로운 항목 중 하나였습니다.엔지니어링 팀은 이 새로운 엔터티를 출시하기 위해 열심히 노력해 왔으며 그것이 무엇인지, 어떻게 사용하는지, 그리고 모든 작고 실용적인 세부 사항을 설명하는 게시물 세트를 시작하게되어 기쁩니다.


  한 문장에서 VM 이미지를 Microsoft Azure Virtual Machines에 대한 보다 포괄적인 이미지로 생각할 수 있습니다.새롭고 향상된 VM 이미지는 OS 디스크 및 모든 데이터 디스크를 포함하는 가상 머신 스토리지의 전체 정의를 포함합니다.재사용 가능한 단위로 VM을 배포하기 위해 필요한 디스크 속성(예: 호스트 캐싱)을 캡처합니다.OS 이미지와 마찬가지로 VM 이미지는 Azure Storage 페이지 Blob으로 저장된 VHD 집합(디스크당 하나의 VHD)에 대한 메타데이터 및 포인터의 컬렉션입니다.


  지금은 VM 이미지와 OS 이미지가 비슷하다고 생각할 수 있습니다.당신은 참으로 정확합니다!일반화된 운영 체제가 있는 단일 VHD를 포함하는 VM 이미지는 기본적으로 현재 익숙한 OS 이미지입니다.시간이 지남에 따라 VM 이미지가 Microsoft Azure Virtual Machines의 주요 이미지 구문이 됩니다.


  VM 이미지에는 일반화 및 특수화된 두 가지 유형이 있으며 각각 고유한 용도로 사용됩니다.일반화된 VM 이미지에는 이름에서 알 수 있듯이 일반화된 OS 디스크가 포함되어 있습니다(Windows 경우 Sysprep을 실행하고 Linux용으로 실행한 <code>‘waagent –deprovision’</code>경우) 배포 시간 동안 프로비전해야 합니다.현재 OS 이미지는 일반화되어 있습니다.이러한 유형의 VM 이미지는 "모델"로 사용하여 프로덕션 환경에서 애플리케이션에 프런트 엔드를 확장하거나 유사한 개발 및 테스트 환경을 신속하게 축소하는 것과 같은 유사한 가상 머신을 신속하게 스탬핑합니다.


  특수 VM 이미지에는 이미 프로비전된 OS 디스크가 포함되어 있습니다.현재는 디스크가 "즉시 사용 가능"하다는 점과 비슷하지만 디스크와 달리 VM 이미지의 VHD는 읽기 전용으로 처리되고 새 가상 머신을 배포할 때 복사됩니다.특수한 VM 이미지는 잘못되어 가상 머신을 쓸모 없게 렌더링할 수 있는 작업을 수행하기 전에 개발자 컴퓨터 검사점 지정과 같이 잘 알려진 시점에 VM을 배포하기 위한 "스냅샷"으로 사용됩니다.이미지 복제에 대한 Sysprep의 Windows 요구 사항으로 인해 동일한 가상 네트워크에서 여러 동일한 가상 머신을 복제하는 메커니즘이 아닙니다.

  <h4><strong>VM 이미지를 만드는 방법</strong></h4>

  원하는 대로 가상 머신을 설정하고 구성한 후에는 인스턴스를 VM 이미지로 캡처할 수 있습니다.캡처 프로세스 중에 가상 머신 및 디스크의 모든 관련 속성이 저장되고 지원 VHD 페이지 Blob의 복사본이 만들어집니다.각 VHD의 복사본은 복사되는 원래 VHD와 동일한 스토리지 계정 및 컨테이너에 저장됩니다.Azure Storage 복사한 VHD를 찾으려면 다음 명명 규칙을 사용하여 페이지 Blob을 검색합니다. OS VHD의 경우 VM Image Name-os-YYYY-MM-DD-ZZ를 사용하고 &lt;복사된 데이터 VHD&lt;의 경우 VM Image Name-datadisk-Lun-YYYY-MM-DD&lt;&gt;&gt;(-ZZ)를 사용합니다.&lt;&gt;&gt;VM 이미지가 캡처되고 -ZZ가 충돌하는 경우에만 추가된 숫자로 이름을 고유하게 만드는 날짜입니다.캡처하는 동안 메모리 내 상태가 저장되지 않으므로 이 기능은 Microsoft Azure 대한 현재 백업 및 복원 옵션을 대체하지 않습니다.백업 및 복원에 대한 자세한 내용을 보려면 방문할 <a href="https://msdn.microsoft.com/library/azure/jj573031.aspx">https://msdn.microsoft.com/library/azure/jj573031.aspx</a>수 있습니다.


  OS가 일반화/프로비전 해제된 경우 VM 이미지로 캡처하려면 가상 머신을 종료해야 합니다.VM이 VM 이미지로 캡처되면 가상 머신이 자동으로 삭제됩니다.OS가 특수화된 경우 실행 중이거나 종료되는 동안 가상 머신을 캡처할 수 있습니다.캡처된 가상 머신은 그대로 유지됩니다.애플리케이션 일치 또는 디스크 간 캡처가 필요한 경우 VM 이미지를 캡처하기 전에 가상 머신을 종료하는 것이 좋습니다.

  <h4><strong>VM 이미지를 사용하는 방법</strong></h4>

  새 배포 또는 기존 배포의 일부로 가상 머신을 만들 때 VM 이미지를 사용할 수 있습니다.새 VM을 배포하려면 가상 머신 및 VM 이미지 위치가 동일한지 확인한 다음 사용할 VM 이미지의 이름을 입력하기만 하면 됩니다.VM 이미지가 일반화된 경우 현재 OS 이미지와 마찬가지로 프로비전 정보 및 네트워크 구성도 제공해야 합니다.가상 머신이 배포되면 OS 이미지 또는 OS 디스크에서 만든 다른 VM과 동일하게 작동합니다.역할을 업데이트하거나, 추가 디스크를 연결하거나, 기존 디스크를 분리할 수 있습니다.


  VM 이미지가 특수화된 경우 현재 OS 디스크와 같이 프로비저닝 정보가 필요하지 않습니다.VM 이미지에서 가상 머신을 배포하면 새 VM에 대한 VHD 복사본이 만들어집니다. 즉, 기존 VHD는 직접 연결되지 않습니다.특수한 VM 이미지에서 가상 머신을 배포한 후 프로비전이 필요하지 않았기 때문에 VM은 배포 후 매우 빠르게 실행 중인 상태로 표시됩니다.그러나 가상 머신이 여전히 부팅 중일 수 있으므로 원격 데스크톱/SSH를 준비하는 데 몇 분이 더 필요합니다. 다시 한 번 가상 머신을 배포하고 실행한 후 OS 이미지 또는 OS 디스크에서 만든 다른 VM과 동일하게 동작합니다.이 문의 한 가지 주의 사항은 실행 중인 VM에서 캡처된 특수 Windows VM 이미지에서 새 가상 머신을 배포하는 경우입니다. 이러한 VM 이미지를 사용하는 경우 새로 배포된 VM에 원격 데스크톱을 처음 설치할 때 VM이 제대로 종료되지 않았다는 대화 상자 팝업이 표시될 수 있습니다.

  <h2>PowerShell</h2>

  식욕을 자극하고 VM 이미지를 시작하기 위해 VM 이미지를 만들고 사용하는 방법을 설명하는 몇 가지 PowerShell 코드 조각을 제공했습니다.이 더 많은 것을 원하는 떠날 경우 걱정하지 마십시오. 곧 VM 이미지 PowerShell에 대한 포괄적인 '방법' 블로그 게시물이 추가될 예정입니다.

  <h4><strong>Save-AzureVMImage</strong></h4>

  'myVMToCapture'라는 기존 가상 머신을 'myAwesomeVMImage'라는 VM 이미지로 캡처하려면 Save-AzureVMImage cmdlet을 사용합니다.

  <table width="576" border="1" cellspacing="0" cellpadding="2">

  <tbody>

  <tr>

  <td width="574"><span style="font-size: 9.5pt; font-family: 'Lucida Console'; color: blue; line-height: 107%;">Save-AzureVMImage</span><span style="font-size: 9.5pt; font-family: 'Lucida Console'; line-height: 107%;"> <span style="color: navy;">–ServiceName</span> <span style="color: darkred;">"myServiceName"</span> <span style="color: navy;">–Name</span> <span style="color: darkred;">"myVMtoCapture"</span> <span style="color: navy;">–OSState</span> <span style="color: darkred;">"Generalized"</span> <span style="color: navy;">–ImageName</span> <span style="color: darkred;">"myAwesomeVMImage"</span> <span style="color: navy;">–ImageLabel</span> <span style="color: darkred;">"This is my Virtual Machine Image"</span></span></td>

  </tr>

  </tbody>

  </table>

  이는 OS 이미지와 VM을 캡처하는 데 사용하는 것과 동일한 cmdlet입니다.이제 OS 이미지 또는 VM 이미지로 VM을 캡처하는 중에서 결정할 수 있는 추가 매개 변수 집합이 있습니다.OSState 매개 변수는 VM 이미지를 캡처하는 데 필요한 새로운 매개 변수입니다.

  <h4><strong>Get-AzureVMImage</strong></h4>

  이미지 리포지토리의 모든 VM 이미지를 나열하려면 Get-AzureVMImage cmdlet을 사용합니다.

  <table width="571" border="1" cellspacing="0" cellpadding="0">

  <tbody>

  <tr>

  <td width="569"><span style="font-size: 9.5pt; font-family: 'Lucida Console'; color: blue; line-height: 107%;">Get-AzureVMImage</span></td>

  </tr>

  </tbody>

  </table>

  이 cmdlet은 OS 이미지 및 VM 이미지의 결합된 목록을 반환합니다.OS 이미지가 먼저 반환되고 그 다음에 VM 이미지가 반환됩니다.


  VM 이미지에만 관심이 있는 경우 OS 이미지에 대해 항상 null이 되는 여러 속성을 사용하여 OS 이미지를 제거할 수 있습니다.

  <table width="571" border="1" cellspacing="0" cellpadding="2">

  <tbody>

  <tr>

  <td width="569"><span style="font-size: 9pt; font-family: 'Lucida Console'; color: blue;"><span style="font-size: small;">Get-AzureVMImage</span></span><span style="font-size: 9pt; font-family: 'Lucida Console';"><span style="font-size: small;"> <span style="color: darkgray;">|</span> <span style="color: blue;">where</span> {(<span style="color: blue;">gm</span> <span style="color: navy;">–InputObject</span> <span style="color: orangered;">$_</span> <span style="color: navy;">-Name</span> <span style="color: blueviolet;">DataDiskConfigurations</span>) <span style="color: darkgray;">-ne</span> <span style="color: orangered;">$null</span>} <span style="color: darkgray;">|</span> <span style="color: blue;">Select</span> <span style="color: navy;">-Property</span> <span style="color: blueviolet;">Label</span><span style="color: darkgray;">,</span> </span><span style="color: blueviolet;"><span style="font-size: small;">ImageName</span> </span></span></td>

  </tr>

  </tbody>

  </table>

  <h4><strong>New-AzureVMImage</strong></h4>

  VM 이미지 'myAwesomeVMImage'를 사용하여 미국 서부에 VM을 배포하려면

  <table width="564" border="1" cellspacing="0" cellpadding="2">

  <tbody>

  <tr>

  <td width="562"><span style="font-size: 9.5pt; font-family: 'Lucida Console'; color: blue; line-height: 107%;">New-AzureQuickVM</span><span style="font-size: 9.5pt; font-family: 'Lucida Console'; line-height: 107%;"> <span style="color: navy;">–Windows –</span><span style="color: navy;">Location</span> <span style="color: darkred;">"West US"</span> <span style="color: navy;">–ServiceName</span> <span style="color: darkred;">"MySvc1"</span> <span style="color: navy;">–Name</span> <span style="color: darkred;">"myVM1"</span> <span style="color: navy;">–InstanceSize</span> <span style="color: darkred;">"Medium"</span> <span style="color: navy;">–ImageName</span> <span style="color: darkred;">"myAwesomeVMImage"</span> <span style="color: navy;">–AdminUsername</span> <span style="color: darkred;">"admin"</span><span style="color: navy;">–Password</span> <span style="color: darkred;">"adminPassword123"</span> <span style="color: navy;">-WaitForBoot </span></span></td>

  </tr>

  </tbody>

  </table>

  질문이 있으면 알려주세요.


  Christine


  2014년 5월 20일 업데이트: Get-AzureVMImage 사용하여 OS 이미지를 필터링하는 PowerShell 코드 조각이 수정되었습니다.
