### YamlMime:Yaml
ms.openlocfilehash: 2376772b18394a82e9255f860b58accf7173ed52
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139907890"
Slug: azure-stream-analytics-support-for-iot-hub-operations-monitoring-2
Title: IoT Hub 운영 모니터링에 대한 Azure Stream Analytics 지원
Summary: 이제 Azure Stream Analytics에서 IoT Hub 운영 모니터링을 지원하여 IoT 디바이스의 작업을 쉽게 분석할 수 있게 되었습니다.
Content: "<p><a href=\"https://azure.microsoft.com/en-us/services/stream-analytics/\" target=\"_blank\">Azure Stream Analytics</a> 는 초당 수백만 개의 이벤트를 처리하고 거의 실시간으로 집계 및 계산을 수행할 수 있는 확장성이 뛰어난 실시간 완전 관리형 스트림 분석 서비스입니다.<br>\n<br>\nStream Analytics 및 <a href=\"https://azure.microsoft.com/en-us/services/iot-hub/\" target=\"_blank\">Azure IoT Hub</a>는 몇 시간 동안 함께 작동하여 IoT 디바이스가 IoT Hub에 보내는 데이터에 대한 인사이트를 쉽게 수집할 수 있습니다. IoT Hub를 사용하려면 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/stream-analytics-define-inputs/#create-an-iot-hub-data-stream-input\" target=\"_blank\">IoT Hub 데이터 스트림 입력</a> 설명서 만들기에 설명된 대로 입력을 구성하기만 하면 됩니다. 현재 많은 고객이 IoT 솔루션과 함께 사용하고 있으며, 이는 매우 잘 작동합니다. 그러나 고객의 일반적인 요청은 실시간으로 IoT Hub에서 작업의 상태를 모니터링하는 방법입니다. 이제&rsquo; IoT Hub Operations Monitoring 엔드포인트에 연결하여 이 작업을 수행할 수 있음을 발표하게 되어 기쁩니다.</p>\n\n<p>IoT Hub 작업 모니터링을 사용하면 실시간으로 IoT Hub에 대한 작업의 상태를 모니터링할 수 있습니다. IoT Hub는 작업의 여러 범주에 걸쳐 이벤트를 추적하고 사용자는 하나 이상의 범주에서 IoT Hub 엔드포인트까지 처리할 이벤트를 전송할 수 있습니다. 데이터에 오류가 있는지 모니터링하거나 데이터 패턴을 기반으로 좀 더 복잡한 처리를 설정할 수 있습니다.</p>\n\n<p>IoT Hub는 다음 다섯 가지 범주의 이벤트를 모니터링합니다.</p>\n\n<ul>\n <li>디바이스 ID 작업</li>\n <li>디바이스 원격 분석</li>\n <li>클라우드-디바이스 명령</li>\n <li>Connections</li>\n <li>파일 업로드</li>\n</ul>\n\n<p>IoT Hub 운영 모니터링에 대한 자세한 내용은 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/iot-hub-operations-monitoring/\" target=\"_blank\">작업 모니터링 설명서 소개를</a> 참조하세요.</p>\n\n<p>고객이 자주 묻는 것은 디바이스가 IoT Hub에서 연결을 끊고 일정 시간 내에 다시 연결되지 않는 경우(예&nbsp;: 분)를 거의 실시간으로 파악하는 방법입니다. 이 경우 거의 실시간으로 전자 메일을 보내거나 워크플로를 시작하려고 합니다. 일부 디바이스의 경우 이러한 경고가 가능한 한 빨리 나가고 문제가 발생하기 전에 유지 관리가 수행되는 것이 중요합니다.</p>\n\n<p>Stream Analytics&rsquo;를 사용하여 이 작업을 수행하는 것이 얼마나 쉬운지 보여 주려면 IoT Hub Operations Monitoring 기능을 사용하고 Connections&rdquo; 이벤트 모니터링을 &ldquo;구성합니다.</p>\n\n<p>&nbsp;</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/dbf910da-ac69-4024-84ee-0dc1f205fd19.png\"><img alt=\"ConnectionsInfo\" border=\"0\" height=\"347\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/db20a9ac-2f5b-483f-b19a-54f0c2b1834f.png\" style=\"border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px\" title=\"ConnectionsInfo\" width=\"527\"></a></p>\n\n<p>위의 이미지에서 볼 수 있듯이 디바이스가 연결되고 연결이 끊어질 때 로깅 이벤트를 사용하도록 설정하면 로깅이 시작됩니다. 이 사용을 시작하려면 다음과 같이 연결 스위치를 자세한 정보 표시로 전환합니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0c44259c-29c1-4d17-af74-b24bac6a1afa.png\"><img alt=\"ConnectionsConfig\" border=\"0\" height=\"687\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b7369272-5975-480b-a209-88867950a862.png\" style=\"border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px\" title=\"ConnectionsConfig\" width=\"588\"></a></p>\n\n<p>&nbsp;</p>\n\n<p>이 구성이 구성되면 디바이스가 IoT Hub에 연결할 때 이벤트가 캡처되기 시작해야 합니다. 이를 확인하려면 Service Bus 탐색기와 같은 도구를 사용하여 Event Hub &ndash; 호환 이름/엔드포인트&quot;에 연결&quot;하고 메시지를 봅니다.</p>\n\n<p>수집된 샘플 메시지는 다음과 유사할 수 있습니다.</p>\n\n<pre class=\"prettyprint\">\n{\n     &quot;durationMs&quot;: 1234,\n     &quot;authType&quot;: &quot;{\\&quot;scope\\&quot;:\\&quot;hub\\&quot;,\\&quot;type\\&quot;:\\&quot;sas\\&quot;,\\&quot;issuer\\&quot;:\\&quot;iothub\\&quot;}&quot;,\n     &quot;protocol&quot;: &quot;Amqp&quot;,\n     &quot;time&quot;: &quot;2016-09-13T20:00Z&quot;,\n     &quot;operationName&quot;: &quot;deviceConnect&quot;,\n     &quot;category&quot;: &quot;Connections&quot;,\n     &quot;level&quot;: &quot;Error&quot;,\n     &quot;statusCode&quot;: 4XX,\n     &quot;statusType&quot;: 4XX001,\n     &quot;statusDescription&quot;: &quot;MessageDescription&quot;,\n     &quot;deviceId&quot;: &quot;device-ID&quot;\n}</pre>\n\n<p>마찬가지로 디바이스가 IoT Hub에서 연결을 끊으면 operationName == deviceDisconnect를 사용하여 이벤트가 캡처됩니다.</p>\n\n<p>이제 이러한 메시지가 IoT Hub에 도착하는 것을 확인했으므로 Stream Analytics 작업에서 쉽게 사용할 수 있습니다.</p>\n\n<p>1. 새 Stream Analytics 작업을 만듭니다.<br>\n<br>\n새 Stream Analytics 작업을 만드는 데 도움이 필요하면 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/stream-analytics-create-a-job/\" target=\"_blank\">Stream Analytics에 대한 데이터 분석 처리 작업을 만드는 방법을 참조하세요.</a></p>\n\n<p>2. IoT Hub를 가리키는 데이터 스트림 입력을 만듭니다. 메시징이 아닌 &ldquo;엔드포인트에서 작업 모니터링&rdquo;을&rdquo; 선택&ldquo;해야 합니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e85d2a1f-c8b7-4653-92e7-12d4bab9e588.png\"><img alt=\"ConnectionsConfig\" border=\"0\" height=\"739\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5ba9c8d9-c797-44be-9c80-d948c74d7388.png\" style=\"border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px\" title=\"ConnectionsConfig\" width=\"313\"></a></p>\n\n<p>3. 다음 쿼리를 만듭니다.</p>\n\n<pre class=\"prettyprint\">\nWITH\nDisconnected AS (\nSELECT *\nFROM input TIMESTAMP BY [Time]\nWHERE OperationName = &#39;deviceDisconnect&#39;\n    AND Category = &#39;Connections&#39;\n),\nConnected AS (\nSELECT *\nFROM input TIMESTAMP BY [Time]\nWHERE OperationName = &#39;deviceConnect&#39;\n    AND Category = &#39;Connections&#39;\n)\n\nSELECT Disconnected.DeviceId, Disconnected.Time\nINTO Output \nFROM Disconnected\nLEFT JOIN Connected \n    ON DATEDIFF(second, Disconnected, Connected) BETWEEN 0 AND 180\n    AND Connected.deviceId = Disconnected.deviceId\nWHERE Connected.DeviceId IS NULL</pre>\n\n<p>이 쿼리에는 두 단계, 즉 모든 연결 해제 이벤트를 가져오는 첫 번째 단계와 모든 연결 이벤트를 가져오는 두 번째 단계가 있습니다.</p>\n\n<p>그런 다음 LEFT JOIN에서 Stream Analytics DATEDIFF 작업을 사용하여 이 두 스트림을 함께 조인한 다음 일치 항목이 있는 레코드를 필터링합니다. 이렇게 하면 연결 해제 이벤트가 있지만 180초 내에 해당 연결 이벤트가 없는 디바이스가 제공됩니다.</p>\n\n<p>이제 이 작업의 출력을 Service Bus 큐를 포함하여 지원되는 Stream Analytics 출력으로 보낼 수 있습니다. Service Bus 큐에 도착하면 모든 메시지가 큐에 게시되는 즉시 실행되는 Azure Function 또는 Azure Logic App을 쉽게 만들 수 있습니다.</p>\n\n<p>마찬가지로 매우 간단한 SQL 같은 쿼리를 사용하면 IoT Hub Operations Monitoring 엔드포인트에서 실시간 업데이트를 수행할 수 있습니다.</p>\n\n<p>때로는 이런 복잡한 시나리오를 코딩하는 것이 어렵고 시간이 많이 걸리는 좋은 옛날을 그리워합니다&hellip;.&rsquo; Azure의 PaaS 서비스 및 서버리스 컴퓨팅 기능을 사용하는 것이 훨씬 쉽고 강력하므로 가치 추가 빌드에 집중할 수&nbsp; 있습니다.</p>\n\n<h2>관련 서비스</h2>\n\n<p><a href=\"https://azure.microsoft.com/en-us/services/iot-hub/\" target=\"_blank\">IoT Hub</a> - 를 Microsoft Azure 수백만 개의 IoT 자산 연결, 모니터링 및 관리</p>\n\n<p><a href=\"https://azure.microsoft.com/en-us/services/event-hubs/\" target=\"_blank\">Microsoft Azure Event Hubs</a> &ndash; 는 웹 사이트, 앱 및 디바이스에서 데이터를 수집합니다.</p>\n\n<p><a href=\"https://azure.microsoft.com/en-us/services/service-bus/\" target=\"_blank\"></a> - Microsoft Azure Service Bus 프라이빗 및 퍼블릭 클라우드에서 앱 및 디바이스를 연결 유지</p>\n\n<p><a href=\"https://azure.microsoft.com/en-us/services/logic-apps/\" target=\"_blank\">Microsoft Azure Logic Apps</a> - 강력한 통합 솔루션 신속하게 빌드</p>\n\n<p><a href=\"https://azure.microsoft.com/en-us/services/functions/\" target=\"_blank\">Microsoft Azure 함수</a> - 서버리스 코드를 사용하여 이벤트 처리</p>\n\n<h2>다음 단계</h2>\n\n<p>Were&rsquo;는 IoT Hubs와의 긴밀한 통합에 대해 매우 기쁘게 생각하고 사용자와 IoT 애플리케이션을 위한 새롭고 흥미로운 많은 기능을 활용할 수 있기를 바랍니다.</p>\n\n<p>&nbsp;서비스 옆에 추가하려는 <a href=\"https://feedback.azure.com/forums/270577-stream-analytics\"><u>사용자 의견</u></a> 페이지에서&nbsp; 피드백을 제공해 주세요!</p>\n\n<p>Microsoft Azure 또는 Stream Analytics를 처음 접하는 경우 <a href=\"https://azure.microsoft.com/pricing/free-trial/\">무료 Azure 평가판 계정에</a> 등록하여 사용해 보시고 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/stream-analytics-create-a-job/\">첫 번째 Stream Analytics 작업을 만드세요</a>.</p>\n\n<p>도움이 필요하거나 질문이 있는 경우 <a href=\"https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics\">MSDN </a>또는 <a href=\"https://stackoverflow.com/questions/tagged/azure-stream-analytics\">Stackoverflow </a>포럼을 통해 문의하세요. 제품 팀에 직접 <a>이메일을 보내</a>&nbsp;주세요.</p>"
