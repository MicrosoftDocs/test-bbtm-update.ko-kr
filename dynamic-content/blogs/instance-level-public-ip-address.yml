### YamlMime:Yaml
ms.openlocfilehash: cb1c880906c9005d74843b12670f13eb0eb533fd
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139901657"
Slug: instance-level-public-ip-address
Title: 공용 IP 주소 Instance-Level
Summary: GA 발표의 후속 작업으로, 시나리오, 사용량 및 Instance-Level 공용 IP 주소에 대한 기타 자주 묻는 질문에 대한 게시물을 작성하고 싶었습니다.
Content: >-
  <a href="https://azure.microsoft.com/en-us/updates/general-availability-instance-level-public-ips/">GA 공지</a>의 후속 작업으로, Instance-Level 공용 IP 주소에 대한 시나리오, 사용량 및 기타 자주 묻는 질문에 대한 게시물을 작성하고 싶었습니다. 이제 Azure에서 실행되는 가상 머신을 수명 동안 VM에 고정하는 직접 및 공개적으로 액세스할 수 있는 IP 주소와 연결할 수 있습니다. 이 기능은 IaaS 가상 머신과 기존 PaaS(웹/작업자) 역할 인스턴스 모두에서 사용할 수 있습니다.


  &nbsp;

  <h2>사용 사례 시나리오</h2>

  VIP(가상 IP 주소)와 달리 Instance-Level PIP(공용 IP 주소)는 부하가 분산되지 않습니다.VIP는 클라우드 서비스에 할당되고 모든 가상 머신 및 역할 인스턴스에서 공유되지만 PIP는 단일 인스턴스와만 연결됩니다. PIP는 각 인스턴스를 인터넷과 독립적으로 연결할 수 있는 다중 인스턴스 배포에서 특히 유용합니다. 아래 그림은 PIP의 값을 보여 줍니다. VIP와 구별됩니다.


  &nbsp;


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/17/PublicIP.jpg"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border-width: 0px" title="PublicIP" alt="PublicIP" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/PublicIP_thumb.jpg" width="450" height="484" border="0" /></a>


  &nbsp;

  <blockquote>*VIP에서 전송된 트래픽은 DIP1 또는 DIP2에 착륙할 수 있습니다. 그러나 PIP1로 전송된 트래픽은 항상 DIP1로 이동하고 PIP2로 전송되는 트래픽은 항상 DIP2로 이동합니다.


  *DIP(데이터 센터 IP)는 VM의 개인 IP 주소입니다.</blockquote>

  <h3>동적 포트</h3>

  일반적으로 외부 원본에서 Azure VM으로 트래픽을 보낼 수 있으려면 대상 포트를 VM의 엔드포인트로 선언해야 하지만 Instance-Level 공용 IP를 사용하면 이 제한이 제거됩니다. 외부 원본은 VM의 방화벽이 허용하는 한 Instance-Level 공용 IP 주소의 모든 포트로 트래픽을 보낼 수 있습니다. 이는 VM이 동적 포트에서 트래픽을 수신해야 하는 경우에 특히 유용합니다. 수동 모드를 구현하는 FTP 서버가 좋은 사용 사례입니다.

  <h3>외부 모니터링</h3>

  Instance-Level 공용 IP 주소는 부하 분산된 집합에 참여하는 개별 VM을 외부 원본에서 모니터링해야 하는 시나리오에서도 유용합니다. VIP를 통해 연결할 때 트래픽은 항상 부하가 분산되고 부하 분산 장치 뒤에 있는 VM 중 하나에 전달될 수 있지만 PIP를 사용하는 경우 트래픽이 연결된 특정 VM에 도달하도록 보장됩니다.

  <h3>고유 아웃바운드 IP 주소</h3>

  Instance-Level 공용 IP 주소의 또 다른 이점은 외부 엔드포인트에 연결할 때 VM의 나가는 IP 주소로 사용된다는 것입니다. PIP는 VM을 고유하게 식별하므로 수신기는 트래픽의 원본을 쉽게 허용 목록에 추가하거나 식별할 수 있습니다. 웹 크롤러와 같은 많은 수의 아웃바운드 연결이 필요한 시나리오의 경우 VM에서 Instance-Level 공용 IP를 사용하여 SNAT(원본 네트워크 주소 변환)용 전용 아웃바운드 IP를 사용하는 것이 좋습니다.


  &nbsp;

  <h2>사용 지침</h2>

  앞에서 설명한 것처럼 Instance-Level 공용 IP 주소는 IaaS(Virtual Machines) 및 웹/작업자 역할(PaaS) 모두에서 사용할 수 있습니다. IaaS의 경우 PIP는 VM 구성의 일부로 요청되며 PaaS의 경우 역할 구성의 일부로 요청되고 역할의 모든 인스턴스는 Instance-Level 공용 IP 주소를 가져옵니다. 아래 섹션에서는 두 경우 모두에 대한 샘플 파워 셸 cmd 허용 및/또는 서비스 구성 파일을 제공합니다.

  <h3>Virtual Machines</h3>

  *아래 샘플에서는 내 구독에 FrontEnd 및 백 엔드 서브넷이 포함된 VirtualNetwork 'VnetUSEast'를 사용합니다.

  <pre class="prettyprint">#Assign Public IP Address for a Virtual Machine during create

  $images = Get-AzureVMImage

  $ftp1 = New-AzureVMConfig -Name "instance1" -InstanceSize Small -ImageName $images[50].ImageName | Add-AzureProvisioningConfig -Windows -AdminUsername narayan -Password pass@word1 | Set-AzureSubnet FrontEndSubnet | Set-AzurePublicIP -PublicIPName "pip1"

  New-AzureVM -ServiceName "MyFTPService" -VMs $ftp1 -Location "East US" -VNetName VNetUSEast


  #Assign Public IP Address for a Virtual Machine through update

  Get-AzureVM -ServiceName "MyFtpService" -Name "instance1" | Set-AzurePublicIP -PublicIPName "pip1" | Update-AzureVM

  Get-AzureVM -ServiceName "MyFtpService" -Name "instance2" | Set-AzurePublicIP -PublicIPName "pip2" | Update-AzureVM


  #Get the associated Public IP Name for a virtual machine

  Get-AzureVM -ServiceName "MyFtpService" -Name "instance1" | Get-AzurePublicIP


  #Get the assigned Public IP Address for a virtual machine

  $instance1 = Get-AzureVM -ServiceName "MyFtpService" -Name "instance1"

  $instance1.PublicIPAddress


  #Remove Public IP Address from the Virtual machine

  Get-AzureVM -ServiceName "MyFtpService" -Name "instance1" | Remove-AzurePublicIP | Update-AzureVM</pre>

  &nbsp;

  <h3>웹/작업자 역할</h3>

  PaaS 역할 인스턴스에 대한 공용 IP 주소를 가져오려면 정의가 서비스 구성 파일(cscfg)에 있어야 합니다.

  <pre class="prettyprint">#cscfg snippet (not the entire file)</pre>

  <pre class="prettyprint">&lt;....&gt;

    &lt;NetworkConfiguration&gt;
      &lt;VirtualNetworkSite name="VNetUSEast" /&gt;
      &lt;AddressAssignments&gt;
        &lt;InstanceAddress roleName="WorkerRole1"&gt;
          &lt;Subnets&gt;
            &lt;Subnet name="BackEndSubnet" /&gt;
          &lt;/Subnets&gt;
          &lt;PublicIPs&gt;
            &lt;PublicIP name="FtpIP" /&gt;
          &lt;/PublicIPs&gt;
        &lt;/InstanceAddress&gt;
        &lt;InstanceAddress roleName="WebRole1"&gt;
          &lt;Subnets&gt;
            &lt;Subnet name="FrontEndSubnet" /&gt;
          &lt;/Subnets&gt;
        &lt;/InstanceAddress&gt;
      &lt;/AddressAssignments&gt;
    &lt;/NetworkConfiguration&gt;
  &lt;/ServiceConfiguration&gt;</pre>

  <pre class="prettyprint">#Get the Public Ips per role instance

  $roles = Get-AzureRole -ServiceName PaaSFTPService -Slot Production -RoleName WorkerRole1 -InstanceDetails


  $roles[0].PublicIPAddress

  $roles[1].PublicIPAddress


  #To disassociate public IP from the role instance, edit the public IP section from the role using a configuration update.</pre>

  <h2></h2>

  &nbsp;

  <h2>한도 및 청구</h2>

  인스턴스 수준 공용 IP 주소가 미리 보기 상태인 동안 한도는 2개의 IP 주소로 제한되었으며, GA 발표를 통해 구독당 5개의 IP 주소로 제한이 제기되었습니다.


  인스턴스 수준 공용 IP 주소와 관련된 명목 요금도 있습니다. 자세한 내용은 <a href="https://azure.microsoft.com/en-us/pricing/details/ip-addresses/">가격 책정 페이지를</a> 참조하세요.

  <h2></h2>

  &nbsp;

  <h2>FAQ</h2>

  <strong>1. 배포에서 가상 IP 주소(부하 분산)와 인스턴스 수준 공용 IP 주소를 모두 사용할 수 있나요?</strong>


  예, VIP는 기본적으로 모든 클라우드 서비스에 할당됩니다. 인스턴스 수준 공용 IP 주소는 요청 시 특정 가상 머신 또는 역할 인스턴스에 할당할 수 있습니다.


  &nbsp;


  <strong>2. 단일 인스턴스 가상 머신에 VIP 및 인스턴스 수준 공용 IP 주소가 필요한 이유는 무엇인가요?</strong>


  VIP가 이미 단일 인스턴스 가상 머신에 배타적이므로 VM을 가리키는 다른 공용 IP가 필요하지는 않을 수 있지만 인스턴스 수준 공용 IP 주소를 사용하면 엔드포인트를 선언하지 않고도 VM의 모든 포트에 연결할 수 있습니다. 따라서 애플리케이션에서 동적 공용 포트를 노출해야 하는 경우 편리합니다.


  &nbsp;


  <strong>3. 포털에 인스턴스 수준 공용 IP 주소가 표시되어 있나요?</strong>


  아니요, 현재 포털을 통해 지원되지 않습니다. Powershell cmd let 및 REST API를 통해서만 사용할 수 있습니다.


  &nbsp;


  <strong>4. 모든 배포에서 인스턴스 수준 공용 주소를 사용할 수 있나요?</strong>


  인스턴스 수준 공용 IP 주소는 배포에서 사용할 수 있습니다.

  <ul>
   <li>Cloud Servic에서 첫 번째 VM을 만드는 동안 지정된 경우</li>
   <li><a href="https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/">지역 가상 네트워크의</a> 배포</li>
  </ul>

  &nbsp;


  <b>5. Instance-Level 공용 IP가 VM의 IP 구성에 표시되어 있나요?</b>


  아니요, PIP(공용 IP)는 VM 내에 표시되지 않습니다. 위에 표시된 것처럼 REST API 또는 powershell cmd를 사용하여 IP 주소를 가져올 수 있습니다.


  &nbsp;


  <b>6. Instance-Level 공용 IP의 DNS 이름이 있나요?</b>


  아니요, 현재 DNS 이름이 없습니다. 이 기능은 나중에 사용하도록 설정됩니다.
