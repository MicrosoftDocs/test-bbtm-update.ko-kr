### YamlMime:Yaml
ms.openlocfilehash: 2b350f0dcedc1f16ee349eb3ab83078bb8584186
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139899059"
Slug: azure-virtual-machine-internals-part-2
Title: Azure Virtual Machine Internals – 2부
Summary: Azure VM의 작동 방식을 자세히 알아보고 내부 세부 정보 중 일부를 알아 보세요.
Content: >-
  <h2>1부의 연속 작업</h2>


  <p><a href="https://azure.microsoft.com/en-us/blog/azure-virtual-machine-internals-part-1/">Azure Virtual Machine Internals 1부</a>에서는 vM에 Windows 바닐라를 만들고, 덮개 아래를 찌르고 잠재 고객을 팔로우하는 데 약간의 시간을 보냈습니다. 이 부분에서는 이전에 만든 VM을 수정합니다.</p>


  <h2>디스크 추가</h2>


  <pre>

  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure vm disk attach-new -g BlogRG -n BlogWindowsVM -z 60 -d newdatadisk -c ReadWrite -o blogrgdisks562 -r newdatadiskc


  info:    Executing command vm disk attach-new


  + Looking up the VM &quot;BlogWindowsVM&quot;


  + Looking up the storage account blogrgdisks562


  info:    New data disk location: https://blogrgdisks562.blob.core.windows.net/newdatadiskc/newdatadisk.vhd


  + Updating VM &quot;BlogWindowsVM&quot;


  info:    vm disk attach-new command OK


  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure vm show -g BlogRG -n BlogWindowsVM -d full --json</pre>


  <p>아래 코드 조각:</p>


  <pre>
        {

          &quot;lun&quot;: 1,

          &quot;name&quot;: &quot;newdatadisk&quot;,

          &quot;vhd&quot;: {

            &quot;uri&quot;: &quot;https://blogrgdisks562.blob.core.windows.net/newdatadiskc/newdatadisk.vhd&quot;

          },

          &quot;caching&quot;: &quot;ReadWrite&quot;,

          &quot;createOption&quot;: &quot;Empty&quot;,

          &quot;diskSizeGB&quot;: 60

        }</pre>

  <p>캐싱은 기본적으로 readwrite &ndash; 로 설정되므로 읽기 트랜잭션 외에도 쓰기 트랜잭션이 캐시되고 지속형 스토리지로 지연 플러시됩니다. 따라서 데이터가 플러시되기 전에 어떤 이유로든 VM이 실패하면 데이터가 손실됩니다. 캐싱을 포함한 데이터 디스크의 항목 <a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2012/06/27/exploring-windows-azure-drives-disks-and-images/">에 대해 설명합니다</a>. 이 옵션을 애플리케이션에 적합한 값으로 설정합니다.</p>


  <p>이 단계에서는 VM에 RDP를 실행하고 디스크를 초기화, 파티션 및 포맷해야 합니다. 이는 많은 수의 VM 또는 디스크에 대해 지루할 수 있습니다. <a href="https://blogs.technet.microsoft.com/heyscriptingguy/2013/05/29/use-powershell-to-initialize-raw-disks-and-to-partition-and-format-volumes/">자동화</a>를 사용할 수 있는 예제가 있습니다.</p>


  <h2>캡처</h2>


  <p>VM에 대한 RDP 및 sysprep, 일반화, 종료.</p>


  <p><img alt="Run Sysprep" border="0" height="252" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/141ddd5b-c3bd-4e96-aa52-6865eee5386a.png" width="342"></p>


  <p>VM은 예상대로 포털에서 중지된 것으로 표시됩니다.</p>


  <p><img border="0" height="311" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/97988ee2-2d91-4198-afd7-5008077f5ede.jpeg" width="624"></p>


  <p>컴퓨팅 요금이 계속 발생하는 것에 대한 경고는 중요합니다. Azure는 VM에서 발생하는 사용량에 대해 고객에게 요금을 청구합니다. 핵심 리소스를 고수하는 VM은 컴퓨팅, Storage 및 네트워킹 요금을 독립적으로 발생시킬 수 있습니다.</p>


  <p>VM이 프로비전되는 경우 컴퓨팅 요금이 발생합니다. Azure는 여전히 고객에 &lsquo;대한 VM 슬롯을 프로비전했기 때문에 VM이 중지된&rsquo; 상태(위의 경고에 표시된 대로)인 경우에도 요금이 발생합니다. 컴퓨팅 요금이 발생하지 않도록 하는 유일한 방법은 VM을 중지하거나 프로비전을 해제하는 것입니다.</p>


  <p>VM 할당을 중지하면 다른 고객에게 할당할 수 있도록 VM 슬롯의 할당이 취소됩니다. 그러나 디스크의 상태와 함께 VM의 정의는 유지 관리되므로 고객이&rsquo; 선택할 때 VM을 다시 프로비전할 수 있습니다. 할당 취소된 중지 VM은 컴퓨팅 요금이 발생하지 않지만 디스크가 삭제되지 않으므로 Storage 요금이 계속 발생합니다.</p>


  <p>이 단계에서는 로캘, 표준 시간대, 관리자 자격 증명 등의 설정을 포함하여 VM을 처음 만들 때 OS 디스크에 OS 사용자 지정이 수행되지 않음을 의미하는 일반화된 VM이 있습니다. &rsquo;포털에서 중지된 VM을 시작&rsquo;하려고 &lsquo;하면 어떻게 되는지 확인합니다. &lsquo;시작&rsquo; 작업은 간단한 전원 시작을 수행하며 프로비전의 일부로 특수 시퀀스를 통해 VM을 사용하지 않습니다.</p>


  <p>&lsquo;포털에서 시작을&rsquo; 클릭하고 몇 초 후에 VM에 실행&rsquo;이 &lsquo;표시됩니다. RDP에 RDP 시간이 초과되도록 시도합니다 &ndash; . 복구할 부팅 진단입니다.</p>


  <p><img alt="https://blogrgdiag337.blob.core.windows.net/bootdiagnostics-blogwindo-694733ec-46a0-4e0b-a73b-ee0863a0f12c/BlogWindowsVM.694733ec-46a0-4e0b-a73b-ee0863a0f12c.screenshot.bmp" border="0" height="468" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/ee9b7115-de62-4700-b61a-f8c3de2322c7.jpeg" width="624"></p>


  <p>예상대로 이 VM은 디스크가 일반화되고 고객 입력을 기다리는 특수화&rsquo; 순서에 &lsquo;있음을 감지했습니다. 이 VM을 성공적으로 시작할 수 없습니다.</p>


  <p>VM을 sysprep하고 디스크를 일반화한 경우 다음 관리 작업을 통해 하나 이상의 새 VM을 만드는 데 사용할 수 있는 일반화된 이미지를 실현해야 합니다.</p>


  <p><u>VM </u>&ndash; 중지 VM의 전원을 낮추기</p>


  <pre>

  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure vm stop -g BlogRG -n BlogWindowsVM


  info:    Executing command vm stop


  + Looking up the VM &quot;BlogWindowsVM&quot;


  warn:    VM shutdown will not release the compute resources so you will be billed for the compute resources that this Virtual Machine uses.


  info:    To release the compute resources use &quot;azure vm deallocate&quot;.


  + Stopping the virtual machine &quot;BlogWindowsVM&quot;


  info:    vm stop command OK


  <u>Generalize </u>&ndash; meta data change on the VM to mark it generalized


  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure vm generalize -g BlogRG -n BlogWindowsVM


  info:    Executing command vm generalize


  + Looking up the VM &quot;BlogWindowsVM&quot;


  + Generalizing the virtual machine &quot;BlogWindowsVM&quot;


  info:    vm generalize command OK


  <u>Capture </u>&ndash;


  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure vm capture -g BlogRG -n BlogWindowsVM -p CaptureBlogWVM -R capturecontainer -t C:\temp\CaptureVMTemplate.json


  info:    Executing command vm capture


  + Looking up the VM &quot;BlogWindowsVM&quot;


  + Capturing the virtual machine &quot;BlogWindowsVM&quot;


  info:    Saved template to file &quot;C:\temp\CaptureVMTemplate.json&quot;


  info:    vm capture command OK</pre>


  <p>생성된 템플릿을 사용하여 일반화된 이미지를 기반으로 새 VM을 만들 수 있습니다.</p>


  <p>CaptureVMTemplate.json의 스토리지 프로필 살펴보기</p>


  <pre>
          &quot;storageProfile&quot;: {

            &quot;osDisk&quot;: {

              &quot;osType&quot;: &quot;Windows&quot;,

              &quot;name&quot;: &quot;CaptureBlogWVM-osDisk.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd&quot;,

              &quot;createOption&quot;: &quot;FromImage&quot;,

              &quot;image&quot;: {

                &quot;uri&quot;: <a href="https://blogrgdisks562.blob.core.windows.net/system/Microsoft.Compute/Images/capturecontainer/CaptureBlogWVM-osDisk.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd"><u>https://blogrgdisks562.blob.core.windows.net/system/Microsoft.Compute/Images/capturecontainer/CaptureBlogWVM-osDisk.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd</u></a></pre>

  <p>위는 캡처 작업이 생성한 일반화된 이미지의 URL입니다. 이미지가 다른 디스크 VHD와 마찬가지로 페이지 Blob VHD임을 알 수 있습니다. Visual Studio Cloud Explorer에서 OS 데이터에 대해 캡처된 VHD 3개와 데이터 디스크 2개를 볼 수 있습니다. 스토리지 측면에서 디스크 페이지 Blob의 Blob 스냅샷입니다. Blob 스냅샷이 원래 디스크 &ndash; blogrgdisks562와 동일한 스토리지 계정에 있음을 알 수 있습니다.</p>


  <p><img border="0" height="103" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3c6c5b9f-27cf-4105-81cf-4a00d0037365.jpeg" width="624"></p>


  <p>일반화된 OS 디스크 Blob의 세부 정보(명령, 노드 azure Storage Blob 목록 -vv 사용)를 살펴보면 다음과 같은 몇 가지 사항을 확인할 수 있습니다.</p>


  <pre>
    {

      &quot;name&quot;: &quot;Microsoft.Compute/Images/capturecontainer/CaptureBlogWVM-osDisk.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd&quot;,

      &quot;lastModified&quot;: &quot;Sun, 21 Aug 2016 19:14:25 GMT&quot;,

      &quot;etag&quot;: &quot;0x8D3C9F75DB60C73&quot;,

      &quot;contentLength&quot;: &quot;136367309312&quot;,

      &quot;contentSettings&quot;: {

        &quot;contentType&quot;: &quot;application/octet-stream&quot;,

        &quot;contentEncoding&quot;: &quot;&quot;,

        &quot;contentLanguage&quot;: &quot;&quot;,

        &quot;contentMD5&quot;: &quot;en7n+5uiKTbMlrhW59lEGg==&quot;,

        &quot;cacheControl&quot;: &quot;&quot;,

        &quot;contentDisposition&quot;: &quot;&quot;

      },

      &quot;sequenceNumber&quot;: &quot;8&quot;,

      &quot;blobType&quot;: &quot;PageBlob&quot;,

      &quot;lease&quot;: {

        &quot;status&quot;: &quot;unlocked&quot;,</pre>

  <p>이는 일반화된 이미지이므로 미해결 임대 없이 잠금 해제됨</p>


  <pre>
        &quot;state&quot;: &quot;available&quot;

      },

      &quot;copy&quot;: {

        &quot;id&quot;: &quot;b069a713-599d-44ad-85d0-e7e255f9a92c&quot;,

        &quot;progress&quot;: &quot;136367309312/136367309312&quot;,

        &quot;bytesCopied&quot;: 136367309312,

        &quot;totalBytes&quot;: 136367309312,

        &quot;source&quot;: <a href="https://blogrgdisks562.blob.core.windows.net/vhds/BlogWindowsVM2016713231120.vhd?sv=2014-02-14&amp;sr=b&amp;sk=system-1&amp;sig=HTMp66d7wK37Cc12cb2LzDsS6w1YjGyHsIHxPjR2%2F%2F8%3D&amp;st=2016-08-21T18%3A59%3A23Z&amp;se=2016-08-21T20%3A14%3A23Z&amp;sp=rw">https://blogrgdisks562.blob.core.windows.net/vhds/BlogWindowsVM2016713231120.vhd?sv=2014-02-14&amp;sr=b&amp;sk=system-1&amp;sig=HTMp66d7wK37Cc12cb2LzDsS6w1YjGyHsIHxPjR2%2F%2F8%3D&amp;st=2016-08-21T18%3A59%3A23Z&amp;se=2016-08-21T20%3A14%3A23Z&amp;sp=rw</a>,</pre>

  <p>중지된 VM인 BlogWindowsVM의 OS 디스크인 원본 Blob입니다. 복사 추적을 수행하면 Blob이 복사되는 방법을 추적할 수 있습니다. BTW, 원본 Blob에는 VM에 디스크로 연결되므로 이에 대한 무한 임대(여기에 표시되지 않음)가 여전히 있습니다.</p>


  <pre>
        &quot;status&quot;: &quot;success&quot;,

        &quot;completionTime&quot;: &quot;Sun, 21 Aug 2016 19:14:25 GMT&quot;

      },

      &quot;metadata&quot;: {

        &quot;microsoftazurecompute_capturedvmkey&quot;: &quot;/Subscriptions/f028f547-f912-42b0-8892-89ea6eda4c5e/ResourceGroups/BLOGRG/VMs/BLOGWINDOWSVM&quot;,

        &quot;microsoftazurecompute_imagetype&quot;: &quot;OSDisk&quot;,

        &quot;microsoftazurecompute_osstate&quot;: &quot;Generalized&quot;,

        &quot;microsoftazurecompute_ostype&quot;: &quot;Windows&quot;

      }

    }</pre>

  <p>캡처 템플릿 json의 연속</p>


  <pre>
              },

              &quot;vhd&quot;: {

                &quot;uri&quot;: <a href="https://blogrgdisks562.blob.core.windows.net/vmcontainerb05604df-5f0f-4ef2-ab18-76ab7b644cfd/osDisk.b05604df-5f0f-4ef2-ab18-76ab7b644cfd.vhd"><u>https://blogrgdisks562.blob.core.windows.net/vmcontainerb05604df-5f0f-4ef2-ab18-76ab7b644cfd/osDisk.b05604df-5f0f-4ef2-ab18-76ab7b644cfd.vhd</u></a></pre>

  <p>위에서 설명한 대로 Vhd URI는 아직 존재하지 않습니다. 이 템플릿은 배포될 때 만들어집니다.</p>


  <p>이 템플릿을 사용하여 여러 VM을 만들려는 경우 두 번째 VM부터 고유하도록 VHD URI를 변경해야 합니다.</p>


  <pre>
              },

              &quot;caching&quot;: &quot;ReadWrite&quot;

            },

            &quot;dataDisks&quot;: [

              {

                &quot;lun&quot;: 0,

                &quot;name&quot;: &quot;CaptureBlogWVM-dataDisk-0.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd&quot;,

                &quot;createOption&quot;: &quot;FromImage&quot;,

                &quot;image&quot;: {

                  &quot;uri&quot;: &quot;https://blogrgdisks562.blob.core.windows.net/system/Microsoft.Compute/Images/capturecontainer/CaptureBlogWVM-dataDisk-0.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd&quot;

                },

                &quot;vhd&quot;: {

                  &quot;uri&quot;: &quot;https://blogrgdisks562.blob.core.windows.net/vmcontainerb05604df-5f0f-4ef2-ab18-76ab7b644cfd/dataDisk-0.b05604df-5f0f-4ef2-ab18-76ab7b644cfd.vhd&quot;

                },

                &quot;caching&quot;: &quot;ReadWrite&quot;

              },

              {

                &quot;lun&quot;: 1,

                &quot;name&quot;: &quot;CaptureBlogWVM-dataDisk-1.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd&quot;,

                &quot;createOption&quot;: &quot;FromImage&quot;,

                &quot;image&quot;: {

                  &quot;uri&quot;: &quot;https://blogrgdisks562.blob.core.windows.net/system/Microsoft.Compute/Images/capturecontainer/CaptureBlogWVM-dataDisk-1.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd&quot;

                },

                &quot;vhd&quot;: {

                  &quot;uri&quot;: &quot;https://blogrgdisks562.blob.core.windows.net/vmcontainerb05604df-5f0f-4ef2-ab18-76ab7b644cfd/dataDisk-1.b05604df-5f0f-4ef2-ab18-76ab7b644cfd.vhd&quot;

                },

                &quot;caching&quot;: &quot;ReadWrite&quot;

              }

            ]

          },</pre>

  <p>이 시점에서 원래 VM은 중지되지만 컴퓨팅 및 Storage 대한 사용 요금이 누적됩니다. VM을 일정 시간 동안 중지된 상태로 유지하려는 경우 Hyper-V 호스트에서 VM의 할당을 취소하지만 VM &ndash; 메타 데이터 및 디스크 Blob을 Storage 유지하므로 VM 할당을 중지하여 컴퓨팅 요금을 절약할 수 있습니다.</p>


  <pre>

  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure vm deallocate -g BlogRG -n BlogWindowsVM


  info:    Executing command vm deallocate


  + Looking up the VM &quot;BlogWindowsVM&quot;


  + Deallocating the virtual machine &quot;BlogWindowsVM&quot;


  info:    vm deallocate command OK


  get-instance-view command will show the VM status as deallocated (snippets of result below)


  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure vm get-instance-view -g blogrg -n blogwindowsvm &ndash;json

      &quot;osDisk&quot;: {

        &quot;osType&quot;: &quot;Windows&quot;,

        &quot;name&quot;: &quot;BlogWindowsVM&quot;,

        &quot;vhd&quot;: {

          &quot;uri&quot;: <a href="https://blogrgdisks562.blob.core.windows.net/vhds/BlogWindowsVM2016713231120.vhd"><u>https://blogrgdisks562.blob.core.windows.net/vhds/BlogWindowsVM2016713231120.vhd</u></a></pre>

  <p>VM의 할당이 중지된 경우에도 OS 및 데이터 디스크는 유지됩니다.</p>


  <pre>
        },

        &quot;caching&quot;: &quot;ReadWrite&quot;,

        &quot;createOption&quot;: &quot;FromImage&quot;

      },

      &quot;dataDisks&quot;: [

        {

          &quot;lun&quot;: 0,

          &quot;name&quot;: &quot;BlogWindowsVM-20160814-191501427&quot;,

          &quot;vhd&quot;: {

            &quot;uri&quot;: &quot;https://blogrgdisks562.blob.core.windows.net/vhds/BlogWindowsVM-20160814-191501427.vhd&quot;

          },

          &quot;caching&quot;: &quot;ReadWrite&quot;,

          &quot;createOption&quot;: &quot;Empty&quot;,

          &quot;diskSizeGB&quot;: 50

        },

        {

          &quot;lun&quot;: 1,

          &quot;name&quot;: &quot;newdatadisk&quot;,

          &quot;vhd&quot;: {

            &quot;uri&quot;: &quot;https://blogrgdisks562.blob.core.windows.net/newdatadiskc/newdatadisk.vhd&quot;

           },

          &quot;caching&quot;: &quot;ReadWrite&quot;,

          &quot;createOption&quot;: &quot;Empty&quot;,

          &quot;diskSizeGB&quot;: 60

        }

      ]


  ---


  ---

      &quot;statuses&quot;: [

        {

          &quot;code&quot;: &quot;ProvisioningState/succeeded&quot;,

          &quot;level&quot;: &quot;Info&quot;,

          &quot;displayStatus&quot;: &quot;Provisioning succeeded&quot;,

          &quot;time&quot;: &quot;2016-08-22T02:58:42.797Z&quot;

        },

        {

          &quot;code&quot;: &quot;OSState/generalized&quot;,

          &quot;level&quot;: &quot;Info&quot;,

          &quot;displayStatus&quot;: &quot;VM generalized&quot;</pre>

  <p>OS가 일반화되므로 특수화하여 이 VM을 다시 만들 수 있습니다.</p>


  <pre>
        },

        {

          &quot;code&quot;: &quot;PowerState/deallocated&quot;,

          &quot;level&quot;: &quot;Info&quot;,

          &quot;displayStatus&quot;: &quot;VM deallocated&quot;</pre>

  <p>컴퓨팅 VM 리소스 할당이 취소됨</p>


  <p>VM의 할당이 취소된 경우에도 VM이 실행 중일 때처럼 디스크 스토리지 Blob이 계속 잠깁니다. 이는 실수로 삭제되지 않도록 하기 위한 것입니다.</p>


  <p>디스크 Blob의 Blob 속성을 살펴보면 Azure가 Blob에서 무한 임대를 계속 유지한다는 것을 알 수 있습니다.</p>


  <pre>

  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure storage blob list -vv


  name: &#39;BlogWindowsVM-20160814-191501427.vhd&#39;,


  lastModified: &#39;Sun, 21 Aug 2016 19:10:50 GMT&#39;,


  etag: &#39;0x8D3C9F6DD886DB5&#39;,


  contentLength: &#39;53687091712&#39;,


  contentSettings: {

      contentType: &#39;application/octet-stream&#39;,

      contentEncoding: &#39;&#39;,

      contentLanguage: &#39;&#39;,

      contentMD5: &#39;&#39;,

      cacheControl: &#39;&#39;,

      contentDisposition: &#39;&#39;

  },


  sequenceNumber: &#39;1&#39;,


  blobType: &#39;PageBlob&#39;,


  lease: {

      status: &#39;locked&#39;,

      state: &#39;leased&#39;,

      duration: &#39;infinite&#39;

  }</pre>


  <h2>VM 복제</h2>


  <p>이 시점에서 캡처한 일반화된 이미지에서 VM을 복제할 수 있습니다. 캡처 템플릿 json을 사용하거나 일반화된 이미지를 매개 변수 값으로 사용하여 FromImage 옵션을 사용하여 새 이미지를 만들 수 있습니다.</p>


  <p>Azure 빠른 시작 템플릿에서 템플릿을 잡고 충분히 수정하여 CopyBlogVM이라는 새 VM을 만들도록 배포했습니다.</p>


  <pre>

  C:\Program Files (x86)\Microsoft SDKs\Azure\CLI\bin&gt;node azure group deployment create -g BlogRG -n CopyVMDeployment -f &quot;C:\temp\copyvmtemplate\template.json&quot; -e &quot;C:\temp\copyvmtemplate\parameters.json&quot;


  info:    Executing command group deployment create


  + Initializing template configurations and parameters


  + Creating a deployment


  info:    Created template deployment &quot;CopyVMDeployment&quot;


  + Waiting for deployment to complete


  +


  The relevant snippet from the VM template is the storage profile:


  &quot;storageProfile&quot;: {


  &quot;osDisk&quot;: {


  &quot;name&quot;: &quot;[concat(parameters(&#39;virtualMachineName&#39;),&#39;-osDisk&#39;)]&quot;,


  &quot;osType&quot;: &quot;[parameters(&#39;osType&#39;)]&quot;,


  &quot;caching&quot;: &quot;ReadWrite&quot;,


  &quot;createOption&quot;: &quot;fromImage&quot;,


  image&quot;: {


  &quot;uri&quot;: &quot;[parameters(&#39;osDiskVhdUri&#39;)]&quot;


  },


  &quot;vhd&quot;: {


  &quot;uri&quot;: &quot;[concat(concat(reference(resourceId(&#39;blogrg&#39;, &#39;Microsoft.Storage/storageAccounts&#39;, parameters(&#39;storageAccountName&#39;)), &#39;2015-06-15&#39;).primaryEndpoints[&#39;blob&#39;], &#39;vhds/&#39;), parameters(&#39;virtualMachineName&#39;), &#39;20161228010921.vhd&#39;)]&quot;


  }


  },


  &quot;dataDisks&quot;: []


  },</pre>


  <p>OsDiskvhdUri는 매개 변수 파일에서 일반화된 이미지 파일로 설정됩니다.</p>


  <pre>

  &quot;osDiskVhdUri&quot;: {


  &quot;value&quot;: <a href="https://blogrgdisks562.blob.core.windows.net/system/Microsoft.Compute/Images/capturecontainer/CaptureBlogWVM-osDisk.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd"><u>https://blogrgdisks562.blob.core.windows.net/system/Microsoft.Compute/Images/capturecontainer/CaptureBlogWVM-osDisk.694733ec-46a0-4e0b-a73b-ee0863a0f12c.vhd</u></a>


  },</pre>


  <p>CopyBlogVM은 OsDiskvhdUri에서 참조하는 일반화된 OS 디스크의 복사본으로 시작하는 OS 디스크를 사용하여 성공적으로 만듭니다. 일반화된 OD 디스크를 템플릿으로 사용하면 모든 수의 새 VM을 스탬프 아웃할 수 있습니다. 일반적인 시나리오는 새 업데이트/패치를 사용하여 일반화된 VM을 캡처한 다음 업데이트된 이미지를 기반으로 새 VM을 만드는 것입니다.</p>


  <h2>결론적으로</h2>


  <p>두 게시물에서 Azure VM이 작동하는 방식에 대한 세부 정보 중 일부를 설명했습니다. 백업, 암호화, 라이선스, 계획된 유지 관리 및 네트워킹 세부 정보를 포함하여 다루지 않은 다른 기능이 있습니다. 시간 허용,&nbsp; 우리는 미래의 게시물에서 이러한 주제를 방문합니다.</p>
