### YamlMime:Yaml
ms.openlocfilehash: c19200d3c9bcd2525b57d7fb6a0c1e84c5949011
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139897480"
Slug: azure-analysis-services-integration-with-azure-diagnostic-logs
Title: Azure Diagnostic Logs와 Azure Analysis Services 통합
Summary: Azure Analysis Services가 Azure Monitor 리소스 진단 로그와 통합되었음을 알려드립니다. 진단 로깅은 IT 소유 BI 구현의 주요 기능입니다. 우리는 촬영했습니다 ...
Content: >-
  <p>Azure Analysis Services가 Azure <a href="https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs">Monitor 리소스 진단 로그</a>와 통합되었음을 알려드립니다. 진단 로깅은 IT 소유 BI 구현의 주요 기능입니다. 성능 저하 없이 프로덕션 Azure Analysis Services 서버에서 진단 로깅을 자신 있게 실행할 수 있도록 조치를 취했습니다.</p>


  <p>다음을 비롯한 다양한 시나리오가 지원됩니다.</p>


  <ul>
   <li>감사</li>
   <li>서버 상태 모니터링</li>
   <li>사용 메트릭 파생</li>
   <li>데이터 세트를 사용하는 사용자 그룹 및 시기 이해</li>
   <li>장기 실행 또는 문제가 있는 쿼리 검색</li>
   <li>오류가 발생한 사용자 검색</li>
  </ul>


  <p>일반적으로 고객은 온-프레미스에서 SSAS <a href="https://docs.microsoft.com/sql/analysis-services/instances/monitor-analysis-services-with-sql-server-extended-events">확장 이벤트</a> (xEvents)를 사용했습니다. 일반적으로 xEvent 세션 관리, 이진 XEL 파일로의 출력, 파일 내 데이터에 액세스하기 위한 SQL Server 특수 시스템 함수 사용 및 XML 출력의 복잡한 구문 분석이 포함되었습니다. 이 모든 작업을 수행한 후에는 데이터를 어딘가에 저장하고 나중에 분석에 사용할 수 있습니다. 아키텍처의 다른 구성 요소에서 성능 카운터 메트릭 및 로그와 같은 다른 사용량 현황 데이터와 자동으로 통합되지 않는 경우가 많습니다. Azure 진단 로깅을 사용하면 Azure Analysis Services에서 이 프로세스를 더 간단하고 쉽게 수행할 수 있습니다.</p>


  <h2>진단 로깅 설정</h2>


  <p>설정하려면 Azure Portal에서 &ldquo;Azure Analysis Services&rdquo; 서버에 대한 진단 로그 블레이드를 선택합니다. 그런 다음 <strong>진단 설정 추가</strong> 링크를 클릭합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4cc05fdd-380b-466e-81a3-30aa5433fb20.png"><img alt="01 Azure Portal" border="0" height="1187" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e8e9e5a4-65e3-4b48-817a-db166a409caf.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="01 Azure Portal" width="2278"></a></p>


  <p>진단 설정 블레이드가 표시됩니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/37f7ab3c-4c5b-4b7e-a229-1acc9a6a03f8.png"><img alt="02 Diagnostic Settings" border="0" height="486" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/402f815a-7ecb-489b-ac8b-c6c27f874364.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="02 진단 설정" width="485"></a></p>


  <p>여기서 진단 로그에 대해 최대 3개의 대상을 정의할 수 있습니다.</p>


  <ol>
   <li>스토리지 계정에 보관: 로그 파일은 JSON 형식으로 저장됩니다(XEL 파일 아님).</li>
   <li>이벤트 허브로 스트림: 이렇게 하면 빅 데이터 시스템과 같은 광범위한 통합이 가능합니다.</li>
   <li>Log Analytics로 보내기: 이 기능은 기본 제공 분석, 대시보드 및 알림 기능을 제공하는 특히 유용한 <a href="https://azure.microsoft.com/en-us/services/log-analytics/">Azure Log Analytics</a>를 활용합니다.</li>
  </ol>


  <p>다음 로그 범주를 선택할 수 있습니다.</p>


  <ul>
   <li>엔진 범주는 Azure Analysis Services에 다음 xEvents를 기록하도록 지시합니다. SSAS의 xEvents와 달리 개별 xEvent를 선택할 수 없습니다. Log Analytics 모델은 모든 이벤트를 기록하고 나중에 질문하는 것이 상대적으로 저렴하다고 가정합니다. 커뮤니티에서 가장 가치 있는 xEvents라는 피드백을 받았고 서버 성능에 영향을 줄 수 있는 자세한 이벤트를 제외했습니다. 특히 새 기능을 릴리스할 때 향후 추가 xEvent가 추가될 수 있습니다.</li>
  </ul>


  <table border="1" cellpadding="0" cellspacing="0" width="910">
   <tbody>
    <tr>
     <td valign="top" width="291">
     <p><b>(XEvent) 범주</b></p>
     </td>
     <td valign="top" width="617">
     <p><b>이벤트 이름</b></p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>보안 감사</p>
     </td>
     <td valign="top" width="617">
     <p>로그인 감사</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>보안 감사</p>
     </td>
     <td valign="top" width="617">
     <p>로그아웃 감사</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>보안 감사</p>
     </td>
     <td valign="top" width="617">
     <p>서버 시작 및 중지 감사</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>진행률 보고서</p>
     </td>
     <td valign="top" width="617">
     <p>진행률 보고 시작</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>진행률 보고서</p>
     </td>
     <td valign="top" width="617">
     <p>진행률 보고 종료</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>진행률 보고서</p>
     </td>
     <td valign="top" width="617">
     <p>진행률 보고 현재</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>쿼리</p>
     </td>
     <td valign="top" width="617">
     <p>쿼리 시작</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>쿼리</p>
     </td>
     <td valign="top" width="617">
     <p>쿼리 종료</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>명령</p>
     </td>
     <td valign="top" width="617">
     <p>명령 시작</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>명령</p>
     </td>
     <td valign="top" width="617">
     <p>명령 종료</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>오류 &amp; 경고</p>
     </td>
     <td valign="top" width="617">
     <p>Error</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>검색</p>
     </td>
     <td valign="top" width="617">
     <p>검색 종료</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>알림</p>
     </td>
     <td valign="top" width="617">
     <p>알림</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>세션</p>
     </td>
     <td valign="top" width="617">
     <p>세션 초기화</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>잠금</p>
     </td>
     <td valign="top" width="617">
     <p>교착 상태</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>쿼리 처리</p>
     </td>
     <td valign="top" width="617">
     <p>VertiPaq SE 쿼리 시작</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>쿼리 처리</p>
     </td>
     <td valign="top" width="617">
     <p>VertiPaq SE 쿼리 종료</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>쿼리 처리</p>
     </td>
     <td valign="top" width="617">
     <p>VertiPaq SE 쿼리 캐시 일치</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>쿼리 처리</p>
     </td>
     <td valign="top" width="617">
     <p>직접 쿼리 시작</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="291">
     <p>쿼리 처리</p>
     </td>
     <td valign="top" width="617">
     <p>직접 쿼리 종료</p>
     </td>
    </tr>
   </tbody>
  </table>


  <ul>
   <li>서비스 범주에는 다음과 같은 서비스 수준 이벤트가 포함됩니다.</li>
  </ul>


  <table border="1" cellpadding="0" cellspacing="0" width="1197">
   <tbody>
    <tr>
     <td valign="top" width="338">
     <p><b>작업 이름</b></p>
     </td>
     <td valign="top" width="857">
     <p><b>발생 시기</b></p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="338">
     <p>CreateGateway</p>
     </td>
     <td valign="top" width="857">
     <p>사용자가 서버에서 게이트웨이 구성</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="338">
     <p>ResumeServer</p>
     </td>
     <td valign="top" width="857">
     <p>서버 다시 시작</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="338">
     <p>SuspendServer</p>
     </td>
     <td valign="top" width="857">
     <p>서버 일시 중지</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="338">
     <p>DeleteServer</p>
     </td>
     <td valign="top" width="857">
     <p>서버 삭제</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="338">
     <p>RestartServer</p>
     </td>
     <td valign="top" width="857">
     <p>사용자가 SSMS 또는 PowerShell을 통해 서버 다시 시작</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="338">
     <p>GetServerLogFiles</p>
     </td>
     <td valign="top" width="857">
     <p>사용자가 PowerShell을 통해 서버 로그 내보내기</p>
     </td>
    </tr>
    <tr>
     <td valign="top" width="338">
     <p>ExportModel</p>
     </td>
     <td valign="top" width="857">
     <p>사용자가 Azure Portal에서 모델을 내보냅니다. 예를 들어 Power BI Desktop &quot;열기, &quot;Visual Studio&quot; 열기&quot;</p>
     </td>
    </tr>
   </tbody>
  </table>


  <ul>
   <li>모든 메트릭 범주는 메트릭 판독값에 대한 이벤트를 기록합니다. Azure Analysis Services 서버에 대한 Azure Portal의 메트릭 블레이드에 표시되는 것과 동일한 메트릭입니다.</li>
  </ul>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/60ae0a21-8895-429d-bd11-41ccc30c9812.png"><img alt="03 Metrics" border="0" height="840" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/44109d92-1807-4552-9a49-f3b89e141f2a.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="03 메트릭" width="1789"></a></p>


  <p>메트릭 및 서버 이벤트는 병렬 분석을 위해 Log Analytics에서 xEvents와 통합됩니다. Log Analytics는 고객 아키텍처 전반의 진단 로깅 데이터에 대한 전체적인 보기를 제공하는 다양한 다른 Azure 서비스에서 이벤트를 받도록 구성할 수도 있습니다. <a href="https://docs.microsoft.com/powershell/module/azurerm.insights/set-azurermdiagnosticsetting">Set-AzureRmDiagnosticSetting</a> cmdlet을 사용하여 PowerShell에서 진단 설정을 추가할 수 있습니다.</p>


  <h2>Log Analytics에서 진단 로그 사용</h2>


  <p>일부 로그 데이터가 이미 생성된 상태에서 Azure Portal의 Log Analytics 섹션으로 이동하여 대상 &ldquo;OMS 작업 영역을&rdquo; 선택합니다. 그런 다음 <strong>로그 검색</strong>을 클릭합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/546af022-7403-4859-a69d-4438f662dda4.png"><img alt="04 Log Analytics" border="0" height="1339" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/50feecb5-c593-4f30-b8b5-ede7d6b0e9bd.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="04 Log Analytics" width="2788"></a></p>


  <p><strong>수집된 모든 데이터를</strong> 클릭하여 시작합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1ec55035-049a-4475-a6a3-02460c76058e.png"><img alt="05 Log Search" border="0" height="140" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5b299c5c-91fa-4986-93a2-38b17dd04210.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="05 로그 검색" width="389"></a></p>


  <p>그런 다음 <strong>AzureDiagnostics를 </strong>클릭하고 <strong>적용</strong>합니다. AzureDiagnostics에는 엔진 및 서비스 이벤트가 포함됩니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/53c2c314-5d35-4e71-b732-047c59fac55a.png"><img alt="06 Azure Diagnostics" border="0" height="1229" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/18e18b7e-1b91-4b48-b6c0-e622251cbac0.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="06 Azure Diagnostics" width="2005"></a></p>


  <p>Log Analytics 쿼리는 즉시 생성됩니다. EventClass_s 필드에는 xEvent 이름이 포함되어 있으며, 온-프레미스에서 xEvent를 사용한 경우 친숙해 보일 수 있습니다. EventClass_s 클릭하거나 이벤트 이름 중 하나를 클릭하면 Log Analytics는 사용자 인터페이스의 상호 작용에 따라 쿼리를 계속 생성합니다. Log Analytics는 나중에 다시 사용할 수 있도록 검색을 저장할 수 있습니다.</p>


  <p>이 게시물은 Log Analytics 데이터 사용에 관한 빙산의 일각에 대해서만 설명합니다. 예를 들어 <a href="https://www.microsoft.com/cloud-platform/operations-management-suite">Operations Management Suite는 Log Analytics</a> 데이터에 대한 향상된 쿼리, 대시보드 및 경고 기능이 있는 웹 사이트를 제공합니다.</p>


  <h2>검색 쿼리 샘플</h2>


  <p>다음 샘플 쿼리는 완료하는 데 5분(300,000밀리초)이 걸린 Azure Analysis Services에 제출된 쿼리를 반환합니다. 제네릭 xEvent 열은 일반적으로 문자열로 저장되므로 _s&rdquo; 접미사로 &ldquo;끝납니다. 5분 넘게 걸린 쿼리를 필터링하려면 Duration_s 숫자 값으로 캐스팅해야 합니다. 이 작업은 toint() 구문을 사용하여 수행할 수 있습니다.</p>


  <p>검색 * | where ( Type == &quot;AzureDiagnostics&quot; ) | where ( EventClass_s == &quot;QUERY_END&quot; ) | where toint(Duration_s) &gt; 300000</p>


  <h2>쿼리 규모 확장</h2>


  <p>스케일 아웃을 사용하는 경우 ServerName_s 필드 값에 이름에 복제본 인스턴스 번호가 추가되어 있으므로 읽기 전용 복제본을 식별할 수 있습니다. 자원 필드에는 Azure 리소스 이름이 포함됩니다. 이것은 사용자에게 표시되는 서버 이름과 일치합니다. 또한 IsQueryScaleoutReadonlyInstance_s 필드는 복제본의 경우 true와 같습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0b7420d3-d71f-49f4-850d-fb1e2eb59547.png"><img alt="08 Scale out" border="0" height="421" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/269f613f-484c-4a4d-889b-0fdc8930d1fa.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="08 규모 확장" width="571"></a></p>


  <h2>Power BI 진단 로그 사용</h2>


  <p>대부분의 BI 전문가를 위한 Log Analytics 데이터의 잠금을 해제하는 기능은 Power BI 단추입니다. M 식을 포함하는 텍스트 파일을 다운로드하려면 클릭하기만 하면 됩니다. 이 파일은 Power BI Desktop 빈 쿼리에 붙여넣을 수 있습니다. 식은 현재 Log Analytics 쿼리를 포함하며 Log Analytics REST API에서 사용합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b6629a3f-4ea0-426b-bb67-fb2b1d72941d.png"><img alt="09 Power BI button" border="0" height="118" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/06de35ee-7151-4974-8119-9203813a33a3.png" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="09 Power BI 단추" width="694"></a></p>


  <p>이렇게 하면 아래 정보를 보여 주는 다음과 같은 다양한 분석 보고서를 사용할 수 있습니다.</p>


  <ul>
   <li>S4 서버가 100GB 메모리 제한에 도달하지 않습니다.</li>
   <li>시간 범위 동안 QPU가 최대화됩니다. S4 서버는 400 QPU로 제한됩니다.</li>
   <li>처리/데이터 새로 고침 작업 중에 장기 실행 쿼리가 수행되었습니다.</li>
   <li>사용자는 장기 실행 쿼리와 처리 작업 간의 경합으로 인해 시간 초과 오류를 받았습니다.</li>
   <li>서버는 쿼리 규모 확장에 적합한 후보일 수 있습니다<a href="https://microsoft-my.sharepoint.com/personal/chwade_microsoft_com/Documents/Microsoft/Blog Posts/Diagnostic Logs/#_msocom_1" name="_msoanchor_1">&nbsp;</a>.</li>
  </ul>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9ebdf502-5cc3-4722-9ef0-a84ddd85e7cd.png"><img alt="10 Power BI report" border="0" height="1359" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3cfe04a1-73c9-4fdc-82af-913307565947.png" style="padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;" title="10 Power BI 보고서" width="2179"></a></p>


  <p>Azure Monitor 리소스 진단 로그와 Azure Analysis Services 통합은 감사 및 모니터링을 위한 풍부한 기능을 제공하고, 메트릭 데이터와 같은 다른 데이터와 함께 xEvent 데이터를 나란히 분석하며, 온-프레미스의 xEvents보다 쉽게 설정할 수 있다는 데 동의하기를 바랍니다&rsquo;. 즐겨보세요!</p>
