### YamlMime:Yaml
ms.openlocfilehash: 8e61f2523687e1c964125179d3bd77bd0936f1bf
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139901432"
Slug: automate-always-on-availability-group-deployments-with-sql-virtual-machine-resource-provider
Title: SQL Virtual Machine 리소스 공급자를 사용하여 Always On 가용성 그룹 배포 자동화
Summary: 이제 SQL VM 리소스 공급자를 사용하여 Azure VM(Virtual Machines)에서 SQL Server 위한 고가용성 솔루션을 구성하는 새롭고 자동화된 방법을 공유할 수 있게 되어 기쁩니다.
Content: >-
  <p>이제 SQL <a href="https://azure.microsoft.com/en-us/blog/sql-server-on-azure-virtual-machine-resource-provider/" target="_blank"><strong>VM 리소스 공급자</strong></a><strong>를 사용하여 Azure VM(Virtual Machines)에서 SQL Server 위한 고가용성 솔루션을 구성하는 새롭고 자동화된 방법을 공유할 수 있게 되어 기쁩니다</strong><strong>.</strong></p>


  <p><strong>오늘 시작하려면 아래 표의 지침을 따르세요.</strong></p>


  <p>고가용성 아키텍처는 데이터베이스, 하드웨어 또는 네트워크 오류가 있는 경우에도 계속 작동하도록 설계되었습니다. 모든 운영 체제 디스크 및 데이터 디스크에 Premium Storage 사용하는 Azure Virtual Machine 인스턴스는 99.9%의 가용성을 제공합니다. 이 SLA는 계획되지 않은 하드웨어 유지 관리, 예기치 않은 가동 중지 시간 및 계획된 유지 관리의 세 가지 시나리오 &ndash; 에 의해 영향을 받습니다.</p>


  <p>애플리케이션에 중복성을 제공하려면 계획된 유지 관리 또는 계획되지 않은 유지 관리 이벤트 중에 하나 이상의 가상 머신을 사용할 수 있도록 <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/tutorial-availability-sets" target="_blank">가용성 집합</a> 에서 둘 이상의 가상 머신을 그룹화하는 것이 좋습니다. 또는 데이터 센터 오류로부터 보호하기 위해 동일한 Azure 지역의 두 개 이상의 가용성 영역에 둘 이상의 VM 인스턴스를 배포할 수 있습니다. 이렇게 하면 적어도 99.99% 이상의 시간에 하나 이상의 인스턴스에 Virtual Machine 연결이 보장됩니다. 자세한 내용은 <a href="https://azure.microsoft.com/support/legal/sla/virtual-machines/" target="_blank">Virtual Machines용</a>&ldquo; SLA를 참조하세요.&rdquo;</p>


  <p>이러한 메커니즘은 가상 머신 인스턴스의 고가용성을 보장합니다. <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-iaas-overview" target="_blank">Azure VM에서 SQL Server</a> 동일한 SLA를 얻으려면 Azure VM에서 <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr" target="_blank">SQL Server 대한 고가용성 솔루션을</a> 구성해야 합니다. 현재 수동 <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-availability-group-tutorial" target="_blank">구성</a>에 대한 간단하고 신뢰할 수 있는 대안으로 SQL <a href="https://azure.microsoft.com/en-us/blog/sql-server-on-azure-virtual-machine-resource-provider/" target="_blank">VM 리소스 공급자</a>(RP)를 사용하여 Azure VM에서 SQL Server Always On AG(가용성 그룹)를 구성하는 새로운 자동화된 방법을 도입하고 있습니다.</p>


  <p><a href="https://azure.microsoft.com/en-us/blog/sql-server-on-azure-virtual-machine-resource-provider/" target="_blank">SQL VM 리소스 공급자</a>는 다양한 Azure 리소스의 프로비저닝을 오케스트레이션하고 함께 작동하도록 연결하여 Always On AG 설정을 자동화합니다. SQL VM RP를 사용하면 Always On AG를 아래 설명된 대로 세 단계로 구성할 수 있습니다.</p>


  <table border="1" cellpadding="2">
      <tbody>
          <tr>
              <td valign="top"><strong>단계</strong></td>
              <td valign="top"><strong>VM RP 리소스 종류 SQL</strong></td>
              <td valign="top"><strong>배포하는 방법</strong></td>
              <td valign="top"><strong>필수 구성 요소</strong></td>
          </tr>
          <tr>
              <td valign="top"><strong>1 &ndash; 단계 Windows 장애 조치(failover) 클러스터</strong></td>
              <td valign="top">SqlVirtualMachineGroup</td>
              <td valign="top"><a href="https://github.com/Azure/azure-quickstart-templates/tree/master/101-sql-vm-ag-setup" target="_blank">자동화된 &ndash; ARM 템플릿</a></td>
              <td valign="top">VM은 SQL Server 2016 또는 2017 Marketplace 이미지에서 만들어야 하고, 동일한 서브넷에 있어야 하며, AD 도메인에 가입해야 합니다.</td>
          </tr>
          <tr>
              <td valign="top"><strong>2 &ndash; 단계 가용성 그룹</strong></td>
              <td valign="top">해당 없음</td>
              <td valign="top">설명서</td>
              <td valign="top">1단계</td>
          </tr>
          <tr>
              <td valign="top"><strong>3 &ndash; 단계 가용성 그룹 수신기</strong></td>
              <td valign="top">SqlVirtualMachineGroup/AvailabilityGroupListener</td>
              <td>
              <p>3.1 수동 &ndash; 내부 Azure Load Balancer 리소스 만들기</p>

              <p>3.2 자동화된 &ndash; <a href="https://github.com/Azure/azure-quickstart-templates/tree/master/101-sql-vm-aglistener-setup" target="_blank">ARM 템플릿 AG 수신기 만들기 및 구성</a></p>
              </td>
              <td>
              <p>3.1 수동 &ndash; 없음</p>

              <p>3.2 자동화된 &ndash; 2단계</p>
              </td>
          </tr>
      </tbody>
  </table>


  <h2>필수 조건</h2>


  <p>먼저 Azure Marketplace SQL Server VM 이미지에서 Always On AG 복제본을 호스트하는 SQL VM 인스턴스를 배포해야 합니다. 현재 SQL VM 리소스 공급자는 SQL Server 2016 및 SQL Server 2017 Enterprise 버전에 대해서만 자동화된 Always On AG를 지원합니다.</p>


  <p>각 SQL VM 인스턴스는 Azure VM에서 호스트되거나 네트워크 페어링을 통해 온-프레미스에서 Azure로 확장되는 Active Directory 도메인에 조인되어야 합니다. VM 인스턴스는 수동으로 또는 <a href="https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-domain-join" target="_blank">Azure 빠른 시작 도메인 가입 템플릿</a>을 실행하여 Active Directory 도메인에 조인할 수 있습니다.</p>


  <p>Always On AG 복제본을 호스트할 모든 SQL VM 인스턴스는 동일한 VNet 및 동일한 서브넷에 있어야 합니다.</p>


  <p><strong>1.Windows 장애 조치(failover) 클러스터 구성</strong></p>


  <p>Microsoft.SqlVirtualMachine/SqlVirtualMachineGroup 리소스는 버전 및 버전, 정규화된 도메인 이름, 클러스터를 관리하는 AD 계정 및 클라우드 감시로 스토리지 계정을 포함하여 Windows 장애 조치(failover) 클러스터에 대한 메타데이터를 정의합니다. 첫 번째 SQL VM을 SqlVirtualMachineGroup에 조인하면 Windows 장애 조치(failover) 클러스터 서비스를 부트스트랩하고 VM을 클러스터에 조인합니다. 이 단계는 Azure 빠른 시작에서 <a href="https://github.com/Azure/azure-quickstart-templates/tree/master/101-sql-vm-ag-setup" target="_blank">101-sql-vm-ag-setup</a>으로 사용할 수 있는 ARM 템플릿을 사용하여 자동화할 수 있습니다.</p>


  <p><strong>2. Always On AG 구성</strong></p>


  <p>Windows 장애 조치(failover) 클러스터 서비스가 첫 번째 단계에서 구성되므로 주 Always On AG 복제본의 SSMS 통해 Always On AG를 만들 수 있습니다. 이 단계를 수동으로 수행해야 합니다.</p>


  <p><strong>3. Always On AG 수신기 만들기</strong></p>


  <p>Always On AG 수신기에는 Azure Load Balancer(LB)가 필요합니다. Load Balancer는 &ldquo;AG 수신기에 대한 부동&rdquo; IP 주소를 제공하여 더 빠른 장애 조치(failover) 및 다시 연결을 허용합니다. 가용성 그룹의 일부인 SQL VM이 동일한 가용성 집합에 있는 경우 기본 Load Balancer를 사용할 수 있습니다. 그렇지 않으면 표준 Load Balancer를 사용해야 합니다. Load Balancer는 SQL VM 인스턴스와 동일한 VNet에 있어야 합니다. SQL VM RP는 AG 수신기에 대한 내부 Load Balancer를 지원합니다. AG 수신기를 프로비전하기 전에 ILB를 수동으로 만들어야 합니다.</p>


  <p>ILB 이름, 가용성 그룹 이름, 클러스터 이름, SQL VM 리소스 ID 및 AG 수신기 IP 주소 및 이름을 제공하여 Microsoft.SqlVirtualMachine/Sql Virtual Machine Groups/AvailabilityGroupListener 리소스를 프로비전하면 AG 수신기가 만들어지고 구성됩니다. SQL VM RP는 네트워크 설정을 처리하고, ILB 백 엔드 풀 및 상태 프로브를 구성하고, 마지막으로 지정된 IP 주소와 이름으로 AG 수신기를 만듭니다. 이 단계의 결과로 동일한 VNet 내의 모든 VM은 AG 수신기 이름을 통해 Always On AG에 연결할 수 있습니다. 이 단계는 <a href="https://github.com/Azure/azure-quickstart-templates/tree/master/101-sql-vm-aglistener-setup" target="_blank">101-sql-vm-aglistener-setup</a>으로 Azure 빠른 시작에서 사용할 수 있는 ARM 템플릿을 사용하여 자동화할 수 있습니다.</p>


  <p>SQL VM RP를 사용하는 자동화된 Always On AG는 인프라 및 네트워크 구성 세부 정보를 처리하여 Always On 가용성 그룹 구성을 간소화합니다. 올바른 리소스 종속성 설정 및 내부 재시도 정책을 사용하여 신뢰할 수 있는 배포 방법을 제공합니다. 현재 SQL VM RP를 사용하여 자동화된 Always On 가용성 그룹을 배포하여 Azure Virtual Machines에서 SQL Server 고가용성을 개선해 보세요.</p>


  <p>현재 리소스 공급자가 사용하도록 설정된 이러한 확장된 <a href="https://azure.microsoft.com/en-us/services/virtual-machines/sql-server/" target="_blank">SQL Server Azure Virtual Machine</a> 기능을 활용하기 시작합니다. 질문이 있거나 제안하려는 경우 <a href="https://aka.ms/sqlfeedback" target="_blank">UserVoice</a>를 통해 문의할 수 있습니다. 여러분의 소중한 의견을 기다리고 있습니다.</p>
