### YamlMime:Yaml
ms.openlocfilehash: 518a6f1f5e28be78bf12837e71bfc2d29f8524a0
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139908437"
Slug: debugging-arm-template-deployments
Title: ARM 템플릿 배포 디버깅
Summary: 템플릿 배포 오류를 쉽게 디버그할 수 있도록 새 기능을 추가했습니다.
Content: "<p>템플릿 배포 오류를 쉽게 디버그할 수 있도록 새 기능을 추가했습니다. 이 새로운 기능을 사용하면 배포와 연결된 각 배포 작업에 대한 요청 콘텐츠, 응답 콘텐츠 또는 둘 다를 가져올 수 있습니다. 이 정보는 각 배포 작업에 대해 전송되거나 반환된 정확한 콘텐츠를 볼 수 있으므로 많은 시나리오에서 매우 유용합니다.</p>\n\n<p>새 배포를 만드는 동안 PowerShell 또는 CLI에서 이를 사용하도록 설정할 수 있습니다. PowerShell에서는 이 설정을 사용하도록 설정하기 위해 New-AzureRmResourceGroupDeployment 새 매개 변수를 추가했습니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/65afecd7-c25a-4df9-80c6-5cd7ef2d7ff5.png\"><img alt=\"image\" border=\"0\" height=\"117\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/36b32d69-31e6-4d11-b956-cf9a0f43590b.png\" style=\"border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: 0px; margin-left: 0px; display: inline; background-image: none;\" title=\"이미지\" width=\"760\"></a></p>\n\n<p>위에서 볼 수 있듯이 지원되는 세 가지 주요 옵션이 있습니다.</p>\n\n<ul>\n <li><strong>RequestContent: </strong> 이 값을 설정&nbsp; 하면 각 배포 작업에 대한 http 요청과 연결된 콘텐츠가 기록됩니다. 콘텐츠 형식은 JToken입니다. 작업의 쓰기 요청 내용이 기록됩니다. 비동기 작업의 상태를 확인하기 위한 다음 요청의 내용은 기록되지 않습니다. 리소스 만들기의 경우 PUT 콘텐츠, listKeys용 POST 등을 예로 &ndash; 들어봅니다.</li>\n <li><strong>ResponseContent: </strong> 이 값을 설정하면 각 배포 작업에 대한 http 응답과 연결된 콘텐츠가 기록됩니다. 해당 작업의 마지막 응답 내용이 됩니다.</li>\n <li><strong>모든 </strong>&ndash; 이 값을 설정하면 각 배포 작업에 대한 요청 콘텐츠와 응답 콘텐츠가 모두 기록됩니다.</li>\n</ul>\n\n<p><strong>참고:</strong> 디버그 세부 정보를 로깅할 때는 주의해야 합니다. 리소스 속성 또는 listKeys 작업에 사용되는 암호와 같은 비밀을 잠재적으로 로깅하고 노출할 수 있습니다. 그러면 배포 작업을 검색할 때 반환됩니다.</p>\n\n<p>CLI에서 다음과 같은 설정을 적용할 수 있습니다.</p>\n\n<pre class=\"prettyprint\">\nazure group deployment create --debug-setting</pre>\n\n<p>간단한 템플릿을 배포하여 이 추가 정보를 디버깅에 사용하는 방법을 확인할 수 있습니다.&nbsp; 이 예제에서는 Windows Virtual Machine을 프로비전하는 빠른 시작 갤러리에서 <a href=\"https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-simple-windows\">이 템플릿</a>을 사용했습니다. 나는 그것을 몇 가지 변경하고 배포하려고했다.</p>\n\n<p>다음 메시지와 함께 배포에 실패했습니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5f1b8bfb-4a22-4685-acdd-8e2f022a1130.png\"><img alt=\"image\" border=\"0\" height=\"144\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/44d2be04-d7c1-458e-b916-604c36d632d6.png\" style=\"border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; display: inline; background-image: none;\" title=\"이미지\" width=\"1209\"></a></p>\n\n<p>위의 메시지&rsquo;에서 가상 머신의 크기에 문제가 있음을 분명히 합니다. 그러나 어떤 크기가 선택되었는지, 그 결과로 실패한 이유를 알려주지 않습니다&rsquo;. 이제 이 새로운 기능을 사용하여 배포의 각 작업과 함께 전송된 요청 콘텐츠를 가져올 수 있습니다. 따라서 위에서 설명한 대로 배포를 만들 때 이 설정을 사용하도록 설정한 경우 다음 명령을 실행하여 작업을 가져올 수 있습니다.</p>\n\n<pre class=\"prettyprint\">\n$operations = Get-AzureRmResourceGroupDeploymentOperation &ndash;DeploymentName &lt;deploymentName&gt; &ndash;ResourceGroupName &lt;resourceGroupName&gt; </pre>\n\n<p>이렇게 하면 이 배포의 일부인 모든 작업이 표시됩니다. 각 작업에 대한 요청 및 응답 콘텐츠는 다음과 같이 속성 모음에서 검색할 수 있습니다.</p>\n\n<pre class=\"prettyprint\">\n$operations[0].Properties.Request</pre>\n\n<pre class=\"prettyprint\">\n$operations[0].Properties.Response</pre>\n\n<p>각 작업의 속성을 통해 문제를 파악하는 대신 다음과 같이 모든 배포 작업에 대한 요청 및 응답 콘텐츠를 가져올 수 있습니다.</p>\n\n<pre class=\"prettyprint\">\nforeach($operation in $operations)\n\n{\n    Write-Host $operation.id\n    Write-Host &quot;Request:&quot;\n    $operation.Properties.Request | ConvertTo-Json -Depth 10\n    Write-Host &quot;Response:&quot;\n    $operation.Properties.Response | ConvertTo-Json -Depth 10\n}\n</pre>\n\n<p>이러한 작업 중 하나의 경우 요청 및 응답은 아래와 같습니다.</p>\n\n<pre class=\"prettyprint\">\nRequest: \n\n{\n    &quot;Content&quot;: {\n        &quot;Location&quot;: &quot;westus&quot;,\n        &quot;Properties&quot;: {\n            &quot;HardwareProfile&quot;: {\n                &quot;VmSize&quot;: &quot;[concat(<span style=\"background-color: rgb(255, 255, 0);\">\\u0027Standard\\u0027,\\u0027_D1\\u0027</span>&quot;\n            },\n            &quot;OsProfile&quot;: {\n                &quot;ComputerName&quot;: &quot;SimpleWindowsVM&quot;\n            },\n            &quot;StorageProfile&quot;: {\n                &quot;ImageReference&quot;: {\n                    &quot;Publisher&quot;: &quot;MicrosoftWindowsServer&quot;,\n                    &quot;Offer&quot;: &quot;WindowsServer&quot;,\n                    &quot;Sku&quot;: &quot;2012-R2-Datacenter&quot;,\n                    &quot;Version&quot;: &quot;latest&quot;\n                },\n                &quot;OsDisk&quot;: {\n                    &quot;Name&quot;: &quot;osdisk&quot;,\n                    &quot;Vhd&quot;: {\n                        &quot;Uri&quot;: &quot;https://xxyy.blob.core.windows.net/vhds/osdiskforwindowssimple.vhd&quot;\n                    },\n                    &quot;Caching&quot;: &quot;ReadWrite&quot;,\n                    &quot;CreateOption&quot;: &quot;FromImage&quot;\n                },\n                &quot;DataDisks&quot;: [{\n                    &quot;Name&quot;: &quot;datadisk1&quot;,\n                    &quot;DiskSizeGB&quot;: &quot;100&quot;,\n                    &quot;Lun&quot;: 0,\n                    &quot;Vhd&quot;: {\n                        &quot;Uri&quot;: &quot;https://xxyy.blob.core.windows.net/vhds/datadisk1.vhd&quot;\n                    },\n                    &quot;CreateOption&quot;: &quot;Empty&quot;\n                }]\n            },\n            &quot;NetworkProfile&quot;: {\n                &quot;NetworkInterfaces&quot;: [{\n                    &quot;Id&quot;: &quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGro\n                               ups/ravdeleterg4/providers/Microsoft.Network/networkInterfaces/myVMNic&quot;\n                }]\n            },\n            &quot;DiagnosticsProfile&quot;: {\n                &quot;BootDiagnostics&quot;: {\n                    &quot;Enabled&quot;: &quot;true&quot;,\n                    &quot;StorageUri&quot;: &quot;https://xxyy.blob.core.windows.net&quot;\n                }\n            }\n        }\n    }\n}\nResponse:\n\n {\n    &quot;Content&quot;: {\n        &quot;Error&quot;: {\n            &quot;Code&quot;: &quot;InvalidParameter&quot;,\n            &quot;Target&quot;: &quot;vmSize&quot;,\n            &quot;Message&quot;: &quot;The value of parameter vmSize is invalid.&quot;\n        }\n    }\n}\n\n</pre>\n\n<div>위의 내용은 VmSize에 대해 설정된 값을 명확하게 보여 줍니다. 이것은 매우 기본적인 시나리오였습니다. 그러나 이러한 정보는 중첩된 배포, 복잡한 개체 등을 포함하는 복잡한 템플릿을 디버깅할 때 매우 유용할 수 있습니다.</div>\n\n<p>이 유용성 및 피드백이 있다면 알려주세요!</p>\n\n<p>배포 오류 문제 해결에 대한 자세한 내용은 이 설명서 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/resource-manager-troubleshoot-deployments-portal/\">문서를</a> 참조하세요.</p>"
