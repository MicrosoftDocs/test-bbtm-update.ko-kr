### YamlMime:Yaml
ms.openlocfilehash: e5fba28f9ea8cb24c38c56c3f1819dbe6e2519d1
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905363"
Slug: mission-critical-performance-with-ultra-ssd-for-sql-server-on-azure-vm
Title: Azure VM에서 SQL Server 위한 Ultra SSD를 사용하는 중요 업무용 성능
Summary: 최근에 Premium Storage 구성 옵션에서 TPC-E 프로필 테스트 워크로드를 실행한 테스트 결과를 요약하여 Azure VM에 SQL Server 대한 Storage 구성 지침을 게시했습니다. Ultra SSD를 포함하여 이 테스트를 계속했습니다.
Content: >-
  <p><em>이 블로그 게시물은 광산 Tokus, 수석 프로그램 관리자, COGS 데이터 - SQL DB에 의해 작성되었습니다.</em></p>


  <p>최근에 SQL Database 엔진 블로그<a href="https://blogs.msdn.microsoft.com/sqlserverstorageengine/2018/09/25/storage-configuration-guidelines-for-sql-server-on-azure-vm/" target="_blank">에서 Azure VM</a>&rdquo;에 SQL Server 대한 Storage 구성 지침을 게시 &ldquo; 했습니다. 프리미엄 스토리지 구성 옵션에서 TPC-E 프로필 테스트 워크로드를 실행한 테스트 결과를 요약한 것입니다. Ultra SSD를 포함하여 이 테스트를 계속했습니다. <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/disks-ultra-ssd" target="_blank">Ultra SSD</a>는 처리량이 높은 대기 시간이 밀리초 미만인 중요 업무용 워크로드에 대해 Microsoft Azure 사용할 수 있는 새로운 스토리지 제품입니다. 이 블로그에서 테스트 세부 정보 및 결과를 요약합니다.</p>


  <p>이 테스트에서는 16개 코어, 112GB 메모리 및 224GB 로컬 SSD가 있는 DS14_v2 VM을 사용했습니다. 이 VM(가상 머신)은 최대 51,200개의 캐시되지 않은 IOPS 및 64,000개의 캐시된 임시 IOPS를 확장할 수 있습니다. 테스트 워크로드로 전자 상거래/무역 공간에서 TPC-E 워크로드 대표 OLTP 앱을 선택했습니다. 테스트 워크로드는 유사한 비율의 읽기 및 쓰기 IO 활동을 구동합니다.</p>


  <table border="1" cellpadding="1" cellspacing="0">
      <tbody>
          <tr>
              <td valign="top"><strong>크기</strong></td>
              <td valign="top"><strong>vCPU</strong></td>
              <td valign="top"><strong>메모리: GiB</strong></td>
              <td valign="top"><strong>임시 스토리지(SSD) GiB</strong></td>
              <td valign="top"><strong>최대 캐시된 임시 스토리지 처리량: IOPS/MBps(GiB 단위의 캐시 크기)</strong></td>
              <td valign="top"><strong>캐시되지 않은 최대 디스크 처리량: IOPS/MBps</strong></td>
          </tr>
          <tr>
              <td valign="top">Standard_DS14_v2</td>
              <td valign="top">16</td>
              <td valign="top">112</td>
              <td valign="top">224</td>
              <td valign="top">64,000/512 (576)</td>
              <td valign="top">51,200/768</td>
          </tr>
      </tbody>
  </table>


  <h2>Premium Storage 구성</h2>


  <p>Premium Storage 구성의 경우 10개의 -P30 디스크를 추가하고 모든 디스크에 대해 RO 캐시를 사용하도록 설정했습니다. VM에 50,000 IOPS를 사용할 수 있는 10개의 디스크에 단일 스토리지 풀을 만들었습니다. SQL Server 데이터, 로그 및 Temp DB 파일을 10-P30 디스크의 단일 스토리지 풀에 배치했습니다. 이는 Azure Marketplace 이미지에서 만든 SQL VM에 대한 포털을 통해 <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-storage-configuration" target="_blank">Storage 구성</a> 기능을 사용할 때 SQL 파일이 배치되는 방식과 정확히 동일합니다.</p>


  <h2>Ultra SSD 구성</h2>


  <p>Ultra SSD를 사용하면 최대 50,000 IOPS까지 확장할 수 있는 1TB의 Ultra SSD 디스크가 하나만 필요합니다. Ultra SSD는 유연하게 구성할 수 있으며 크기는 IOPS를 독립적으로 확장할 수 있습니다. Premium Storage 구성에서는 10개의 P30 디스크를 사용하여 데이터베이스가 1TB 미만이므로 필요하지 않은 10TB 용량을 가져오는 50,000 IOPS를 가져와야 했습니다. Ultra SSD를 사용하면 정확한 크기, IOPS 및 처리량 요구 사항으로 디스크를 프로비전할 수 있으며 프로비전된 용량에 대해서만 비용을 지불합니다. 또한 하나의 Ultra SSD 디스크가 최대 50,000 IOPS(최대 160,000)까지 확장할 수 있으므로 스토리지 풀을 만들 필요가 없었습니다. 단일 디스크는 데이터, 로그 및 Temp DB를 포함하여 모든 SQL Server 파일을 호스트합니다. Ultra SSD는 읽기에 캐시 구성이 필요하지 않으며, 새로운 아키텍처 및 하드웨어를 사용하여 모든 읽기 및 쓰기에 대해 이미 밀리초 미만의 대기 시간을 제공합니다. 따라서 디스크에 대한 캐시를 구성하지 않았습니다.</p>


  <h2>테스트 결과</h2>


  <p>TPC-E 프로필 테스트 워크로드를 1시간 동안 실행하여 처음 10분 동안 부하를 쌓고 40분 동안 최고조에 달했습니다. Ultra SSD를 실행하는 동안 평균 디스크 읽기 및 쓰기 대기 시간이 1ms 미만인 것을 관찰했습니다. 여기서 Premium Storage 풀에서는 평균 쓰기 대기 시간이 4ms이고 읽기 대기 시간은 1ms였습니다. 동일한 VM에서 10개의 -P30 디스크를 동일한 구성의 SQL Server 및 테스트 워크로드로 단일 Ultra SSD 드라이브로 대체하여 33% 더 많은 SQL Server 처리량을 구동할 수 있습니다. 테스트 중 CPU 사용량은 약 70%였으며, 워크로드가 더 많은 경우 처리량 증가가 더 큽니다.</p>


  <table border="1" cellpadding="1" cellspacing="0">
      <tbody>
          <tr>
              <td valign="top">&nbsp;</td>
              <td valign="top"><strong>Premium Storage 풀</strong></td>
              <td valign="top"><strong>울트라 SSD</strong></td>
          </tr>
          <tr>
              <td valign="top"><strong>디스크 수</strong></td>
              <td valign="top">10</td>
              <td valign="top">1</td>
          </tr>
          <tr>
              <td valign="top"><strong>읽기 전용 캐시</strong></td>
              <td valign="top">모든 디스크</td>
              <td valign="top">해당 없음</td>
          </tr>
          <tr>
              <td valign="top"><strong>읽기-쓰기 캐시</strong></td>
              <td valign="top">디스크 없음</td>
              <td valign="top">해당 없음</td>
          </tr>
          <tr>
              <td valign="top"><strong>데이터, 로그 및 임시 DB 파일</strong></td>
              <td valign="top">10 &ndash; 개 이상의 Storage 풀 P30 디스크</td>
              <td valign="top">단일 Ultra SSD 디스크</td>
          </tr>
          <tr>
              <td valign="top"><strong>평균 빨간색 대기 시간</strong></td>
              <td valign="top">1ms</td>
              <td valign="top">&lt;1ms</td>
          </tr>
          <tr>
              <td valign="top"><strong>평균 쓰기 대기 시간</strong></td>
              <td valign="top">4ms</td>
              <td valign="top">&lt;1ms</td>
          </tr>
          <tr>
              <td valign="top"><strong>초당 평균 전송</strong></td>
              <td valign="top">3ms</td>
              <td valign="top">&lt;1ms</td>
          </tr>
          <tr>
              <td valign="top"><strong>평균 전송 크기</strong></td>
              <td valign="top">9.5KB</td>
              <td valign="top">10.7KB</td>
          </tr>
          <tr>
              <td valign="top"><strong>초당 일괄 처리 요청 수</strong></td>
              <td valign="top">13.1K</td>
              <td valign="top">17.5K</td>
          </tr>
          <tr>
              <td valign="top"><strong>초당 비즈니스 트랜잭션 수</strong></td>
              <td valign="top">1,688</td>
              <td valign="top">1,980</td>
          </tr>
      </tbody>
  </table>


  <p>이 테스트에서 알 수 있듯이 일반적인 SQL Server 대기 시간 차이에 의해 구동되는 Premium Storage 비해 Ultra SSD에서 상당한 처리량을 얻습니다. Azure VM에서 <a href="https://azure.microsoft.com/en-us/services/sql-database/campaign">SQL Server 워크로드</a>에 가장 효과적인 스토리지 구성을 찾으려면 워크로드에 대한 충분한 스토리지 확장 제한으로 올바른 VM 크기를 선택하는 것부터 시작하는 것이 좋습니다. Temp DB를 로컬 SSD에 배치하면 스토리지에 대한 추가 비용 없이 최대 성능을 가져올 수 있습니다. 호스트 Blob 캐시가 있는 Premium 스토리지는 대기 시간이 짧은 캐시된 읽기를 제공합니다. 일시적이고 캐시된 IOPS 제한이 큰 VM이 있는 RO 캐시 지원 Premium Storage 풀에 데이터 파일을 배치하는 것은 대기 시간이 짧은 읽기 요구 사항이 있는 워크로드에 비용 효율적인 옵션입니다.</p>


  <p>Ultra SSD는 읽기 및 쓰기 대기 시간이 매우 짧은 뛰어난 스토리지 성능을 제공합니다. 데이터 및 로그 파일에 대한 대기 시간 및 처리량 요구 사항에 따라 Ultra SSD를 사용합니다. SQL Server 워크로드의 경우 특히 메모리 내 OLTP를 사용하는 경우 로그 쓰기 대기 시간이 중요합니다. Ultra SSD 디스크에 로그 파일을 배치하면 스토리지 대기 시간이 매우 짧은 높은 SQL Server 성능을 사용할 수 있습니다. Azure Virtual Machines는 Ultra SSD, Azure Premium Storage 메모리 및 스토리지 최적화 Virtual Machine 형식을 결합하여 SQL Server 워크로드에 엔터프라이즈급 성능을 제공합니다.</p>
