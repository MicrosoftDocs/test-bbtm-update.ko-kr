### YamlMime:Yaml
ms.openlocfilehash: 4d609b824e4b50117128b3c86109b231c2db294c
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905525"
Slug: hdinsight-metastore-migration-tool-open-source-release-now-available
Title: HDInsight Metastore 마이그레이션 도구 오픈 소스 릴리스 사용 가능
Summary: "Hive 메타스토어에 대량 편집을 적용하는 데 사용할 수 있는 오픈 소스 스크립트인 Microsoft Azure HDInsight Metastore 마이그레이션 도구(HMMT)의 릴리스를 공유하게 되어 기쁩니다. \n"
Content: >-
  <p>Hive 메타스토어에 대량 편집을 적용하는 데 사용할 수 있는 오픈 소스 스크립트인 Microsoft Azure HDInsight Metastore 마이그레이션 도구(HMMT)의 릴리스를 공유하게 되어 기쁩니다.</p>


  <p>HDInsight Metastore 마이그레이션 도구는 Azure HDInsight의 데이터 마이그레이션과 관련된 문제에 대한 대기 시간이 짧고 설치되지 않은 솔루션입니다. Hive 데이터 마이그레이션을 수행해야 하는 데는 여러 가지 이유가 있습니다. Azure Storage 계정에서 보안 전송을 사용하도록 설정하여 데이터를 보호해야 할 수 있습니다. HDInsight 3.6에서 4.0으로 업그레이드하는 과정의 일환으로 WasB에서 Azure Data Lake Storage(ADLS) Gen2로 Hive 테이블을 마이그레이션할 수 있습니다. 또는 응집력 있는 구조를 따르도록 데이터베이스, 테이블 및 UDF(사용자 정의 함수)의 위치를 구성하기로 결정했을 수 있습니다. HMMT를 사용하면 이러한 마이그레이션 시나리오 및 다른 많은 시나리오에서 더 이상 수동 개입이 필요하지 않습니다.</p>


  <p>HMMT는 빠르고 안전하며 제어 가능한 환경에서 Hive 메타데이터 마이그레이션 시나리오를 처리합니다. 이 블로그 게시물은 세 가지 섹션으로 나뉩니다. 먼저 HMMT에 대한 배경은 Hive 메타스토어 및 Hive 스토리지 패턴과 관련하여 설명되어 있습니다. 두 번째 섹션에서는 HMMT의 설계에 대해 설명하고 초기 설정 단계를 설명합니다. 마지막으로, 일부 샘플 마이그레이션은 HMMT를 사용하여 사용량과 가치를 보여주는 것으로 설명하고 해결합니다.</p>


  <h2>배경</h2>


  <h3>Hive 메타스토어</h3>


  <p>Hive metastore는 테이블, 데이터베이스 및 사용자 정의 함수 스토리지 위치와 같은 Hive 메타데이터에 대한 SQL 데이터베이스입니다. HIVe 메타스토어는 HDInsight 클러스터를 만들 때 자동으로 프로비전됩니다. 또는 기존 SQL 데이터베이스를 사용하여 여러 클러스터에서 메타데이터를 유지할 수 있습니다. 그런 다음 기존 SQL 데이터베이스를 외부 메타스토어라고 합니다. HMMT는 외부 메타스토어에 대해 시간이 지남에 따라 여러 클러스터에서 메타데이터 마이그레이션을 유지하는 데 사용됩니다.</p>


  <h3>Hive 스토리지 균일 리소스 식별자</h3>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2acd576b-a84b-4b6f-8820-464ad7d9a67a.png"><img alt="Hive storage URIs sample" border="0" height="152" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b6da71d8-780b-4f3c-83cc-ef90acc8c692.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="Hive 스토리지 URI 샘플" width="930"></a></p>


  <p>클러스터에서 사용할 수 있는 각 Hive 테이블, 데이터베이스 또는 UDF에 대해 Hive metastore는 외부 스토리지에 해당 아티팩&rsquo;트 위치의 레코드를 유지합니다. 아티팩트 위치는 Windows Azure Storage Blob 또는 Azure Data Lake Storage 유지됩니다. 각 위치는 아티팩트가 있는 계정 유형, 계정, 컨테이너 및 하위 컨테이너 경로를 설명하는 Azure Storage URI(Uniform Resource Identifier)로 표시됩니다. 위의 다이어그램에서는 Hive 테이블 URI를 나타내는 데 사용되는 스키마에 대해 설명합니다. 동일한 스키마 패턴이 Hive 데이터베이스 및 UDF에 적용됩니다.&nbsp;</p>


  <p>Hive 쿼리가 table1에 대해 실행되었다고 가정합니다. Hive는 먼저 Hive 메타스토어에 있는 해당 스토리지 항목에서 테이블 내용을 읽으려고 시도합니다. Hive는 테이블&rsquo; 스토리지 위치를 표시하고 업데이트하는 명령을 지원합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/b8f7a63e-05ce-4dd2-94d8-2061c68d0a3b.png"><img alt="Example command for displaying and updating a table’s storage location" border="0" height="55" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1fb5b2b4-2466-474c-b8b9-f581cdfc110d.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="테이블의 스토리지 위치를 표시하고 업데이트하기 위한 예제 명령" width="497"></a></p>


  <p>테이블의 스토리지 위치를 변경하려면 관심 테이블에 해당하는 <em>업데이트</em> 명령을 실행해야 합니다. 여러 테이블 위치를 변경하려면 여러 <em>업데이트</em> 명령을 실행해야 합니다. 스토리지 위치를 수동으로 업데이트해야 하므로 메타스토어에 대한 도매 변경은 오류가 발생하기 쉽고 시간이 많이 걸리는 작업일 수 있습니다. 테이블이 아닌 아티팩트 관련 위치 업데이트 스토리는 훨씬 덜 유리합니다. Hive 내에서 데이터베이스 또는 UDF의 위치를 변경할 수 없습니다. 따라서 HMMT를 대중에게 릴리스하는 동기는 Hive 아티팩트의 스토리지 위치를 업데이트하는 고통없는 방법을 제공하는 것입니다. HMMT는 Hive 아티팩트를 대규모로 변경하는 가장 빠르고 유일한 방법인 Hive 메타스토어를 직접 변경합니다.</p>


  <h2>HMMT 작동 방식</h2>


  <p>HMMT는 입력 매개 변수에 따라 Hive 메타스토어를 직접 업데이트하는 일련의 SQL 명령을 생성합니다. 입력 매개 변수와 일치하는 스토리지 URI만 스크립트의 영향을 받습니다. 이 도구는 Hive 스토리지 계정, 계정 유형, 컨테이너 및 하위 컨테이너 경로의 모든 조합을 변경할 수 있습니다. HMMT는 HDInsight 3.6 이상에서만 지원됩니다.</p>


  <p><a href="https://github.com/hdinsight/MetastoreMigrationTools" target="_blank">Microsoft HDInsight GitHub 페이지에서</a> 직접 다운로드하여 바로 HMMT 사용을 시작합니다. HMMT를 설치할 필요가 없습니다. Hive 메타스토어 SQL Server 허용 목록에 있는 IP 주소에서 스크립트 자체가 실행되는지 확인합니다. HMMT는 지원되는 쿼리 클라이언트 중 하나가 설치된 모든 UNIX 명령줄에서 실행할 수 있습니다. 스크립트가 반드시 HDInsight 클러스터 내에서 실행될 필요는 없습니다. 처음에 지원되는 클라이언트는 Beeline 및 SqlCmd입니다. Beeline이 지원되므로 HMMT는 모든 HDInsight 클러스터 헤드 노드에서 직접 실행할 수 있습니다.</p>


  <p><strong>면책 조항:</strong> HMMT는 Hive 메타스토어의 내용을 직접 변경하므로 주의해서 스크립트를 사용하는 것이 좋습니다. 스크립트를 실행할 때 메타스토어의 마이그레이션 후 콘텐츠는 실행의 잠재적 영향을 설명하기 위해 콘솔 출력으로 표시됩니다. 지정된 마이그레이션 매개 변수를 적용하려면 플래그 &ldquo;<strong>liverun</strong>&rdquo; 을 HMMT 명령에 전달해야 합니다. 이 도구는 기본적으로 드라이 런으로 시작됩니다. 또한 HMMT를 사용하지 않으려는 경우에도 Hive 메타스토어의 백업을 유지하는 것이 좋습니다. Hive 메타스토어 백업에 대한 자세한 내용은 이 블로그의 끝부분에 있습니다.</p>


  <h2>사용 예</h2>


  <p>HMMT는 Hive 메타데이터의 마이그레이션 및 조직과 관련된 다양한 사용 사례를 지원합니다. HMMT의 이점은 이 도구가 Hive 메타스토어가 데이터 마이그레이션 결과를 반영하도록 하는 쉬운 방법을 제공한다는 것입니다. 향후 데이터 마이그레이션을 예상하여 아티팩트 집합에 대해 HMMT를 실행할 수도 있습니다. 이 섹션에서는 두 가지 예제를 사용하여 HMMT의 사용량과 값을 보여 줍니다. 한 예제에서는 보안 스토리지 전송과 관련된 테이블 마이그레이션을 다루고 다른 예제에서는 Hive UDF JAR 메타데이터를 마이그레이션하는 프로세스를 설명합니다.</p>


  <h3>예제 1: 보안 전송 사용</h3>


  <p>Hive 테이블이 여러 스토리지 계정에 저장되어 있으며 최근에 이러한 계정 중 선택 항목에서 보안 전송을 사용하도록 설정했다고 가정해 보겠습니다. 보안 전송을 사용하도록 설정해도 Hive 메타스토어가 자동으로 업데이트되지 않으므로 변경 내용(예: <em>WASB에서 WASBS</em>로)을 반영하도록 스토리지 URI를 수정해야 <em><strong></strong></em>합니다. IP 허용 목록이 표시되고 지원되는 클라이언트가 설치되면 HMMT는 다음 명령을 사용하여 일치하는 모든 URI를 업데이트합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e88d7f8f-dd12-43ef-9121-f510450f73da.png"><img alt="Command for updating all matching URIs with HMMT" border="0" height="228" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3daf30b5-f69c-4f08-a788-df010710cadf.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="HMMT를 사용하여 일치하는 모든 URI를 업데이트하는 명령" width="258"></a></p>


  <ul>
   <li>스크립트에 전달된 처음 4개의 인수는 metastore에 액세스하는 데 사용되는 SQL 서버, 데이터베이스 및 자격 증명에 해당합니다.</li>
   <li>다음 네 인수는 검색할 &lsquo;원본&rsquo; 특성에 해당합니다. 이 경우 스크립트는 WASB 계정 Acc1, Acc2 및 Acc3에 영향을 줍니다. 컨테이너 또는 하위 컨테이너 경로에 대한 필터링은 없습니다. HMMT는 스토리지 마이그레이션 옵션으로 WASB, WASBS, ABFS, ABFSS 및 ADL을 지원합니다.</li>
   <li>대상 플래그는 변경할 Hive 메타스토어의 테이블을 나타냅니다. 테이블 SDS는 Hive 테이블 위치를 저장합니다. 다른 테이블 옵션으로는 Hive 데이터베이스용 DBS, Hive UDF용 FUNC_RU, Hive 테이블의 왜곡된 저장소에 대한 SKEWED_COL_VALUE_LOC_MAP 있습니다.</li>
   <li>쿼리 클라이언트 플래그는 사용할 쿼리 명령줄 도구에 해당합니다. 이 경우 선택한 클라이언트는 Apache Beeline입니다.</li>
  </ul>


  <p>나머지 플래그는 영향을 받는 URI의 &lsquo;대상&rsquo; 특성에 해당합니다. 이 경우 원본 옵션에서 지정한 일치하는 모든 URI에는 해당 계정 유형이 WASBS로 이동됩니다. 대상 플래그당 최대 하나의 항목이 허용됩니다. 이러한 플래그의 값은 마이그레이션 후 URI 패턴을 형성하기 위해 함께 병합됩니다.</p>


  <p>이 샘플 스크립트 명령은 계정 이름이 &ldquo;Acc1&rdquo;, &ldquo;Acc2&rdquo; 또는 &ldquo;Acc3인 WASB 계정에 해당하는 테이블 URI만 선택합니다.&rdquo; 컨테이너 및 경로 옵션은 와일드카드로 남아 있습니다. 즉, 이러한 세 계정 아래의 모든 테이블에 URI가 조정됩니다. 스크립트에서 조정한 것은 스토리지 유형을 WASBS로 설정하는 것입니다. 테이블 URI의 다른 측면은 영향을 받지 않습니다.</p>


  <h3>예제 2: UDF JAR 조직</h3>


  <p>이 예제에서는 시간이 지남에 따라 많은 UDF를 Hive에 로드했다고 가정합니다. UDF는 JAR 파일에서 구현되며 JAR이 도입된 클러스터에 따라 다양한 계정 컨테이너에 저장될 수 있습니다. 결과적으로 FUNC_RU 테이블에는 다양한 계정 컨테이너 및 경로에 많은 항목이 포함됩니다. UDF JAR의 <em>위치를 </em>정리하려면 다음 명령을 사용하여 이 작업을 수행할 수 있습니다. <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4c97f01c-2654-4403-83d7-b498fc3032ff.png"><img alt="Command to clean up the directory of UDF JARs" border="0" height="247" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7cbccd60-70d3-48c4-a39d-a4242165edf8.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="UDF JAR의 디렉터리를 정리하는 명령" width="320"></a></p>


  <p>이 명령은 컨테이너 및 하위 컨테이너 경로에 대한 WASB 스토리지 계정 &ldquo;Acc1&rdquo; 에서 FUNC_RU 테이블에만 있는 UDF JAR URI를 선택합니다. 스크립트가 완료되면 Hive metastore는 해당 계정의 모든 JAR을 컨테이너 &ldquo;jarstoragecontainer 아래의 /jarfiles/<em>디렉터리</em>에서 찾을 수 있음을 보여 줍니다.&quot;</p>


  <h2>피드백 및 기여</h2>


  <p>여러분의 의견을 환영합니다. 에서 기능 요청, 제안 및 문의 사항을 <a href="mailto:askhdinsight@microsoft.com">askhdinsight@microsoft.com</a>문의해 주세요. 또한 HDInsight GitHub 리포지토리를 통해 HMMT 자체에 대한 기능 요청 및 소스 코드 기여를 권장합니다.</p>


  <h3>기타 리소스</h3>


  <ul>
   <li><a href="https://github.com/hdinsight/MetastoreMigrationTools" target="_blank">HMMT GitHub 리포지토리</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-external-metadata-stores" target="_blank">Hive 외부 메타스토어</a></li>
   <li><a href="https://cwiki.apache.org/confluence/display/Hive/HiveServer2+Clients" target="_blank">Beeline 사용량</a></li>
   <li><a href="https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-2017" target="_blank">Microsoft SqlCmd</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure" target="_blank">Azure SQL Server 허용 목록</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/hdinsight/" target="_blank">Azure HDInsight</a></li>
   <li><a href="https://github.com/hdinsight" target="_blank">GitHub HDInsight</a></li>
   <li><a href="https://social.msdn.microsoft.com/forums/azure/en-us/home?forum=hdinsight" target="_blank">MSDN 포럼</a></li>
   <li><a href="https://stackoverflow.com/questions/tagged/hdinsight" target="_blank">스택 오버플로</a></li>
   <li><a href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-automated-backups" target="_blank">SQL Database 백업 단계</a></li>
   <li><a href="https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/hdinsight/hadoop/apache-hadoop-hive-java-udf.md" target="_blank">HIVE UDF 가이드</a></li>
  </ul>
