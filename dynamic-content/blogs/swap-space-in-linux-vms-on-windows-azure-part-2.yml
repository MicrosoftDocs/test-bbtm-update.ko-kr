### YamlMime:Yaml
ms.openlocfilehash: b00bc21fa06e4a45ed960def57e552bd29eb288f
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139900213"
Slug: swap-space-in-linux-vms-on-windows-azure-part-2
Title: Windows Azure에서 Linux VM의 SWAP 공간 – 2부
Summary: 이 문서는 Azure CAT 팀의 MSFT(Piyush Ranjan)에 의해 작성되었습니다.  이전 게시물에서 Azure 1부 Windows Linux VM&rsquo;의 SWAP 공간에서 Linux VM&rsquo;을 기본적으로 사용하는 방법을 설명했습니다.
Content: <p>이 문서는 Azure CAT 팀의 MSFT(Piyush Ranjan)에 의해 작성되었습니다.</p>  <p>이전 게시물에서 azure 1부 Windows Linux VM&rsquo;의 SWAP 공간에서는 기본적으로 갤러리 이미지에서 Azure IaaS에 프로비전된 Linux VM&rsquo;에 스왑 공간이 구성되지 않은 방법을 설명했습니다. 그런 다음 게시물은 리소스 디스크(/mnt/resource)에서 파일 기반 스왑 공간을 구성할 수 있는 간단한 단계 집합을 제공했습니다. 그러나 중요한 점은 설명&nbsp;된 단계는 이미 프로비전되어 실행 중인 VM에 대한 단계라는 것입니다. 이상적으로는 나중에 기다렸다가 여러 명령을 수동으로 실행하지 않고도 VM 프로비저닝 시간을 자동으로&nbsp; 적절하게 스왑 공간을 구성하려고 합니다.</p>  <p>VM 프로비전 시 스왑 공간 구성을 자동화하는 비결은 Windows Azure Linux 에이전트(waagent)를 사용하는 것입니다. 대부분의 사람들은 Linux VM에서 실행되는 에이전트가 있다는 것을 다소 모호하게 알고 있지만, 대부분의 사람들은 Azure Portal에 실제로 waagent에 대한 좋은 설명서가 있더라도 너무 모호하고 무시합니다.&nbsp; <a href="https://azure.microsoft.com/en-us/manage/linux/how-to-guides/linux-agent-guide/" target="_blank">Windows Azure Linux 에이전트 사용자 가이드</a>를 참조하세요. waagent의 세부 사항과 현재 작업에 사용할 수 있는 방법을 드릴다운하기 전에 언급해야 하는 다른 한 가지 사항이 있습니다. 즉, 사용자 고유의 사용자 지정된 Linux VM이 있고 나중에 Linux VM&rsquo;을 프로비전하기 위해 재사용 가능한 이미지로 내보내는 경우 이 방법이 잘 작동합니다. Azure 갤러리에서 Linux의 원시 기본 이미지를 사용할 때 waagent의 기능을 활용할 수 있는 방법은 없습니다. 가장 유용한 사용 사례 시나리오는 갤러리 이미지를&nbsp; 사용하여 프로비전된 VM으로 시작하고 원하는 항목에 맞게 사용자 지정되는 시나리오이기 때문에 실제로 제한되지 않습니다. 예를 들어 open-jdk <a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html" target="_blank">Java 대신 표준 Java</a> 를 사용하는 것을 좋아합니다. 또는 나중에 이미지를 사용할 수 있도록 VM에 Hadoop 이진 파일을 설치하는 것이 좋습니다. 다중 노드 클러스터에 대한 입니다. 이러한 시나리오에서는 프로비전 프로세스를 통해 자동으로 수행하려는 몇 가지 추가 작업을 수행하도록 waagent를 쉽게 구성할 수 있습니다.</p>  <p><a href="https://azure.microsoft.com/en-us/manage/linux/how-to-guides/linux-agent-guide/" target="_blank">Windows Azure Linux 에이전트</a> 사용자&rsquo; 가이드에서 설명한 대로 에이전트는 다음과 같은 많은 작업을 수행하도록 구성할 수 있습니다.</p>  <p>리소스 디스크 관리</p>  <p>리소스 디스크 포맷 및 탑재</p>  <p>스왑 공간 구성</p>  <p>waagent는 갤러리 이미지에서 프로비전된 VM에 이미 설치되어 있으며 구성이 다음과 같은 /etc/waagent.conf&rdquo;에 &ldquo;있는 구성 파일을 편집하기만 하면 됩니다.</p>  <p><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7242.swap21.png" alt="" width="500"></p>  <p>다음과 같이 설정하여 구성 파일에서 위에 표시된 두 줄을 변경하여 교환을 사용하도록 설정합니다.</p>  <p><strong>ResourceDisk.EnableSwap=y</strong> 설정</p>  <p><strong>ResourceDisk.SwapSizeMB=5120</strong> 설정</p>  <p>따라서 전체 프로세스는 다음과 같습니다.</p>  <p>갤러리의 이미지 중 하나를 사용하여 평소와 같이 IaaS에서 Linux VM을 프로비전합니다.</p>  <p>필요한 소프트웨어 구성 요소를 설치하거나 제거하여 원하는 대로 VM을 사용자 지정합니다.</p>  <p>&ldquo;위와 같이 /etc/waagent.conf&rdquo; 파일을 편집하여 스왑 관련 줄을 설정합니다. 스왑 파일의 크기를 조정합니다(위의 경우 5GB로 설정됨).</p>  <p><a href="https://azure.microsoft.com/en-us/manage/linux/how-to-guides/capture-an-image/" target="_blank">여기에</a> 설명된 지침을 사용하여 VM의 재사용 가능한 이미지를 캡처합니다.</p>  <p>방금 내보낸 이미지를 사용하여 새 Linux VM&rsquo;을 프로비전합니다. 이러한 VM&rsquo;은 스왑 공간을 자동으로 사용하도록 설정합니다.</p>  <p>Windows Azure Linux 에이전트의 주제에 대해 알아보지만 동일한 구성 파일 &ldquo;/etc/waagent.conf&rdquo;의 Role.StateConsumer 속성을 통해 사용자 지정 임의 스크립트를 실행하는 또 다른 흥미로운 기능을 &ndash; 제공합니다. 예를 들어 다음과 같이 do-cfg.sh&rdquo; 셸 스크립트&ldquo;를 만들 수 있습니다.</p>  <p><a href=""><img src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5355.Screen-Shot-2013_2D00_08_2D00_09-at-10.56.38-AM.png" alt="" width="500"></a></p>  <p>그런 다음 구성 파일에서 <strong>Role.StateConsumer=/home/scripts/do-cfg.sh</strong> 또는 스크립트 경로가 무엇이든 설정합니다. waagent는 VM을 프로비전할 때 준비&rdquo; 신호를 Azure 패브릭에 보내기 &ldquo;직전에 스크립트를 실행합니다. 위와 같이 스크립트 내에서 테스트할 수 있는 사용자 지정 스크립트에 Ready 명령줄 인수 &ldquo;&rdquo; 를 전달하여 일부 사용자 지정 초기화를 수행합니다. 마찬가지로 waagent는 VM 종료 시 동일한 스크립트를 실행하고 테스트할 수 있는 스크립트에 명령줄 인수 &ldquo;Shutdown&rdquo; 을 전달하며 일부 사용자 지정 정리 작업은 VM에서 실행할 수 있습니다.</p>
