### YamlMime:Yaml
ms.openlocfilehash: 0699adf3189cdfb3f739f7720a5561d27e5b9a84
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139898235"
Slug: using-vnet-or-hybrid-conn-with-websites
Title: Azure Websites와 VNET 통합 및 하이브리드 연결 사용
Summary: 이 자습서에서는 VNET 통합 또는 하이브리드 연결을 사용하여 Azure VM 또는 온-프레미스에서 MySQL과 WordPress를 설치합니다.
Content: >-
  다음은 원격 MySQL 데이터베이스를 사용하여 Azure Websites에서 WordPress를 실행하는 예제를 간략하게 설명하고 두 부분으로 설명합니다.첫 번째 부분에서 데이터베이스는 Azure VM 및 Azure VNET에서 호스트됩니다.이 예제에서는 VNET 통합과 하이브리드 연결을 사용하여 Azure VNET에 안전하게 연결합니다.이는 VM이 이미 프로비전된 기존 VNET을 가정합니다.


  두 번째 부분에서는 사이트-사이트 VPN 및 VNET 통합의 조합을 통해 액세스할 수 있는 온-프레미스 호스트에서 데이터베이스를 호스팅하는 방법을 다룹니다.기존 VNET과 동일한 VNET을 사용합니다.하이브리드 연결이 온-프레미스와 VNET에서 작동하도록 하는 데 차이가 없으므로 하이브리드 연결을 표시할 필요가 없습니다.


  두 연결 기능은 모두 현재 미리 보기로 제공됩니다.즉, 대부분 그들은 계속 개선 하 고 더 나은 사용 하 여 만들 것입니다 의미.인터넷에서 애플리케이션 엔드포인트에 액세스할 수 있도록 하는 데 아무런 문제가 없는 경우 사용할 수 있는 또 다른 옵션이며 이를 사용하기 위한 추가 기능이 필요하지 않습니다.

  <h2>MySQL 데이터베이스 만들기</h2>

  WordPress를 설정하기 전에 통신할 데이터베이스가 필요합니다.이는 데모용이므로 가장 쉬운 애플리케이션 경로로 이동합니다.그렇다고 해서 실제로 MySQL 데이터베이스를 실행하는 방법은 아닙니다.여기서는 주로 원격 데이터베이스를 사용하여 웹 사이트를 설정하는 데 중점을  두고 있습니다.프로비전된 VM은 Windows Server 2012 R2가 설치된 2코어 3.5GB VM입니다.


  VM 및 VNET을 처음으로 만드는 경우 VM을 만들기 전에 먼저 VNET을 만들어야 합니다.VM 생성 프로세스 중에 VNET을 지정해야 하며 VNET을 만든 후에는 변경할 수 없습니다.더 나아가기 전에 Azure Virtual Network에 대한 더 많은 접지가 필요한 경우 다음 정보로 시작합니다. <a title="https://azure.microsoft.com/en-us/documentation/services/virtual-network/" href="https://azure.microsoft.com/en-us/documentation/services/virtual-network/">https://azure.microsoft.com/en-us/documentation/services/virtual-network/</a>


  원격 데스크톱을 사용하여 VM에 로그온합니다.원격 데스크 위쪽 rdp 파일을 풀다운하려면 표시된 대로 새 포털 또는 이전 포털을 사용합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image001.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image001" alt="clip_image001" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image001_thumb.png" width="610" height="376" border="0" /></a>


  VM에서 MySQL 설치 관리자 <a href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a> 를 끌어와서 실행했습니다.


  설치 관리자는 잘 작동하며 사용된 포트에 대한 방화벽을 사용하지 않도록 설정했습니다.WordPress에 액세스하려면 데이터베이스와 계정이 필요합니다.이렇게 하려면 C:\Program Files\MySQL\MySQL Server 5.6\bin\ 디렉터리에서 명령 셸을 열기만 하면 됩니다.


  여기에서 다음을 사용하여 mysql에 로그인합니다.

  <pre class="prettyprint">mysql –u root –p&lt;password&gt;</pre>

  내 경우에는 다음과 같습니다.

  <pre class="prettyprint">mysql –u root –pvpndemo</pre>

  데모 목적으로 작업을 쉽게 만들기 위해 루트를 사용하지만 관심있는 시스템에서는 그렇게해서는 안됩니다. 다음 명령을 사용하여 데이터베이스를 만듭니다.

  <pre class="prettyprint">CREATE DATABASE &lt;database name&gt;;</pre>

  내 명령을 만드는 데이터베이스에 대해 이름 하이브리드를 사용했습니다.

  <pre class="prettyprint">CREATE DATABASE hybrid;</pre>

  다음 명령을 사용하여 데이터베이스를 사용할 수 있는 권한을 계정에 부여합니다.

  <pre class="prettyprint">GRANT ALL PRIVILEGES ON *.* TO ’root’@’%’ IDENTIFIED BY ’vpndemo’ WITH GRANT OPTION; FLUSH PRIVILEGES;</pre>

  이제 mysql 셸을 종료할 수 있습니다.데이터베이스가 설정되었습니다.원격 데스크톱 세션을 종료하기 전에 VM에 대한 IP를 아직 모르는 경우 가져옵니다.셸 프롬프트에서 ipconfig를 사용하는 것을 좋아합니다.내 IP는 10.0.1.4이며 인터넷 라우팅 가능 IP 주소가 아닙니다.

  <h2>WordPress 설치</h2>

  갤러리에서 WordPress를 사용하는 대신 처음부터 모든 것을 할 것이라고 생각했습니다.시작하려면 여기에서 WordPress를 아래로 당겼습니다 : <a href="https://wordpress.org/latest.zip">https://wordpress.org/latest.zip</a>   이것은 4.0 일 수있는 최신 버전의 WordPress의 zip입니다.


  다음으로 Azure Websites에서 빈 웹 사이트를 만들었습니다.새 Azure Preview 포털에서 <a href="https://portal.azure.com">https://portal.azure.com</a> 왼쪽 아래에 있는 새 아이콘을 사용하여 웹 사이트 만들기 UI를 표시했습니다.이 경우 thirdVPNdemoSite라는 사이트를 만들었습니다.


  웹 사이트를 만들기 전에 모든 것을 원하는 지역에 대해 생각해야 합니다.이 문서에서 수행하는 작업과 같은 작업을 수행하려면 웹 사이트, VNET 및 VM이 모두 동일한 지역에 있어야 합니다.한 지역의 웹 사이트가 다른 지역의 VNET에 연결되도록 할 수 있지만 다른 지역의 경우 성능상의 이유로 방지해야 합니다.


  WordPress를 업로드하고 조작하기 위해 매우 간단하게 만드는 Kudu 콘솔을 사용했습니다.웹 사이트로 이동하고 URL을 편집하여 .scm을 추가하여 웹 사이트 scm 페이지를 엽니다. 사이트 이름 뒤의 이름입니다.내 웹 사이트가 thirdVPNdemoSite.azurewebsites.net scm 사이트가 thirdVPNdemoSite.scm.azurewebsites.net.디버그 콘솔로 이동하여 CMD 또는 Powershell을 선택합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image002.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002" alt="clip_image002" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image002_thumb.png" width="610" height="588" border="0" /></a> D:\home\site\wwwroot로 이동합니다.이것이 바로 WordPress가 이동하는 위치입니다.이렇게 하려면 셸 명령 또는 탐색기를 사용하는 것이 좋습니다.WordPress를 복사하려면 zip 파일을 잡고 Kudu 콘솔의 탐색기 보기로 끌어옵니다."업로드하고 압축을 풀려면 여기로 끌어다"라는 상자가 표시됩니다.zip을 그곳으로 끌어다 옵니다.이 후에는 wwwroot 디렉터리에 WordPress 디렉터리가 있습니다.응용 프로그램 사양 없이 내 WordPress 사이트가 내 URL의 기본에 있기를 원했습니다.이렇게 하려면 WordPress 디렉터리에 있던 내용의 내용을 한 수준 위로 이동해야 했습니다.WordPress 디렉터리로 이동하여 작업을 수행하면 이 작업이 충분히 쉽습니다.

  <pre class="prettyprint">move * ..</pre>

  다음으로 데이터베이스에서 작동하도록 WordPress를 구성해야 합니다.wwwroot 디렉터리에 있는 동안 wp-config-sample.php 파일을 wp-config.php에 복사한 다음 편집합니다.파일에는 데이터베이스에 액세스하는 정보가 포함되어 있습니다.파일을 편집하려면 Kudu 탐색기 UI에서 편집 펜을 누릅니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image0025.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[5]" alt="clip_image002[5]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image0025_thumb.png" width="527" height="610" border="0" /></a>


  데이터베이스 이름, 사용자 이름, 암호 및 호스트 이름을 포함하여 그림에 설명된 대로 항목을 변경합니다.아직 수행되지 않은 부분은 웹 사이트와 VNET 간의 연결을 설정하는 것입니다.이 작업을 수행하기 전에 실패 사례를 증명하는 것이 합리적입니다.웹 사이트로 이동하려고 하면 WordPress가 내 데이터베이스에 액세스할 수 없으므로 예상되는 실패 메시지가 표시됩니다.

  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/Capture2a.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="Capture2a" alt="Capture2a" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/Capture2a_thumb.png" width="610" height="58" border="0" /></a> 내 경우에는 위의 메시지를 제공하는 Chrome을 사용하고 있었습니다.다른 브라우저에는 다른 환경이 있습니다.IE는 "웹 사이트에서 페이지를 표시할 수 없습니다"라고 말합니다.

  <h2>VNET 통합 설정</h2>

  웹 사이트에서 데이터베이스에 대한 연결을 사용하도록 설정하려면 먼저 VNET 통합을 사용한 다음, VNET 통합을 중단하고 하이브리드 연결이 동일한 데이터베이스에 도착하는 방법을 보여 줍니다.VNET을 사용하도록 설정하려면 웹 사이트의 미리 보기 포털 보기로 돌아가서 아래로 이동하여 현재 VNET 설정을 확인합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image0027.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[7]" alt="clip_image002[7]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image0027_thumb.png" width="610" height="583" border="0" /></a>


  웹 사이트를 표준 가격 책정 계층에 배치하지 않은 경우 첫 번째 단계입니다.표준보다 낮은 가격 책정 계층에 있는 경우 더 많은 요금이 청구됩니다.아직 표준 플랜에 없는 경우 Virtual Network UI를 클릭하면 변경할 수 있는 가격 책정 계층 화면이 표시됩니다.다음 단계는 웹 사이트에 가상 네트워크를 추가하는 것입니다.Virtual Network UI를 다시 클릭하면 웹 사이트를 통합할 VNET을 선택할 수 있습니다.


  VNET을 선택할 수 없는 경우 다음 항목 중 하나 또는 둘 다에 해당하는 경우에만 사용할 수 있습니다.VNET에 동적 라우팅 게이트웨이가 없거나 지점 및 사이트 간의 활성화가 없습니다.

  VNET에 지점 및 사이트 연결이 활성화되지 않은 경우 현재 포털에서 Virtual Network로 이동하여 설정해야 합니다.이 문서의 두 번째 섹션을 사용하여 사이트 간 VPN 연결을 사용하려는 경우 지점 및 사이트 간 연결에 사용하는 IP 범위가 온-프레미스 IP 범위와 충돌하지 않는지 확인합니다.내 경우에는 온-프레미스에서 192.168.0.0을 사용하므로 여기에서 10.0.0.0 IP 주소를 사용합니다.

  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image002.jpg"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002" alt="clip_image002" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image002_thumb.jpg" width="610" height="508" border="0" /></a>


  게이트웨이를 설정하지 않은 경우 게이트웨이도 추가해야 합니다.게이트웨이가 있고 지점 및 사이트 간의 사용을 설정할 수 없는 경우 게이트웨이가 정적 라우팅 게이트웨이이기 때문입니다.대신 동적 라우팅 게이트웨이가 필요합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image0029.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[9]" alt="clip_image002[9]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image0029_thumb.png" width="610" height="518" border="0" /></a>


  이제 모든 항목이 설정되었으므로 이전 버전이 아닌 경우 계속 진행하여 웹 사이트와 통합할 VNET을 선택합니다.웹 사이트와 VNET 통합을 사용하도록 설정하면 웹 사이트 시스템은 인증서를 교환하여 웹 사이트와 VNET 간의 모든 통신이 안전한지 확인합니다.녹색 검사는 사이트가 연결되어 있다는 것을 의미하지 않습니다.즉, 인증서가 동기화되어 있습니다.  Virtual Network 인증서 탭에서 VNET에 대해 설정된 웹 사이트에 대한 인증서를 볼 수 있습니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/23/Capture5.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="Capture5" alt="Capture5" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/Capture5_thumb.png" width="480" height="181" border="0" /></a>


  DNS 추가 또는 사이트 대 사이트 VPN 추가를 포함하여 인증서를 다시 동기화해야 하는 몇 가지 사항이 있습니다.인증서를 다시 동기화해야 하는 경우 가상 네트워크를 클릭하고 페이지 맨 위에 있는 연결 동기화 작업을 누르기만 하면 됩니다.

  이제 웹 사이트에 도달하면 데이터베이스로 이동합니다.표시되는 화면은 WordPress를 처음 설정할 때 표시되는 언어 선택 화면입니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image0017.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image001[7]" alt="clip_image001[7]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image0017_thumb.png" width="366" height="480" border="0" /></a>


  성공!


  이제 하이브리드 연결을 사용하여 프로세스를 반복합니다.먼저 VNET 통합을 중단해야 합니다.사이트 구성으로 이동하여 가상 네트워크 UI 및 연결 끊기로 이동합니다.지금 웹 사이트로 이동하면 이전에 본 것과 동일한 데이터베이스를 사용할 수 없는 UI가 표시됩니다.


  &nbsp;

  <h2>하이브리드 연결 설정</h2>

  VNET 통합을 사용하면 VNET 또는 VNET을 통해 많은 리소스에 액세스할 수 있지만 하이브리드 연결은 엔드포인트당 단일 애플리케이션에만 액세스할 수 있지만 VNET에 있는 애플리케이션에만 액세스할 수 있습니다.필요한 경우 각각 별도의 네트워크에 있는 애플리케이션에 액세스할 수 있습니다.웹 사이트는 하나의 VNET과만 통합할 수 있지만 많은 하이브리드 연결 엔드포인트와 통합할 수 있습니다.BizTalk 서비스에서 다루는 엔드포인트의 수량으로 제한됩니다.


  하이브리드 연결을 사용하도록 설정하려면 Virtual Network UI 옆에 있는 웹 사이트 하이브리드 연결 UI로 이동하여 엔드포인트에 대한 새 연결을 만듭니다.아직 없는 경우 BizTalk 서비스 계정을 만들어야 합니다.이 UI에서 지금은 무료 BizTalk 계정만 만들 수 있습니다.이렇게 하면 여러 웹 사이트에서 사용할 수 있는 엔드포인트를 최대 5개까지 사용할 수 있습니다.추가 엔드포인트의 경우 현재 포털을 사용하여 Biztalk 서비스 계획을 조정합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00211.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[11]" alt="clip_image002[11]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00211_thumb.png" width="554" height="610" border="0" /></a>


  하이브리드 연결을 만든 후에도 연결되지 않은 것으로 표시됩니다.VNET 통합 기능은 지점 및 사이트 간의 기술을 사용하여 통합을 만듭니다.하이브리드 연결 솔루션은 내부적으로 포트 브리지라고 불렸던 것과 유사한 기능을 사용합니다.그 중 일부는 이 하이브리드 솔루션을 가능하게 하기 위해 활용되기도 했습니다.작동 방식은 웹 사이트가 릴레이 서버에 연결하는 것입니다.엔드포인트 및 Azure에 대한 액세스 권한이 있는 어딘가에 배치된 에이전트도 설치됩니다.둘 다 릴레이 서버에 연결한 다음 연결을 통해 단일 엔드포인트에 터널을 만듭니다.엔드포인트에 대한 host:port를 지정할 때 릴레이 에이전트가 설치되는 호스트에서 확인되는 호스트 이름을 사용할 수 있습니다.그러면 웹 사이트에서 동일한 호스트 이름을 사용하여 애플리케이션 엔드포인트에 액세스할 수 있습니다.이렇게 하면 지정된 웹 사이트를 온-프레미스에서 Azure Websites로 리프트 앤 시프트하는 것이 훨씬 쉬워지며 온-프레미스에서 수행했던 것과 동일한 연결 문자열을 계속 사용할 수 있습니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/23/Capture10.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="Capture10" alt="Capture10" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/Capture10_thumb.png" width="480" height="198" border="0" /></a>


  연결을 완료하려면 하이브리드 연결 에이전트를 설치해야 합니다.이 다음 부분은 애플리케이션을 호스트하는 VM 또는 데이터베이스에 액세스할 수 있는 VNET의 다른 VM에서 수행해야 합니다.내 경우에는 데이터베이스를 호스팅하는 VM과 동일한 VM을 사용했습니다.IE 브라우저를 열고 Azure 미리 보기 포털에 로그인합니다.웹 사이트로 이동한 다음 하이브리드 연결 UI로 이동합니다.하이브리드 연결 UI에서 연결을 클릭합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image0019.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image001[9]" alt="clip_image001[9]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image0019_thumb.png" width="480" height="250" border="0" /></a>


  나는 IE를 사용한다고 말했지만 그 이유는 다음 단계가 IE에서 잘 작동하지만 Firefox 또는 Chrome에서는 잘 작동하지 않기 때문입니다.수신기 설치 프로그램을 클릭하여 에이전트 설치 관리자에 액세스합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00111.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image001[11]" alt="clip_image001[11]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00111_thumb.png" width="265" height="360" border="0" /></a>


  에이전트를 설치하려면 설치를 클릭하고 지금 구성하기만 하면 됩니다.설치 관리자가 항목을 몇 번 클릭하면 에이전트를 설치하는 데만 필요합니다.에이전트를 설치한 후 에이전트는 Azure Relay 서버에 연결하고 엔드포인트에 대한 연결을 엽니다.VNET과 달리 UI에서 연결 상태를 볼 수 있지만 이는 엔드포인트에 연결할 수 있는 것이 아니라 웹 사이트가 에이전트에 연결되어 있다는 것을 말합니다.중복성을 위해 여러 에이전트를 원하거나 필요로 하는 경우 원하는 위치에 여러 인스턴스를 설치할 수 있습니다.여러 에이전트 인스턴스는 엔드포인트 수에 대해 계산되지 않습니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00113.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image001[13]" alt="clip_image001[13]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00113_thumb.png" width="480" height="199" border="0" /></a>


  이제 웹 사이트로 이동하면 VNET을 연결한 후 본 것과 동일한 WordPress 언어 선택 UI를 볼 수 있습니다. 다음 섹션으로 이동하기 전에 하이브리드 연결 UI로 이동하여 웹 사이트에서 엔드포인트를 등록 취소합니다.삭제를 사용하지 않는 한 엔드포인트는 삭제되지 않지만 웹 사이트에서 연결이 끊어집니다.웹 사이트로 이동하려고 하면 익숙한 오류 화면이 다시 표시됩니다.


  이렇게 하면 VNET에서 리소스에 안전하게 액세스하는 방법을 설명하는 첫 번째 섹션이 종료됩니다.하이브리드 연결 설명은 모든 네트워크에서 적용할 수 있습니다.온-프레미스 액세스를 위해 특별한 프로비저닝을 수행할 필요가 없습니다.VNET 통합의 경우 스토리는 다릅니다.VNET을 통해 온-프레미스 리소스에 액세스하려면 사이트-사이트 VPN에 대해 설정해야 합니다.


  &nbsp;

  <h2>온-프레미스 데이터베이스 - 사이트 및 사이트 VPN</h2>

  기존 VNET에 대한 사이트-사이트 VPN을 설정하려면 로컬 네트워크를 추가하고 VNET에 연결해야 합니다.이 용도로 사용할 수 있는 인터넷 주소 지정 가능 게이트웨이 서버가 있다고 가정합니다.인터넷 주소 지정 가능 게이트웨이가 없는 경우 앞에서 설명한 대로 하이브리드 연결을 사용하기만 하면 더 쉬운 시간을 가질 수 있습니다.


  인터넷 주소 지정 가능 게이트웨이가 있다고 가정하면 첫 번째 단계는 로컬 네트워크를 만드는 것입니다.이렇게 하려면 현재 포털로 이동하여 왼쪽 아래에 있는 새 아이콘을 누릅니다.Network Services - Virtual Network -&gt;&gt; 로컬 네트워크 추가로 이동합니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00213.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[13]" alt="clip_image002[13]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00213_thumb.png" width="614" height="262" border="0" /></a>


  온-프레미스 네트워크의 이름, VPN 디바이스 IP 주소 및 IP 범위를 지정합니다.이제 로컬 네트워크가 있으므로 VNET에 연결하기만 하면 됩니다.VNET의 구성 탭으로 이동합니다.사이트 간 연결 UI가 표시되기 전에 하나 이상의 로컬 네트워크가 있어야 합니다.확인란을 눌러 로컬 네트워크에 연결하고 사용하려는 로컬 네트워크를 선택하기만 하면 됩니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00215.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[15]" alt="clip_image002[15]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00215_thumb.png" width="610" height="265" border="0" /></a>


  이제 대시보드에 로컬 네트워크가 표시되지만 연결이 끊어집니다. 다음 단계는 온-프레미스 게이트웨이 서버에서 수행해야 합니다.현재 Azure Portal의 네트워크 대시보드에서 화면 오른쪽에 있는 VPN 디바이스 스크립트 다운로드를 클릭합니다.그러면 아래와 같은 화면이 나타납니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/image.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="이미지" alt="image" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/image_thumb.png" width="480" height="393" border="0" /></a>


  Windows Server 2012 R2에서 RRAS를 사용하고 있으므로 해당 항목을 선택하고 VPNDeviceScript.cfg 파일을 다운로드하도록 확인했습니다.이 파일은 게이트웨이 서버에서 실행해야 하는 PowerShell 스크립트입니다.네트워크 대시보드를 실행하면 설정된 연결이 표시됩니다.이 업데이트는 몇 분 정도 걸리므로 변경 후 UI가 즉시 응답하지 않으면 놀라지 마세요.


  &nbsp;


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00217.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[17]" alt="clip_image002[17]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00217_thumb.png" width="610" height="519" border="0" /></a>


  이제 모든 항목이 설정된 것처럼 보이지만 네트워크 구성의 일부로 남아 있는 마지막 항목이 하나 있습니다.현재 사이트-사이트 VPN 사용은 VNET의 지점 및 사이트 연결에 대한 경로를 설정하지 않습니다.다음 단계가 없으면 웹 사이트에서 온-프레미스 시스템으로 요청을 보낼 수 있지만 응답을 받을 수 없습니다.

  다행히 이것은 쉽게 해결할 수 있습니다.웹 사이트에서 사용 중인 지점 및 사이트 연결로 트래픽을 다시 반환하려면 온-프레미스 경로를 추가하기만 하면 됩니다.RRAS에서 표시된 것처럼 정적 경로를 추가했습니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00220.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[20]" alt="clip_image002[20]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00220_thumb.png" width="610" height="237" border="0" /></a>


  지점 및 사이트간 IP 범위를 기억하지 못하는 경우 Azure Portal의 Virtual Network 공간으로 이동하여 구성 탭을 입력합니다.  웹 사이트에서 지점 및 사이트 간의 블록에서 사용할 IP를 알 수 있는 방법은 없으므로 전체 블록에 대한 경로를 설정해야 합니다.


  이제 웹 사이트에서 온-프레미스 네트워크의 리소스에 액세스할 수 있습니다.데모를 완료하려면 네트워크에서 호스트를 선택하고 이 문서의 시작 부분과 마찬가지로 MySQL을 설치합니다.데이터베이스를 만들고 계정에 대한 액세스 권한을 부여하는 것을 잊지 마세요.


  kudu 콘솔로 이동하여 wp-config.php 파일을 편집합니다.새 데이터베이스를 사용하여 변경한 호스트 이름 및 기타 항목을 업데이트합니다.간단히 하기 위해 Azure VM에서 했던 것처럼 모든 항목을 설정하기만 하면 호스트 이름이 다릅니다.


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2014/10/22/clip_image00222.png"><img style="padding-top: 0px;padding-left: 0px;padding-right: 0px;border: 0px" title="clip_image002[22]" alt="clip_image002[22]" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/clip_image00222_thumb.png" width="610" height="608" border="0" /></a>


  알려진 상태에 있음을 표시하려면 웹 사이트를 누릅니다.데이터베이스 연결 UI를 설정하는 동안 오류가 다시 표시됩니다. 이제 미리 보기 포털로 이동하여 웹 사이트를 VNET과 다시 한 번 통합합니다.언어 선택 화면이 다시 표시됩니다.이번에는 VNET 통합을 통해 온-프레미스 데이터베이스를 사용합니다.


  &nbsp;

  <h2>문제 해결 및 기타 정보</h2>

  원하는 엔드포인트에 액세스하는 데 문제가 발생하는 경우 연결을 테스트하는 데 사용할 수 있는 몇 가지 유틸리티가 있습니다.도구 ping, nslookup 및 tracert는 보안 제약 조건으로 인해 Kudu 콘솔을 통해 작동하지 않습니다.빈 공간을 채우기 위해 문제를 디버그하는 데 도움이 되는 두 개의 별도 도구가 추가되었습니다.DNS 기능을 테스트하기 위해 nameresolver.exe이라는 도구가 추가되었습니다.구문은 다음과 같습니다.

  <pre class="prettyprint">nameresolver.exe hostname [optional: DNS Server]</pre>

  연결을 증명하기 위해 tcpping.exe이라는 TCP ping을 수행하는 도구도 추가했습니다.이 도구의 구문은 다음과 같습니다.

  <pre class="prettyprint">tcpping.exe hostname [optional: port]</pre>

  TCP ping 유틸리티의 좋은 점과 단점은 특정 호스트 및 포트를 타격한다는 것입니다.이러한 도구는 애플리케이션에 연결할 수 있는지 알려주는 데 좋지만 일반적인 의미에서 호스트에 연결할 수 있는지 간단히 알려주는 것은 아닙니다.적중하려는 포트에서 수신 대기하고 있는지 확실하지 않은 경우 netstat –a를 사용하여 수신 대기 중이라고 생각했던 곳에서 수신 대기하는 애플리케이션이 있는지 확인합니다.


  지금까지 본 가장 일반적인 문제는 방화벽이었습니다.애플리케이션 포트에 연결할 수 없는지 가장 먼저 확인해야 하는 것 중 하나는 방화벽 구성입니다.MySQL 설치의 경우 MySQL 설치 관리자는 수신 대기 포트 3306을 자동으로 엽니다.그럼에도 불구하고 문제가 있는지 확인하는 것이 가장 먼저입니다.


  또 다른 디버그 지점은 웹 사이트와 VNET이 동일한 정보 집합으로 작동하는지 확인하는 것입니다.인증서 외에도 인증서를 동기화할 때 웹 사이트와 VNET 간에 교환되는 몇 가지 필수 정보가 있습니다.VNET에서 항목을 변경했지만 최신 정보로 웹 사이트를 업데이트하지 않았을 수 있습니다.문제 해결 단계 중 하나로 연결을 다시 동기화합니다.이것이 자동이 아닌 한 가지 이유는 고객이 인증서를 삭제하여 VNET 액세스를 쉽게 사용하지 않도록 설정할 수 있기 때문입니다.

  <h2>제한 사항</h2>

  이러한 통합을 통해 다양한 유형의 용도를 사용할 수 있지만 여전히 몇 가지 제한 사항이 있습니다.현재 이러한 하이브리드 액세스 기술을 사용하여 다음을 수행할 수 없습니다.

  <ul>
   <li>Active Directory와 웹 사이트 통합</li>
   <li>LDAP와 웹 사이트 통합</li>
   <li>드라이브 탑재</li>
  </ul>

  VNET 통합 또는 하이브리드 연결의 수량에 대한 제한 사항도 있습니다.

  <ul>
   <li>표준 가격 책정 계층 웹 호스팅 계획당 최대 5개의 VNET 통합을 사용할 수 있습니다.이러한 5개의 통합은 해당 계획의 여러 사이트에서 사용할 수 있습니다.</li>
   <li>무료 BizTalk 서비스를 사용하여 최대 5개의 하이브리드 연결 엔드포인트를 가질 수 있습니다.이러한 5개의 엔드포인트는 모든 웹 사이트에서 사용할 수 있으며 사용은 웹 호스팅 계획이 아니라 구독에만 국한되지 않습니다.</li>
  </ul>

  하이브리드 연결과 VNET 통합은 모두 미리 보기로 제공되며 GA 이전 또는 그 이전에 개선될 예정이지만 이미 많은 것을 제공합니다.
