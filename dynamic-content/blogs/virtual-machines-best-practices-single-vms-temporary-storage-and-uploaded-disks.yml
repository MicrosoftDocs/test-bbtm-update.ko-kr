### YamlMime:Yaml
ms.openlocfilehash: b78cd3cc3e7d071de95bb0262b0570c38e95fa52
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139907469"
Slug: virtual-machines-best-practices-single-vms-temporary-storage-and-uploaded-disks
Title: 'Virtual Machines 모범 사례: 단일 VM, 임시 Storage 및 업로드된 디스크'
Summary: >-
  안녕하세요 모두,


  저는 Virtual Machines 기능을 작업하는 Microsoft Azure 팀의 Drew McDaniel이며 처음부터 작업해 왔습니다.


  이 블로그 게시물에서, 나는 몇 가지 최고의 공유 할 것이다 ...
Content: >-
  <p>안녕하세요 모두, 나는 Virtual Machines 기능에서 작업하는 Microsoft Azure 팀에서 드류 맥다니엘이며 처음부터 그것을 작업하고있다. 이 블로그 게시물에서는 Azure Virtual Machines를 최대한 활용할 수 있도록 몇 가지 모범 사례 지침을 공유합니다. 이러한 지침은 고객 피드백에서 바로 나와서 발생한 가장 일반적인 문제 중 일부를 다룹니다.</p>


  <h4>가용성 집합에서 단일 VM 구성 방지</h4>


  <p>가상 머신이 Azure에 배포될 때 가용성 집합을<em>None&rsquo;으로 구성하도록 사용 불가 설정기의 일부로 구성할&lsquo;</em>&nbsp; 수 있습니다.<a href="https://azure.microsoft.com/en-us/documentation/articles/manage-availability-virtual-machines/"><em></em></a>&nbsp; 모든 사용자가 VM을 고가용성으로 사용 가능하게 하기를 원하기 때문에 <em>TheNoneoption&rsquo;은&lsquo; 약간 오해</em>의 소지가 있을 수 있습니다.&nbsp;&nbsp; 그러나 동일한 기능을 제공하기 위해 2개 이상의 가상 머신이 배포된 경우에만 가용성 집합을 선택하는 것이 좋습니다. 배포하는 VM이 동일한 기능을 제공하는 VM 집합(즉, 2개 이상)에 속하지 않는 경우(예: 공통 부하 분산 장치 아래의 여러 웹 서버 또는 데이터를 복제하는 두 SQL 서버) 배포하는 VM이 동일한 기능을 제공하는 VM 집합의 일부가 아닌 경우 없음&rsquo;을 선택&lsquo;해야 합니다. <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/6712.drew1.png"><img alt="" border="0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/6712.drew1.png"></a>&ldquo;가용성 집합에 단일 VM을 배포하는 것이 나쁜 이유는 무엇인가요?&rdquo; 간단히 말해서 가용성 집합&nbsp; 내에 단일 VM 인스턴스를 배포하는 경우 고급 경고 또는 플랫폼 유지 관리 알림이 수신되지 않습니다. 이 구성에서 단일 VM 인스턴스는 플랫폼 유지 관리가 발생할 때 고급 경고 없이 다시 부팅될 수 있습니다. 단일 VM 인스턴스를 배포하고 가용성 집합 옵션을 None&rsquo;으로 &lsquo;설정하면 플랫폼 유지 관리 작업을 위해 VM을 다시 부팅하기 전에 알림을 받게 되며, 시기와 이유를 이해하지 못하고 단일 VM 인스턴스가 다시 부팅되지 않도록 합니다. 백그라운드에서 VM이 가용성 집합에 배포될 때 Azure 플랫폼은 가용성 집합에 있는 VM의 하위 집합만 플랫폼 유지 관리를 위해 한 번에 중단되도록 합니다. 따라서 가용성 집합에 여러 VM이 있는 경우 항상 해당 VM의 일부 이상이 실행됩니다. 단일 VM 인스턴스가 가용성 집합의 일부가 아닌 경우 이 컴퓨터가 고가용성 집합의 일부가 아니므로 플랫폼 유지 관리 작업을 위해 VM을 다시 부팅하기 전에 이메일을 통해 알려주는 특별한 프로세스가 준비되었음을 Azure 플랫폼에 알립니다. 가용성 집합 내에 단일 가상 머신만 있는 경우 Azure는 가상 머신 대시보드에 모범 사례 구성이 아니라는 경고를 제공합니다. 이 구성은 기존 SLA(서비스 수준 계약) 보장을 벗어난 것입니다. 참고: Virtual Machine을 가용성 집합으로 이동하거나 가용성 집합 밖으로 이동하면 해당 Virtual Machine이 다시 부팅되어 이동합니다. <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/3060.drew2.png"><img alt="" border="0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/3060.drew2.png"></a>여기에서 가상 머신 SLA(서비스 수준 계약) 보장에&nbsp; 대해 자세히 알아<a href="https://azure.microsoft.com/en-us/support/legal/sla/">보세요.</a></p>


  <h4>임시 스토리지</h4>


  <p>고객이 Microsoft Azure Virtual Machines를 사용하는 주된 이유 중 하나는 Virtual Machines가 영구 디스크를 지원하기 때문입니다. 영구적이면 이러한 영구 디스크에 기록된 데이터는 다시 부팅, 시작/중지 또는 기타 수명 주기 이벤트를 통해 사용할 수 있습니다. 그러나 가상 머신에는 각 VM에 하나의 임시 디스크도 포함됩니다. 이러한 임시 디스크의 데이터는 표준 VM 수명 주기 이벤트를 통해 유지되지 않을 수 있습니다. 영구 디스크에 대한 데이터가 Microsoft Azure Storage 저장되는 동안 임시 디스크의 데이터가 하이퍼바이저 소프트웨어를 실행하는 호스트 운영 체제에 저장되어 있기 때문입니다. 임시 디스크는 추측한 데이터에 매우 유용하며 본질적으로 일시적입니다. Windows 대한 이러한 유형의 데이터의 좋은 예는 페이지 파일입니다. 실제로 Azure의 이미지에서 새 Windows VM이 프로비전되면 이 임시 디스크에 배치되도록 페이지 파일을 구성합니다.&nbsp; 고객은 영구적이어야 하는 데이터에 임시 디스크를 사용하면 안 됩니다. 일반적인 잘못된 구성은 고객이 임시 드라이브에 SQL 데이터베이스 파일을 배치하거나 이 드라이브에 Windows Active Directory 도메인 컨트롤러에 대한 데이터베이스 파일을 배치하는 것입니다. 대부분의 Windows VM의 경우 임시 디스크의 볼륨에는 D:\의 드라이브 문자가 있습니다. 임시 Storage&rdquo; 드라이브 레이블&ldquo;도 있습니다. Azure 가상 머신의 아래 스크린샷에서 볼 수 있습니다. <a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/5008.drew3.png"><img alt="" border="0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/5008.drew3.png"></a> 임시 디스크를 잘못 사용하지 않도록 하려면 테스트 절차의 일부로 임시 디스크를 다시 설정하는 작업을 수행하는 것이 좋습니다. 임시 디스크를 다시 설정하는 가장 간단한 방법은 가상 머신의 크기를 변경하는 것입니다. 먼저 필요에 따라 가상 머신을 구성하고, VM 크기를 변경한 다음, VM으로 돌아가서 모든 것이 예상대로 작동하는지 확인해야 합니다.</p>


  <h4>OS 디스크 업로드</h4>


  <p>Microsoft Azure 가장 큰 이점 중 하나는 Azure 가상 머신에서 사용할 VHD 형식 파일을 쉽게 업로드할 수 있다는 것입니다. 업로드된 VHD 파일에 VHD가 두 가지 범주 중 하나일 수 있는 Windows 운영 체제가 포함된 경우: (1) OS를 일반화하기 위해 업로드하기 전에 게스트 운영 체제에서 sysprep이 실행되었거나 (2) sysprep이 게스트 운영 체제에서 실행되지 않았습니다. 경우 (2) 게스트 운영 체제가 운영 체제에 adisk로&nbsp; 등록됩니다. 이 디스크를 사용하여 VM을 만들면 프로비전 에이전트의 이점 없이 배포되어 Microsoft Azure 사용하도록 최적화됩니다. 따라서 Azure에서 VM을 시작한 후 다음 모범 사례를 수행해야 합니다. 1.&nbsp;임시 디스크 위에 설명된 대로 페이지 파일을 임시 디스크&nbsp;&ndash; 로 이동은 일반적으로 D:\를 구동합니다. 페이지 파일을 임시 디스크로 이동하는 것이 좋습니다. 이렇게 하면 페이지 파일과 연결된 스토리지 트랜잭션 요금이 제거되고 영구 디스크에 저장해야 하는 데이터의 스토리지를 Microsoft Azure 대역폭이 해제됩니다. 2.&nbsp; 정품 인증 서버&ndash; 구성 이 단계는 Windows 정품 버전 또는&nbsp; &nbsp; &nbsp;볼륨 라이선스 버전의 windows인 업로드된 디스크에 유효합니다. 이 단계는 Windows 평가 버전을 활성화하는 데 사용할 수 없습니다. 제공된 Microsoft Azure 활성화 서버를 사용하여 활성화하도록 가상 머신을 구성하려면&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 관리 명령 프롬프트에서 다음&nbsp; &nbsp; &nbsp;단계를 실행합니다. a. VM이 정품 버전의 Windows 실행하는 경우 다음 단계를 사용하여 VM이 Windows volumelicense 버전이 되도록 구성합니다. i.&nbsp; 다음 페이지에서&nbsp; Windows Edition에 대한 적절한 KMS 클라이언트 설치 키(일반 볼륨 라이선스 키)를 찾습니다. <a href="https://technet.microsoft.com/en-us/library/jj612867.aspx">KMS 클라이언트 설치 키</a> ii.&nbsp; :&nbsp;<strong>slmgr /ipksetup&nbsp;</strong> <em>&lt;keyENTER b를 입력하여 클라이언트 설치 키를&gt;</em>&nbsp;&lt; 설치&gt;합니다. typeing:&nbsp;<strong>slmgr /skms</strong>&nbsp; kms.core.windows.net &lt;enter&gt; i.For Microsoft Azure 21ViaNet에서 작동하여 KMS 서버 DNS 주소를 설정하려면 kms.core.windows.net kms.core.chinacloudapi.cn c로 바꿉니다.&nbsp; typeing:&nbsp;<strong>slmgr /atoENTER</strong>&nbsp;&lt; 3을 입력하여 활성화를&gt; 시작합니다.&nbsp; SAN Policy&ndash;를 구성하여 새 볼륨을 자동으로 온라인화하도록 SAN 정책을 구성하려면 관리 명령 프롬프트에서 다음 명령을 실행하세요.</p>


  <ol>
   <li>
   <ol>
    <li>Diskpart</li>
    <li>SAN POLICY=OnlineAll</li>
    <li>종료</li>
   </ol>
   </li>
  </ol>


  <div><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/7484.drew4.png"><img alt="" border="0" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1806/7484.drew4.png"></a></div>


  <div>&nbsp;4.관리 명령 프롬프트에서 다음 명령을 실행해야 하는 RDP 세션의 시간 초과를 방지하려면 Keep-Alive&ndash;를 구성합니다.&nbsp;</div>


  <div>a.&nbsp; reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services&quot; /t REG_DWORD /vKeepAliveEnable /d</div>


  <div>b.reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services&quot; /t REG_DWORD /vKeepAliveInterval /d</div>


  <div>이러한 모범 사례가 유용하다면 의견에서 알려주세요. 또한 당신이 타격하는 다른 일반적인 문제가있는 경우 다음 의견 섹션에 언급하시기 바랍니다 나는 미래의 게시물에 추가 모범 사례를 해결하기 위해 노력할 것입니다. --Drew McDaniel</div>
