### YamlMime:Yaml
ms.openlocfilehash: 21c3ef241e8ed8189116fbfc000814103d1f95fe
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139898138"
Slug: azure-sql-database-introduces-new-near-real-time-performance-metrics
Title: Azure SQL Database 근 실시간에 가까운 새로운 성능 메트릭을 소개합니다.
Summary: 이 게시물에서는 이 DMV의 정보를 사용하여 데이터베이스 워크로드에 적합한 성능 계층을 평가하고 선택하는 프로세스에 대한 몇 가지 간단한 단계와 지침을 설명합니다.
Content: "<strong>편집기 참고-</strong> 최신 정보는 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/sql-database-upgrade-new-service-tiers/\">SQL Database 웹/비즈니스 데이터베이스를 새 서비스 계층으로 업그레이드를 참조하세요</a>.\n\n최근 Azure SQL Database 서비스에 대한 새로운 서비스/성능 계층 미리 보기(<a href=\"https://msdn.microsoft.com/en-us/library/dn741336.aspx\">기본, 표준 및 Premium</a>)가 도입되면서 고객이 데이터베이스에 가장 적합한 서비스 계층을 평가하고 결정하는 방법에 대한 많은 질문이 있었습니다. 이 결정을 간소화하기 위해 Azure SQL Database 세분화된 실시간 리소스 소비 데이터를 노출하는 새로운 DMV(동적 관리 뷰 - <b><i>sys.dm_db_resource_stats</i></b>)를 추가했습니다. 이 새 DMV 및 해당 사용에 대한 자세한 설명은 <a href=\"https://msdn.microsoft.com/en-us/library/dn800981.aspx\">여기에서 MSDN 설명서를 참조하세요</a>. 이 블로그 게시물에서는 이 DMV의 정보를 사용하여 데이터베이스 워크로드에 적합한 성능 계층을 평가하고 선택하는 프로세스에 대한 몇 가지 간단한 단계와 지침을 설명합니다.\n<h3>올바른 서비스 계층/성능 수준 선택</h3>\n1. 애플리케이션 또는 비즈니스 요구 사항에 필요한 최소 수준의 기능 기능을 제공하는 서비스 계층을 결정합니다. 예를 들어 백업이 보존되는 기간 또는 전체 데이터베이스 크기에 대한 비즈니스 요구 사항이 최소 서비스 계층에 영향을 줍니다(자세한 내용은 <a href=\"https://azure.microsoft.com/blog/2014/08/26/new-azure-sql-database-service-tiers-generally-available-in-september-with-reduced-pricing-and-enhanced-sla/\">서비스 계층 공지 블로그</a> 참조).\n\n2. 선택한 서비스 계층에서 가장 낮은 성능 수준에서 데이터베이스를 만듭니다. 예를 들어 표준 서비스 계층을 결정하는 경우 성능 수준 S1부터 시작합니다.\n<blockquote><b>참고</b>: <i>DB의 서비스/성능 계층을 변경하는 것은 Azure SQL Database 포털 페이지에서 단추를 클릭하는 것만큼 간단합니다. 이는 완전한 온라인 작업이며 DB가 작동 중이며 이 작업 기간 동안 사용할 수 있습니다.</i></blockquote>\n3. 일반적인 프로덕션 배포에서 예상되는 데이터베이스 사용 범위를 캡처하는 기간 동안 1시간 이상 애플리케이션에 대한 대표 워크로드를 실행합니다.\n\n4. 새 DMV sys.dm_db_ resource_stats 쿼리하여 지난 1시간 동안의 리소스 사용량 정보를 가져옵니다. 다음 쿼리는 데이터베이스의 리소스 사용량이 이 성능 계층에서 제공하는 리소스 제한에 맞는 비율(백분율)에 대한 정보를 제공하여 성능 수준 제한의 80% 내에서 데이터베이스를 실행하도록 가정합니다.\n<pre class=\"prettyprint\">SELECT \n    (COUNT(end_time) - SUM(CASE WHEN avg_cpu_percent &gt; 80 THEN 1 ELSE 0 END) * 1.0) / COUNT(end_time) AS 'CPU Fit Percent'\n    ,(COUNT(end_time) - SUM(CASE WHEN avg_log_write_percent &gt; 80 THEN 1 ELSE 0 END) * 1.0) / COUNT(end_time) AS 'Log Write Fit Percent'\n    ,(COUNT(end_time) - SUM(CASE WHEN avg_data_io_percent &gt; 80 THEN 1 ELSE 0 END) * 1.0) / COUNT(end_time) AS 'Physical Data Read Fit Percent'\nFROM sys.dm_db_resource_stats</pre>\nSLO(데이터베이스 서비스 수준 목표)에 따라 워크로드가 이 성능 수준에 적합한지 여부를 결정할 수 있습니다. 예를 들어 데이터베이스 워크로드 SLO가 99.9%이고 위의 쿼리에서 세 가지 리소스 차원 중 하나에 대해 99.9% 미만의 값을 반환하는 경우 다음으로 더 높은 성능 수준으로 이동하거나 애플리케이션을 조정하여 Azure SQL Database 부하를 줄이는 것이 좋습니다.\n<blockquote><b>참고</b>: 1 <i>시간 이상의 고화질 데이터가 필요한 경우 매시간 위의 DMV를 계속 쿼리하고 다른 로컬 DB/excel 스프레드 시트에 데이터를 저장할 수 있습니다. 또는 카탈로그 뷰 </i><a href=\"https://msdn.microsoft.com/en-us/library/dn269979.aspx\"><i>sys.resource_stats</i></a><i> 쿼리하여 지난 14일 동안 동일한 데이터를 가져올 수도 있지만 평균 5분이라는 낮은 충실도를 사용할 수도 있습니다.</i></blockquote>\n1. 더 높은 성능 수준을 시도하려는 경우 데이터베이스를 다음으로 더 높은 성능 수준으로 업그레이드하고 위의 3~4단계를 반복합니다.\n\n2. 워크로드에 필요한 SLO 및 대기 시간에 맞는 적절한 성능 수준을 찾은 후에는 이 DMV를 사용하여 정기적으로 리소스 사용량을 모니터링할 수 있습니다. 이 리소스 사용량 사용량 정보 및 관련 그래프는 Microsoft Azure 포털 페이지를 통해서도 사용할 수 있습니다.\n<h3>데이터베이스 워크로드가 리소스 제한에 도달하면 어떻게 되나요?</h3>\n선택한 서비스 계층/성능 수준에 허용되는 최대 한도까지 데이터베이스 워크로드를 실행하는 데 필요한 리소스를 제공하도록 성능 수준이 보정 및 제어됩니다. 워크로드가 CPU/데이터 IO/로그 IO 제한 중 하나에서 한도에 도달하는 경우 최대 허용 수준에서 리소스를 계속 수신하지만 쿼리에 대한 대기 시간이 증가할 가능성이 높습니다. 이러한 제한으로 인해 오류가 발생하지는 않지만 속도가 느려져 쿼리 타이밍이 초과되기 시작하지 않는 한 워크로드가 느려집니다. 허용되는 최대 동시 사용자 세션/요청(작업자 스레드)의 제한에 도달하면 추가 연결/요청에 대한 명시적 오류( <a href=\"https://msdn.microsoft.com/en-us/library/azure/dn338078.aspx\">여기서</a> MSDN 설명서 참조)가 표시됩니다.\n<h3>웹/비즈니스 계층 데이터베이스에 대한 지침</h3>\n새 DMV sys.dm_db_resource_stats 웹/비즈니스 계층 데이터베이스에 대한 리소스 소비 데이터로 채워지지 않습니다. 그러나 master 데이터베이스의 이전 <a href=\"https://msdn.microsoft.com/en-us/library/dn269979.aspx\">sys.resource_stats</a> 보기에는 웹/비즈니스 계층 데이터베이스에 대한 리소스 소비 데이터도 있습니다. 웹/비즈니스 계층 데이터베이스에는 DTU/리소스 제한이 보장되지 않으므로 S2 성능 수준에서 데이터베이스에 사용할 수 있는 리소스 양 측면에서 백분율 값을 정규화합니다. S2 데이터베이스 수준의 DTU 사용량 정보를 사용하면 새 계층 데이터베이스 측면에서 웹/비즈니스 데이터베이스의 현재 사용량을 정규화하고 더 적합한 위치를 확인할 수 있습니다. master 데이터베이스에 대한 다음 쿼리를 사용하면 S2 데이터베이스의 DTU 성능 백분율을 기준으로 Web/Business 계층의 평균 DTU 사용량을 계산할 수 있습니다.\n<pre class=\"prettyprint\">SELECT start_time, end_time,   \n  (SELECT Max(v)    FROM (VALUES (avg_cpu_percent), (avg_physical_data_read_percent), (avg_log_write_percent)) AS value(v)) as [avg_DTU_percent] \nFROM sys.resource_stats where database_name = ‘&lt;your db name&gt;’ order by end_time desc</pre>\n예를 들어 DTU 사용량에 80%의 값이 표시되면 S2 데이터베이스가 가질 수 있는 제한의 80%의 속도로 DTU를 사용하고 있음을 나타냅니다. 이 보기에서 100% 이상의 값이 표시되면 S2보다 큰 성능 계층이 필요하다는 의미입니다.\n\n예를 들어 백분율 값이 300%라고 가정해 보겠습니다.이 경우 S2에서 사용 가능한 것보다 리소스를 3배 더 사용하고 있음을 나타냅니다.적절한 시작 크기를 확인하려면 S2(50 DTU)에서 사용할 수 있는 DTU를 다음 더 높은 크기(P1 = 100 DTU 또는 S2의 200%, P2 = 200 DTU 또는 S2의 400%)와 비교합니다.S2의 300%에 있기 때문에 P2로 시작하고 다시 테스트하려고 합니다.\n\nDTU 사용률에 따라 데이터베이스가 S2 성능 수준(또는 <a href=\"https://msdn.microsoft.com/en-us/library/dn741336.aspx\">MSDN 사이트에 설명</a>된 대로 다양한 성능 계층의 DTU 백분율 및 상대 DTU 권한을 통해 표시된 낮은/더 높은 수준) 내에 들어갈 수 있는지 확인할 수 있습니다.\n<blockquote><b>참고:</b> <i>다양한 성능 수준 간의 상대 DTU 숫자는 </i><a href=\"https://msdn.microsoft.com/en-us/library/dn741327.aspx\"><i>Azure SQL Database 벤치마크</i></a> 워크로드를 기반으로 합니다 <i> . 데이터베이스의 워크로드가 다를 가능성이 높기 때문에 위의 계산을 새 계층의 웹/비즈니스 데이터베이스에 대한 초기 적합성 지침으로 사용해야 합니다. 데이터베이스를 새 계층으로 이동한 후에는 이전 섹션에 설명된 프로세스를 사용하여 워크로드 요구 사항에 맞는 올바른 서비스 계층의 유효성을 검사/미세 조정합니다.</i></blockquote>"
