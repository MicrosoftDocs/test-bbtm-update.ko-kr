### YamlMime:Yaml
ms.openlocfilehash: 8665b7c120445836b2036d1e80667a8ac5bed82e
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139906760"
Slug: how-azure-security-center-helps-analyze-attacks-using-investigation-and-log-search
Title: Azure Security Center가 조사 및 로그 검색을 사용하여 공격을 분석하는 방법
Summary: 공격을 받을 때마다 매초가 중요합니다. ASC(Azure Security Center)는 고급 분석 및 글로벌 위협 인텔리전스를 사용하여 악의적인 위협을 탐지하고, 새로운 기능을 통해 다음을 수행할 수 있습니다.
Content: >-
  <p>공격을 받을 때마다 매초가 중요합니다. ASC(Azure Security Center)는 고급 분석 및 글로벌 위협 인텔리전스를 사용하여 악의적인 위협을 감지하고, 새로운 기능을 통해 신속하게 대응할 수 있습니다. 이 블로그 게시물에서는 분석가가 Azure Security Center의 조사 및 로그 검색 기능을 활용하여 경고가 보안 손상인지 여부를 확인하고 해당 손상의 범위를 이해하는 방법을 보여 줍니다.</p>


  <p>ASC 조사 기능에 대해 자세히 알아보려면 <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-investigation" target="_blank"><em>Azure Security Center(미리 보기)에서 인시던트 및 경고 조사</em></a> 문서를 참조하세요. &rsquo;경고를 자세히 살펴보고 이러한 새로운 기능을 사용하여 더 많은 것을 배울 수 있는지 확인합니다.</p>


  <p>Security Center 표준 계층 사용자는 아래 그림과 비슷한 대시보드를 볼 수 있습니다. <a href="https://portal.azure.com/?feature.customportal=false#blade/Microsoft_Azure_Security/SecurityMenuBlade/1" target="_blank">Security Center 정책</a>의 가격 책정 계층 블레이드에서 표준 계층 또는 무료 90일 평가판을 선택할 수 있습니다. 아래 화면에서 경고 목록을 보려면 보안 경고 그래프를 클릭합니다. 이 보기에는 Security Center 검색에 의해 트리거되는 경고와 다른 보안 솔루션의 통합 경고가 포함됩니다. 가능한 경우 Security Center는 공격자 활동 체인의 일부인 경고를 인시던트에 결합합니다. 아래 스크린샷에서 강조 표시된 세 개의 상호 연결된 점 아이콘은 인시던트를 나타내고 파란색 방패 아이콘은 단일 경고를 나타냅니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a002cb33-ab92-4622-aed4-fc384a1d4aff.png"><img alt="Security Center - Overview" border="0" height="371" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8fad260b-3e49-4c4d-82de-415804371f97.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="Security Center - 개요" width="1002"></a></p>


  <p>인시던트를 클릭하면 인시던트에 포함된 모든 경고가 표시되는 인시던트 세부 정보 창이 시작됩니다. 특정 경고를 선택하면 해당 경고에 대한 자세한 정보가 제공됩니다. 경고 세부 정보 블레이드에는 이 경고에 대한 조사 프로세스를 시작하는 <strong>조사</strong> 단추(아래 강조 표시)도 포함되어 있습니다. 예제 경고에서 PowerShell은 <em>호출</em> 식을 사용하여 인터넷에서 의심스러운 일괄 처리 파일을 다운로드하는 것을 볼 수 있습니다. 이 경고 및 보안 인시던트 컨텍스트에 대해 자세히 알아보려면 <strong>조사</strong> 단추를 클릭하여 조사를 시작할 수 있습니다. 조사가 이미 시작된 경우 이 단추는 기존 조사를 다시 시작합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3e8b205e-1f59-49a4-b074-8bcd3e76e646.png"><img alt="Investigate button" border="0" height="525" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/82571629-9d15-4bcd-93aa-62d56fba7a68.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="조사 단추" width="1010"></a></p>


  <p>조사 대시보드에는 초기 경고 또는 인시던트와 관련된 계정, 컴퓨터 및 기타 경고와 같은 엔터티의 시각적 대화형 그래프가 포함되어 있습니다. 엔터티를 선택하면 다른 관련 엔터티가 표시됩니다. 예를 들어 경고가 발생한 컴퓨터에 로그온한 사용자 계정을 선택하면 해당 계정이 로그온한 다른 컴퓨터와 해당 계정과 관련된 다른 경고가 표시됩니다. 그래프에서 관련 엔터티를 탐색하여 엔터티에 대한 컨텍스트를 탐색하고 보안 손상과 관련된 모든 항목에 태그를 지정하여 조사 서류를 작성할 수 있습니다. 이 단계에서 그래프는 초기 경고에서 한두 홉 떨어진 항목을 표시하지만 그래프의 다른 노드를 클릭하면 새로 선택한 노드와 관련된 항목이 표시됩니다.</p>


  <p>조사는 일반적으로 인시던트 연대기를 이해하여 경고가 트리거될 무렵에 발생한 이벤트의 논리적 순서에 초점을 맞추는 것으로 시작됩니다. 분석 기간을 설정하려면 그래프의 왼쪽 위에서 시간 범위 선택기 드롭다운을 사용할 수 있습니다. 이를 사용하여 미리 설정된 시간 범위 또는 사용자 지정 범위를 사용하여 포커스를 지정할 정확한 시간 범위를 지정할 수 있습니다. 현재 예제에서 첫 번째 경고는 오전 9시 47분경에 트리거됩니다. 9:40에서 9:53까지의 사용자 지정 시간 범위는 좋은 시작 범위입니다. 선택한 시간 범위는 그래프에 추가되는 경고 및 엔터티를 제한합니다. 그래프를 탐색할 때 이 시간 범위에서 관계가 발생한 경우에만 관련 엔터티가 추가됩니다. 예를 들어 이 시간 범위에서 호스트에 로그온한 계정이 표시됩니다. 또한 시간 범위는 탐색 탭에서 쿼리된 이벤트를 현재 시간 범위 내에서 발생하는 이벤트로 제한합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6fcbd437-a960-4b64-9039-8de8cf9ce8ff.png"><img alt="Time range" border="0" height="511" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/254c7938-bee4-4095-a2b8-c3f0090e913e.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="시간 범위" width="1244"></a></p>


  <p>이 대시보드에서는 선택한 엔터티에 대한 관련 정보가 일련의 탭에서 화면 오른쪽(아래 스크린샷)에 표시됩니다. <strong>정보</strong> 탭에는 엔터티에 대한 요약 정보가 표시됩니다. 예를 들어 컴퓨터를 선택하면 OS 유형, IP 주소 및 지리적 위치가 표시됩니다. <strong>엔터티</strong> 탭에는 선택한 항목과 직접 관련된 엔터티, 경고 및 인시던트가 표시됩니다. 이 예제에서 경고(SAIPROD)에서 식별된 컴퓨터를 선택하면 의심스러운 PowerShell 활동, 의심스러운 계정 만들기, AppLocker 바이패스 시도 및 중요한 서비스 사용 안 시에 관련된 경고가 표시됩니다. 이러한 경고를 클릭하면 해당 경고에 대한 자세한 내용이 표시됩니다. <strong>검색</strong> 탭에는 선택한 엔터티와 관련된 이벤트가 포함된 사용 가능한 이벤트 로그가 표시됩니다. 예제 호스트의 경우 SecurityEvent, SecurityDetection 및 하트비트를 표시합니다.</p>


  <p><strong>검색</strong> 탭에서 로그를 통해 사용자 고유의 검색을 수행할 수 있지만 <strong>탐색</strong> 탭을 사용하면 관련 이벤트에 더 빠르게 액세스하고 조사 프로세스를 가속화할 수 있습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e985d920-5e93-4476-b1b7-fbca4a1e4a0e.png"><img alt="Investigation path" border="0" height="637" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f7bae2ee-63f5-4b64-83a4-1743fa14e6e2.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="조사 경로" width="1560"></a></p>


  <p>&#39;탐색 탭에서 좀 더 자세히 살펴보겠습니다.</p>


  <p><strong>탐색</strong> 탭에는 지정된 엔터티에 대한 활동 조사를 위해 가장 관련성이 큰 데이터 중 일부를 강조 표시하여 쉽게 사용할 수 있는 방식으로 데이터를 표시하는 쿼리 집합이 포함되어 있습니다. 예를 들어 아래 스크린샷에서 <strong>계정 로그온</strong> 실패 쿼리는 사용자 이름이 없는 두 번의 로그온 시도를 보여 줍니다. 이 목록에서 개별 항목을 클릭하여 특정 이벤트에 대한 자세한 내용을 보거나 돋보기 아이콘을 클릭하여 로그 검색 화면에서 이러한 모든 이벤트를 볼 수 있습니다. 탐색 쿼리는 관련 이벤트 데이터가 있는 경우에만 표시됩니다. 쿼리는 다른 엔터티 형식에 대해서도 다르므로 그래프의 엔터티 간을 탐색할 때 이 탭에 다른 내용이 표시됩니다.</p>


  <p>또한 <strong>공격자가 자주 사용하는 거의 사용되지 않는 프로세스</strong>의 데이터도 볼 수 있습니다. 공격자가 자주 사용하는 운영 체제 실행 파일의 프로세스 및 명령줄을 보여 줍니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/663f23a1-38b0-4d29-a057-3ee556595bf4.png"><img alt="Rarely used process" border="0" height="607" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2dceb36b-417d-4d58-ab30-40d18f497357.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="거의 사용되지 않는 프로세스" width="1454"></a></p>


  <p>이 경우 거의 사용되지 않는 프로세스에서 표시되는 명령줄 작업(위)을 살펴보면 공격자가 먼저 whoami&rdquo; 명령을 실행&ldquo;하여 현재 로그온한 사용자가 누구인지를 표시하는 것을 볼 수 있습니다. 또한 사용자 계정이 추가되고, Windows 실행 키에 레지스트리 값을 추가하고, 배치 파일을 다운로드하는 데 사용되는 PowerShell, Windows 서비스의 설치 및 시작과 같은 다른 의심스러운 활동도 볼 수 있습니다. 이 쿼리의 탭 보기에는 사용 가능한 데이터의 하위 집합만 표시할 수 있습니다. 더 많은 데이터가 있는 경우 <strong>모든 보기</strong> 링크가 쿼리 결과의 맨 아래에 표시됩니다. 이 옵션을 클릭하면 로그 검색으로 이동되고 모든 데이터가 표시됩니다. <strong>TimeGenerated</strong> 열 머리글을 클릭하여 시간별로 정렬하여 실제 시간순 그림을 가져옵니다.</p>


  <p>조사 그래프로 돌아가려면 <strong>로그 검색</strong> 화면 맨 위에 있는<strong> 조사 대시보드</strong> 이동 경로 항목을 클릭해야 합니다. 브라우저 <strong>뒤로</strong> 단추를 사용하면 조사를 완전히 종료할 수 있습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8b48b4a1-3604-4c7f-9fe8-008182229b68.png"><img alt="Investigation dashboard (preview)" border="0" height="110" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0cd80b5a-adec-4334-b732-62d4845007e3.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="조사 대시보드(미리 보기)" width="414"></a></p>


  <p>인시던트 관련 흥미로운 아티팩트가 발견되면 추가될 수도 있습니다. 예를 들어 새 사용자 계정 adninistrator를 만들면 의심스러운 계정 생성에 대한 경고가 생성되었습니다. 명령줄의 시퀀스를 살펴보면 현재 인시던트와 관련이 있는 것 같아서 아래 스크린샷과 같이 이를 추가할 수 있습니다. 전체 아이디어는 인시던트에 아티팩트가 더 추가됨에 따라 공격이 어떻게 진행되었는지에 대한 더 나은 요약을 얻을 수 있다는 것입니다. 이 계정을 추가하면 공격자가 횡적 이동을 위해 그래프를 사용하거나 다른 VM에서 해당 계정이 실행하는 비정상적인 프로세스가 표시되는 경우&rsquo; 그래프를 두 번째 VM&rsquo;(가상 머신)으로 확장하는 데 도움이 될 수 있습니다. 발견된 모든 VM&rsquo;을 인시던트에 추가 컴퓨터로 추가할 수 있습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/06f568ef-3a88-4ea4-acea-e8cb9f0da51d.png"><img alt="Investigation dashboard (preview) 2" border="0" height="545" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5c5a5692-9377-457b-b749-4e11400bda3c.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="조사 대시보드(미리 보기) 2" width="1061"></a></p>


  <p>이 확장된 보기에서 한 가지 흥미로운 점은 모든 공격자 명령에 대한 <strong>Logonid(0x144a52</strong>)가 동일하다는 것입니다. 즉, 이러한 모든 명령은 동일한 로그온 세션에서 동일한 계정에 의해 실행되었습니다. 이는 조사에 자주 사용되는 좋은 분석 데이터 요소입니다. 경고가 시작된 특정 로그온 세션 내의 활동에 집중하면 공격자가 수행한 다른 작업을 많이 알려주거나 추가 의심스러운 활동이 없는 경우 경고가 가양성일 수 있음을 신속하게 확인할 수 있습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d5c3e2da-b6c0-401a-8cc4-ba14b32424df.png"><img alt="Log search" border="0" height="247" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/fc6029c8-0e10-4f26-a5a8-b9533c94fc8b.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="로그 검색" width="1171"></a></p>


  <p>Azure Security Center의 <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-search" target="_blank">로그 검색</a> 기능을 사용하면 이 기능을 좀 더 자세히 살펴볼 수 있습니다.</p>


  <h2>로그 검색</h2>


  <p>Security Center는 Log Analytics 검색을 사용하여 보안 데이터를 검색하고 분석합니다. Log Analytics는 데이터를 신속하게 검색하고 통합할 수 있는 쿼리 언어를 포함합니다. Security Center에서 Log Analytics 검색을 사용하여 쿼리를 생성하고 수집된 데이터를 분석할 수 있습니다. 탐색 쿼리 중 하나(모두&rdquo; 보기 또는 돋보기 아이콘을 &ldquo;클릭하여 로그 검색에 도달)를 쿼리의 시작점으로 사용하는 것이 더 쉬울 수 있습니다.</p>


  <p><strong>로그 검색</strong>에서 찾을 이벤트 유형을 설정할 수 있습니다. 이 경우 Windows 프로세스 만들기 이벤트에 대해 이벤트 ID == 4688&rdquo;을 사용&ldquo;했습니다. 여기에는 관심 있는 CommandLine 데이터가 포함됩니다. SubjectLogonId == &quot;0x144a52 이벤트만 표시하도록 이 범위를 더 좁힐 수 있습니다&quot;.&nbsp; 프로젝트 명령을 추가하면 관심 있는 필드만 표시됩니다. 검색은 아래와 같은 결과를 제공합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/02bbc273-4515-4927-a020-f21681541ff7.png"><img alt="Log Search 2" border="0" height="528" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7070e76e-a68b-42ca-9a53-ee2ccc366fb6.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="로그 검색 2" width="1259"></a></p>


  <p>검색 결과를 보면 다음이 표시됩니다.</p>


  <ul>
   <li>공격자가 무차별 암호 대입 기술을 사용하여 로그인을 시도하고 성공했습니다. 이는 4688 이벤트에 표시되지 않지만 이전에 본 실패한 로그온 시도에서 제안됩니다.</li>
   <li>로그인한 후 공격자는 명령 프롬프트를 시작하고 현재 로그온한 사용자가 누구인지 표시하는 whoami&rdquo; 명령을 실행&ldquo;했습니다. 그런 다음 공격자는 systeminfo&quot;를 실행&quot;하여 호스트 VM에 대한 자세한 구성 정보를 가져옵니다. &quot;또한 qwinsta&quot; 명령은 VM의 RDP 세션 및 기타 세션에 대한 정보를 얻기 위해 실행되었습니다.</li>
   <li>PowerShell은 호출 식을 실행하여 인터넷에서 일괄 처리 파일을 다운로드하는 데 사용되었습니다. 다음 프로세스의 실행 시간이 동일한 초 내에 발생하는 것을 볼 수 있으므로 후속 명령은 9:49:07에 실행되는 것으로 표시되는 일괄 처리 파일에 포함될 수 있습니다.</li>
   <li>일괄 처리 파일은 먼저 방화벽을 사용하지 않도록 설정합니다. 알려진 공격자 기술입니다. 초기 손상이 완료되면 종종 방화벽, 바이러스 백신 및 공유 액세스를 사용하지 않도록 설정하는 것과 같은 시스템의 보안 설정을 낮추는 조치를 취합니다.</li>
   <li>다음으로, &#39;adninstrator&#39;라는 새 사용자 계정이 추가되었습니다. 계정 이름은 사용자 관리자가 알아차리지 않도록 표준 Windows 계정과 매우 유사합니다.</li>
   <li>그런 다음 svvchost&quot;라는 &quot;의심스러운 서비스가 만들어지고 시작됩니다.</li>
   <li>또한 자동 실행 명령을 설치하는 레지스트리 추가도 검색에 표시됩니다. 자세히 분석할 때 AppLocker 제한을 우회하려는 시도처럼 보입니다. AppLocker는 Windows 시스템에서 실행할 수 있는 실행 파일을 제한하도록 구성할 수 있습니다. 명령줄 패턴은 공격자가 regsvr32.exe 사용하여 신뢰할 수 없는 코드를 실행하여 AppLocker 정책을 우회하려는 것처럼 보입니다. 엄격한 AppLocker 실행 파일 및 스크립트 규칙이 적용되는 호스트에서 공격자는 종종 regsvr32 및 인터넷에 있는 스크립트 파일을 사용하여 스크립트 바이패스를 얻고 악성 스크립트를 실행하는 것을 볼 수 있습니다.</li>
  </ul>


  <p>요약하면 이 게시물은 Azure Security Center의 새로운 조사 및 로그 검색 기능을 사용하여 보안 인시던트 특성과 범위를 이해하는 방법을 보여 줍니다.</p>


  <p>Microsoft Ignite에서 Security Center 팀은 Azure 고객이 보안 위협을 더 잘 이해하고 조사하고 관리하는 데 도움이 되는 몇 가지 새로운 기능을 발표했습니다. 이러한 기능에 대한 자세한 내용은 Azure Security Center가 Sarah Fender가 <a href="https://azure.microsoft.com/en-us/blog/azure-security-center-extends-advanced-threat-protection-to-hybrid-cloud-workloads/" target="_blank"><em>하이브리드 클라우드 워크로드로 고급 위협 방지를 확장</em></a> 한 블로그 게시물에서 확인할 수 있습니다.<br>

  &nbsp;<br>

  Security Center는 경고 및 인시던트에 대한 조사 환경을 자동화하여 보안 위협에 대응하는 데 필요한 시간과 전문 지식을 줄이는 데 도움이 됩니다.</p>


  <p>다음 블로그 게시물에서는 다음 기능을 사용하여 답변할 수 있는 몇 가지 다른 질문을 해결하려고 합니다.</p>


  <ul>
   <li>내 환경에서는 드물게 경고에 실행 파일 플래그가 지정되었나요?</li>
   <li>프로세스에 비정상적인 부모 프로세스가 있나요?</li>
   <li>경고 시간 전후에 컴퓨터에 로그온한 사용자는 무엇인가요?</li>
   <li>이 시간 동안 AV 경고가 트리거했나요? 프로세스 충돌은 어떻습니까?</li>
  </ul>


  <h2>자세히 알아보려면</h2>


  <ul>
   <li>Security Center가 사이버 공격을 탐지하는 방법에 대한 실제 예제와 함께 다른 블로그 게시물을 참조하세요.
   <ul>
    <li><a href="https://azure.microsoft.com/en-us/blog/how-azure-security-center-unveils-suspicious-powershell-attack/" target="_blank">Azure Security Center에서 의심스러운 PowerShell 공격을 공개하는 방법</a>&nbsp;</li>
    <li><a href="https://azure.microsoft.com/en-us/blog/how-azure-security-center-helps-reveal-a-cyberattack/" target="_blank">Azure Security Center가 사이버 공격을 공개하는 데 도움이 되는 방법</a></li>
   </ul>
   </li>
   <li><a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-detection-capabilities" target="_blank">Security Centers&rsquo; 고급 검색 기능에</a> 대해 알아봅니다.</li>
   <li>Azure Security Center에서 <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-managing-and-responding-alerts" target="_blank">보안 경고를 관리하고 대응하는</a> 방법을 알아봅니다.</li>
   <li>서비스 사용에 대한 <a href="https://docs.microsoft.com/en-us/azure/security-center/security-center-faq" target="_blank">질문과 대답</a> 을 찾습니다.</li>
  </ul>


  <p>Azure Security 블로그를 읽어 최신 <a href="https://blogs.msdn.com/b/azuresecurity/" target="_blank">Azure 보안</a> 뉴스 및 정보를 가져옵니다. Security Center의 더 많은 조사 기능을 강조 표시하기 위해 블로그 게시물을 가져올 때 계속 지켜봐 주시기 바랍니다.</p>
