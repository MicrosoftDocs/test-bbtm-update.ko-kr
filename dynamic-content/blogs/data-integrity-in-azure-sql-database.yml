### YamlMime:Yaml
ms.openlocfilehash: 7fe3d59ff4a3b25931d940f87388e4a84f3ca3cf
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139908457"
Slug: data-integrity-in-azure-sql-database
Title: Azure SQL Database 데이터 무결성
Summary: 'Microsoft는 데이터 무결성을 매우 중요하게 생각합니다. SQL Server DBA에서 데이터 무결성(예: DBCC CHECKDB)을 모니터링하는 데 사용되는 몇 가지 전통적인 기술과 데이터베이스 손상으로부터 복구하는 다양한 방법이 있지만, Azure SQL Database 엔지니어링 팀은 데이터 손실 없이 일부 부패 클래스를 자동으로 처리할 수 있는 새로운 기술을 개발할 수 있었습니다. 이러한 기술은 피할 수 있는 경우 데이터 손실 및 가동 중지 시간을 방지하기 위해 서비스의 일부로 사용됩니다. '
Content: >-
  <p>Microsoft는 데이터 무결성을 매우 중요하게 생각합니다. SQL Server DBA에서 데이터 무결성(예: DBCC CHECKDB)을 모니터링하는 데 사용되는 몇 가지 전통적인 기술과 데이터베이스 손상으로부터 복구하는 다양한 방법이 있지만, Azure SQL Database 엔지니어링 팀은 데이터 손실 없이 일부 부패 클래스를 자동으로 처리할 수 있는 새로운 기술을 개발할 수 있었습니다. 이러한 기술은 피할 수 있는 경우 데이터 손실 및 가동 중지 시간을 방지하기 위해 서비스의 일부로 사용됩니다.&nbsp;</p>


  <p>이 블로그 게시물에서는 이러한 기술 중 일부, 작동 방식 및 Azure SQL Database 데이터를 보호하기 위해 수행해야 하는 단계에 대해 우려하는 고객에게 미치는 영향을 간략하게 설명합니다.</p>


  <h2>Azure SQL Database 대한 데이터 무결성을 관리하는 방법</h2>


  <p>Azure SQL Database 데이터 무결성을 보호하는 작업에는 기술과 진화하는 방법의 조합이 포함됩니다.</p>


  <p><strong>광범위한 데이터 무결성 오류 경고 모니터링</strong>. Azure SQL Database 데이터 무결성 문제를 나타내는 모든 오류 및 처리되지 않은 예외에 대한 경고를 내보낸다. 각 경고는 수동 처리 및 조사를 위해 엔지니어링 팀으로 라우팅됩니다(그리고 이어지는 일반적인 프로세스는 아래에 설명되어 있습니다). 이 경고 시스템은 이 블로그 게시물에 설명된 것보다 더 많은 무결성 문제를 발견했습니다.</p>


  <p><strong>백업 및 복원 무결성 검사</strong>. Azure SQL Database 엔지니어링 팀은 지속적으로 서비스 전체에서 데이터베이스의 자동화된 데이터베이스 백업에 대한 복원을 자동으로 테스트합니다. 복원 시 데이터베이스도 DBCC CHECKDB를 사용하여 무결성 검사를 받습니다. 무결성 검사 중에 문제가 발견되면 해당 경고를 엔지니어링 팀에 알려줍니다.</p>


  <p><strong>I/O 시스템에서 &ldquo;쓰기&rdquo; 검색이 손실되었습니다</strong>. Azure SQL Database 관찰된 물리적 손상 문제의 가장 일반적인 원인을 감지하는 추가 기능이 있습니다. I/O 시스템에서 &ldquo;쓰기가 손실되었습니다&rdquo;. 이 기능은 페이지 쓰기 및 관련 LSN(로그 시퀀스 번호)을 추적합니다. 디스크에서 데이터 페이지의 후속 읽기는 예상되는 LSN 페이지&rsquo;와 비교됩니다. 디스크에 있는 항목과 예상되는 항목 간에 LSN이 일치하지 않으면 페이지가 부실한 것으로 간주되어 엔지니어링 팀에 즉각적인 경고가 발생합니다.</p>


  <p><strong>자동 페이지 복구</strong>. Azure SQL Database 비즈니스 연속성을 위해 백그라운드에서 데이터베이스 복제본을 활용하므로 서비스는 SQL Server 데이터베이스 미러링 및 가용성 그룹에 사용되는 것과 동일한 기술인 <a href="https://docs.microsoft.com/en-us/sql/sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring">자동 페이지 복구</a>도 활용합니다. 복제본이 데이터 무결성 문제로 인해 페이지를 읽을 수 없는 경우 다른 복제본에서 페이지의 새 복사본을 검색하여 데이터 손실 또는 고객의 가동 중지 시간 없이 읽을 수 없는 페이지를 대체합니다. 이 기능은 지역 보조 데이터베이스가 있는 프리미엄 계층 데이터베이스 및 표준 계층 데이터베이스에 적용됩니다.</p>


  <p><strong>미사용 및 전송 중인 데이터 무결성</strong>. 서비스에서 만든 데이터베이스는 기본적으로 CHECKSUM 설정으로 페이지를 확인하고 전체 페이지에 체크섬을 계산하고 페이지 헤더에 저장하도록 설정됩니다. TLS(전송 계층 보안)는 TCP/IP에서 제공하는 기본 전송 수준 체크섬 외에 모든 통신에도 사용됩니다.</p>


  <h2>데이터 무결성 인시던트 처리 방법</h2>


  <p>잘못된 결과 또는 손상의 인시던트가 <em>가장 높은 심각도</em>로 처리되며, 모든 Azure 엔지니어링 팀에서 24x7 작업 및 지원을 받습니다. 무결성 인시던트 처리의 목표는 사용 불가를 최소화하고 데이터 손실의 양을 최소화하는 것입니다.</p>


  <h3>시스템 데이터 무결성 문제 해결</h3>


  <p>고객 데이터 또는 데이터베이스 가용성에 영향을 주지 않는 인시던트는 고객에게 알리지 않고 수정됩니다. 예를 들어 자동 페이지 복구에서 해결할 수 있는 인시던트 또는 고객 데이터 또는 쿼리 결과에 영향을 주지 않는 내부 데이터베이스 메타데이터 또는 원격 분석의 손상이 있습니다.&nbsp;</p>


  <h3>고객 데이터 무결성 문제 해결</h3>


  <p>모든 잘못된 결과 및 고객 데이터 손상 문제는 가능한 한 빨리 확인된 검색 후 영향을 받은 고객에게 전달됩니다. Azure SQL DB 엔지니어는 다음을 수행합니다.</p>


  <ol>
      <li>고객과 직접 협력하여 손상 범위를 설명하고, 복구 옵션을 요약하고, 고객이 애플리케이션 및 시나리오에 가장 적합한 옵션을 선택할 수 있도록 합니다.</li>
      <li>손상 직전 지점으로 즉시 복원을 시작하고 다른 데이터베이스 이름으로 고객에게 무료로 사용할 수 있도록 합니다. 가용성이 우선 순위가 가장 높은 고객은 종종 이 버전의 데이터베이스 사용을 시작하도록 선택하는 반면 일부 손상된 데이터가 있는 버전에 대한 복구 작업은 병렬로 발생합니다. 이 경우 원래 데이터베이스를 복구한 후 지원 엔지니어는 고객이 두 데이터베이스 간에 차이가 있는 데이터와 조정을 위해 수행해야 하는 작업을 식별하는 데 도움을 줍니다.</li>
      <li>가능한 경우 고객이 애플리케이션에 미치는 영향 범위를 이해하는 데 도움을 줍니다. 예를 들어 데이터 손상으로 인해 애플리케이션이 예기치 않은 방식으로 다른 데이터를 변경했는지 여부를 식별할 수 있습니다.</li>
  </ol>


  <p>복구는 다양한 방법과 고객과 함께 수행된 단계를 사용하여 수행됩니다. 옵션은 다음을 포함할 수 있지만 제한되지는 않습니다.</p>


  <ul>
      <li>클러스터형 인덱 &ndash; 스 또는 힙도 손상되지 않은 비클러스터형 인덱스 등을 위해 인덱스 다시 작성</li>
      <li>복구 시 데이터가 손실될 가능성이 없는 REPAIR_REBUILD DBCC CHECKDB를 실행합니다.</li>
      <li>복구로 인해 데이터가 손실될 수 있는 REPAIR_ALLOW_DATA_LOSS DBCC CHECKDB를 실행합니다.</li>
      <li>DBCC CHECKDB를 사용하여 데이터 무결성 문제를 복구할 수 없는 시나리오의 경우 엔지니어는 데이터 무결성 문제가 발생하기 전 지점까지 지정 시간 복원을 사용하고 트랜잭션 로그에서 관련 트랜잭션을 수동으로 재생합니다. 이 경우의 예는 자동 재생을 방지하지만 고객 데이터에 영향을 주지 않는 방식으로 트랜잭션 로그가 손상된 경우입니다.&nbsp;</li>
  </ul>


  <p>잘못된 결과 또는 데이터 손상으로 이어지는 문제는 엔지니어링 팀으로부터 자세한 사후 평가를 받고 문제로 인해 생성된 관련 복구 항목은 면밀히 추적됩니다. 앞에서 설명한 손실된 쓰기&rdquo; 기능을 포함하여 &ldquo;이러한 사후 검토로 인해 많은 중요한 개선 사항이 발생했습니다.</p>


  <h2>Azure SQL Database 무결성 검사 실행</h2>


  <p>Azure SQL Database 엔지니어링 팀은 데이터 무결성 관리를 담당합니다.&nbsp; 따라서 고객이 Azure SQL Database 무결성 검사를 실행할 필요는 없습니다.</p>


  <p>서비스에서 제공하는 기존 모니터링 및 보호를 통해 고객은 여전히 Azure SQL Database 사용자 시작 무결성 검사를 실행하도록 선택할 수 있습니다. 예를 들어 고객은 필요에 따라 DBCC CHECKDB를 실행할 수 있습니다.</p>


  <h2>진화하는 방법론</h2>


  <p>Azure SQL Database 엔지니어링 팀은 서비스에 사용되는 소프트웨어 및 하드웨어의 데이터 무결성 문제 검색 기능을 정기적으로 검토하고 지속적으로 향상시킵니다. 드물긴 하지만 Microsoft 고객 지원에서 알림을 받기 전에 데이터 무결성 오류가 발생하는 경우 고객은 <a href="https://docs.microsoft.com/en-us/azure/azure-supportability/how-to-create-azure-support-request">지원 사례를 제출</a>해야 합니다.</p>


  <p>Azure SQL Database Microsofts&rsquo; 데이터 무결성 전략에 대해 공유할 피드백이 있는 경우 여러분의 의견을 듣고 싶습니다. 이 주제에 대한 피드백이나 의견을 엔지니어링 팀에 문의하려면 다음 이메일을 보내 <a href="mailto:SQLDBArchitects@microsoft.com">SQLDBArchitects@microsoft.com</a>주세요.</p>
