### YamlMime:Yaml
ms.openlocfilehash: 6db7b6a1195ce5485f7dad927f5e5c62ed4a63d1
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139902586"
Slug: dynamic-manifest
Title: 동적 매니페스트를 사용하여 사용자 지정된 변환 및 자산 트리밍
Summary: 이 게시물에서는 Azure Media Services 동적 매니페스트(자산 필터) 알림 및 세부 정보를 검토합니다.
Content: >-
  NAB 기간 동안 지난 달 <a href="https://azure.microsoft.com/blog/2015/04/14/dynamic-manifests-and-rendered-sub-clips/" target="_blank">Jason의</a> 동적 매니페스트 기능 발표에 대한 후속 작업으로 이제 스트리밍 애플리케이션에서 사용할 수 있음을 발표하게 되어 기쁩니다. Jason의 게시물은 많은 일반적인 사용 시나리오를 다루었기 때문에 여기에서 주로 기술 구현 세부 사항에 초점을 맞출 것이기 때문에 동적 매니페스트에 대해 처음 읽는 경우 여기에서 시작하는 것이 좋습니다. 작동 방식에 대한 세부 정보로 들어가기 전에 다음 용어에 대한 몇 가지 배경을 제공하려고 합니다.

  <ul>
   <li><strong>ABR(HTTP)을 통한 적응 비트 전송률</strong>, 적응 비트 전송률 스트리밍은 원본 콘텐츠가 여러 비트 속도로 인코딩되고 작은 다중 초 부분으로 청크되는 HTTP를 통한 비디오 스트리밍 방법입니다. 스트리밍 클라이언트는 다양한 비트 속도로 사용 가능한 스트림과 매니페스트 파일을 통해 스트림 청크를 인식합니다. 다중 화면에 대한 구독자 수요를 충족하고 모든 네트워크에서 모든 디바이스에 비디오를 제공하기 위해 운영자는 Apple HLS, Microsoft Smooth, Adobe HDS 및 MPEG-DASH와 같은 다중 화면 구현에서 ABR(적응 비트 속도) 프로토콜을 사용합니다.</li>
   <li>"재생 목록"이라고도 하는 <strong>매니페스트</strong>입니다. 이 파일에는 품질, 오디오 언어 및 프레젠테이션 창과 같은 스트리밍 메타데이터가 포함되며 현재 사용 가능한 플레이어와 해당 위치의 다음 재생 가능한 조각도 제공합니다. 형식에 따라 특정 특성이 있는 텍스트 기반 또는 XML 파일입니다.아래에서 설명할 "자산 필터"를 사용하여 다음 속성 및 특성에 따라 동적 매니페스트를 만들 수 있습니다.
  <strong>•</strong> 트랙 유형 - 오디오, 비디오 또는 텍스트 <strong>• </strong>추적 이름 <strong>• </strong>시작 및 종료 시간 <strong>• </strong>프레젠테이션 창 - 고정 기간의 슬라이딩 윈도우, 라이브 위치에서 고정.

  <strong>• </strong> 비트 전송률(품질) <strong>• </strong>언어 추적 <strong>• </strong>FourCC<!--EndFragment--></li>
   <li><strong>조각/세그먼트</strong>, 비디오, 오디오 또는 텍스트 콘텐츠의 실제 청크입니다.</li>
  </ul>

  <h2>필터란?</h2>

  자산 필터는 출력 재생 목록(매니페스트)을 조작하는 방법을 스트리밍 엔드포인트(백 엔드 서비스)에 설명하는 매니페스트 특성 및 타임라인을 기반으로 하는 규칙의 조합입니다.

  <h2>필터 형식</h2>

  자산 필터에는 두 가지 유형이 있습니다. 전역 및 로컬(자산 수준). 두 필터 형식 모두 정확히 동일한 기능을 가지며 동일한 특성을 사용하여 필터를 정의합니다. 둘 사이의 주요 차이점은 적합한 시나리오와 저장되는 위치입니다.

  <ul>
   <li>전역 필터는 일반적으로 디바이스 프로필(추적 필터링)에 적합하지만 로컬 필터는 대부분 범위 필터(트리밍)에 선호됩니다. 대부분의 시간 트리밍은 자산에 따라 다릅니다.</li>
   <li>전역 필터는 계정 수준에 저장되며 생성될 때 계정 아래의 모든 자산에 적용할 수 있습니다. 로컬 필터는 자산당이며 생성되는 자산에만 사용할 수 있습니다. 로컬 필터의 수명은 자산 수명에 연결됩니다. 즉, 자산이 삭제되면 생성된 모든 로컬 필터도 삭제됩니다.</li>
  </ul>

  <h2>작동 원리</h2>

  필터는 여러 규칙으로 구성됩니다. 예를 들어 슬레이트 제거를 정의하고 라이브 재생 목록(매니페스트)에 백오프를 적용할 뿐만 아니라 조합에 대한 품질 제거를 포함할 수 있습니다. 여러 필터링 규칙의 경우 최종 결과는 규칙의 컴퍼지션(교차에만 해당)입니다.


  <img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="dynamic_manifest8" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/dynamic_manifest8.png" alt="dynamic_manifest8" width="500" height="210" border="0" />

  <h2>API를 통해 필터 만들기</h2>

  자산 필터 API는 Azure Media Service REST 버전 &gt;= 2.11에 사용할 수 있습니다. 이 릴리스에는 REST API만 포함되며 다음 주 동안 대상으로 하는 해당 .NET SDK가 진행 중입니다.

  AssetFilterhere" href="https://msdn.microsoft.com/en-us/library/azure/mt149053.aspx"></a>에서 <a title="Azure Media Services REST에 대한 자세한 정보를 찾을 수 있습니다.


  자산 필터는 두 개의 섹션(그룹)으로 구성됩니다. PresentationTimeRange 및 트랙.


  <strong>PresentationTimeRange:</strong>

  <table border="1" width="994" cellspacing="0" cellpadding="2">

  <tbody>

  <tr>

  <td valign="top" width="105"><strong>Attribute</strong></td>

  <td valign="top" width="410"><strong>설명</strong></td>

  <td valign="top" width="221"><strong>적용 대상</strong></td>

  <td valign="top" width="256"><strong>제약 조건</strong></td>

  </tr>

  <tr>

  <td valign="top" width="111">StartTimestamp</td>

  <td valign="top" width="407">이 타임스탬프 이후에 시작되는 미디어는 재생 목록(매니페스트)에 포함됩니다.</td>

  <td valign="top" width="220">라이브 및 VOD</td>

  <td valign="top" width="254">절대 시간. 가장 가까운 다음 GOP 시작으로 반올림된 값입니다.</td>

  </tr>

  <tr>

  <td valign="top" width="116">EndTimestamp</td>

  <td valign="top" width="405">이 타임스탬프 이전에 끝나는 미디어는 재생 목록(매니페스트)에 포함됩니다.</td>

  <td valign="top" width="219">VOD 라이브 프레젠테이션의 경우 자동으로 무시되며 프레젠테이션이 종료될 때 적용됩니다(Live2VOD).</td>

  <td valign="top" width="253">절대 시간. 가장 가까운 다음 GOP 시작으로 반올림된 값입니다.</td>

  </tr>

  <tr>

  <td valign="top" width="121">PresentationWindowDuration</td>

  <td valign="top" width="403">프레젠테이션의 라이브 가장자리 또는 끝에 있는 슬라이딩 윈도우를 정의합니다. 이 슬라이딩 윈도우 내의 미디어는 재생 목록(매니페스트)에 포함됩니다.</td>

  <td valign="top" width="218">라이브이지만 프레젠테이션이 종료되면 원활한 전환을 사용하도록 VOD에도 적용됩니다.</td>

  <td valign="top" width="252">최소 프레젠테이션 창 지속 기간은 120초입니다.</td>

  </tr>

  <tr>

  <td valign="top" width="125">LiveBackoffDuration</td>

  <td valign="top" width="401">라이브 프레젠테이션 백오프 또는 지연을 미디어에 적용합니다.</td>

  <td valign="top" width="217">라이브 전용이지만 프레젠테이션이 종료될 때 부드러운 전환을 사용하도록 VOD에 대해 자동으로 무시됩니다.</td>

  <td valign="top" width="251">최대 라이브 백오프 지속 기간은 60초입니다.</td>

  </tr>

  <tr>

  <td valign="top" width="128">시간 간격</td>

  <td valign="top" width="399">위에 지정된 타임스탬프 및 지속 기간에서 사용되는 시간 간격입니다. 기본 시간 간격은 10000000입니다.</td>

  <td valign="top" width="220">라이브 및 VOD</td>

  <td valign="top" width="256">기본값은 HNS(10000000)입니다.</td>

  </tr>

  </tbody>

  </table>

  <strong>트랙:</strong>

  <table border="1" width="999" cellspacing="0" cellpadding="2">

  <tbody>

  <tr>

  <td valign="top" width="190"><strong>속성</strong></td>

  <td valign="top" width="366"><strong>설명</strong></td>

  <td valign="top" width="205"><strong>적용 대상</strong></td>

  <td valign="top" width="235"><strong>제약 조건</strong></td>

  </tr>

  <tr>

  <td valign="top" width="190">형식</td>

  <td valign="top" width="366">트랙의 유형입니다. 값은 비디오, 오디오 또는 텍스트일 수 있습니다.</td>

  <td valign="top" width="205">라이브 및 VOD</td>

  <td valign="top" width="235">비디오, 오디오 또는 텍스트</td>

  </tr>

  <tr>

  <td valign="top" width="190">Name</td>

  <td valign="top" width="366">트랙의 이름</td>

  <td valign="top" width="205">라이브 및 VOD</td>

  <td valign="top" width="235"></td>

  </tr>

  <tr>

  <td valign="top" width="190">언어</td>

  <td valign="top" width="366">언어 추적</td>

  <td valign="top" width="205">라이브 및 VOD</td>

  <td valign="top" width="235">RFC 5646에 지정된 형식</td>

  </tr>

  <tr>

  <td valign="top" width="190">FourCC</td>

  <td valign="top" width="366">FourCC 값 추적</td>

  <td valign="top" width="205">라이브 및 VOD</td>

  <td valign="top" width="235">RFC 6381에 지정된 코덱 형식의 첫 번째 요소</td>

  </tr>

  <tr>

  <td valign="top" width="190">Bitrate</td>

  <td valign="top" width="366">트랙의 비트 전송률입니다.</td>

  <td valign="top" width="205">라이브 및 VOD</td>

  <td valign="top" width="235">범위 값 또는 정확한 값일 수 있습니다.</td>

  </tr>

  </tbody>

  </table>

  &nbsp;

  <blockquote><em><strong>참고:</strong> Azure Media Services <a href="https://azure.microsoft.com/en-us/documentation/articles/media-services-dynamic-packaging-overview/" target="_blank">동적 패키지는</a> 다중 비트 전송률 MP4 및 부드러운 스트리밍 파일에서 원본을 만들 수 있습니다. 동적 매니페스트(자산 필터)는 <a href="https://msdn.microsoft.com/en-us/library/ff436055(v=vs.90).aspx" target="_blank">부드러운 스트리밍 서버 및 클라이언트 매니페스트</a> 데이터를 필터링에 사용합니다. 또한 이 기능을 사용하려면 하나 이상의 <a href="https://azure.microsoft.com/en-us/documentation/articles/media-services-manage-origins/#scale_streaming_endpoints" target="_blank">스트리밍 단위</a>가 있어야 합니다.</em></blockquote>

  <strong>샘플 전역 필터 REST 요청:</strong>

  <pre class="prettyprint">&lt;?xml version="1.0" encoding="utf-8"?&gt;

  &lt;entry xmlns=https://www.w3.org/2005/Atom xmlns:d="" xmlns:m="/metadata" xmlns:georss="" xmlns:gml="https://www.opengis.net/gml"&gt;

  &lt;id /&gt;&lt;title /&gt;

  &lt;updated&gt;2015-04-03T20:50:34Z&lt;/updated&gt;

  &lt;author&gt;&lt;name /&gt;&lt;/author&gt;

  &lt;content type="application/xml"&gt;


  &lt;m:properties&gt;&lt;d:Name&gt;MyGlobalFilter&lt;/d:Name&gt;


  &lt;d:PresentationTimeRange&gt;

  &lt;d:EndTimestamp m:type="Edm.Int64"&gt;9223372036854775807&lt;/d:EndTimestamp&gt;

  &lt;d:LiveBackoffDuration m:type="Edm.Int64"&gt;0&lt;/d:LiveBackoffDuration&gt;

  &lt;d:PresentationWindowDuration m:type="Edm.Int64"&gt;800000000&lt;/d:PresentationWindowDuration&gt;

  &lt;d:StartTimestamp m:type="Edm.Int64"&gt;0&lt;/d:StartTimestamp&gt;

  &lt;d:Timescale m:type="Edm.Int64"&gt;10000000&lt;/d:Timescale&gt;

  &lt;/d:PresentationTimeRange&gt;


  &lt;d:Tracks /&gt;&lt;/m:properties&gt;


  &lt;/content&gt;

  &lt;/entry&gt;</pre>

  <strong>샘플 로컬(자산 수준) 필터 REST 요청:</strong>

  <pre class="prettyprint">&lt;?xml version="1.0" encoding="utf-8"?&gt;

  &lt;entry xmlns=https://www.w3.org/2005/Atom xmlns:d="" xmlns:m="/metadata" xmlns:georss="" xmlns:gml="https://www.opengis.net/gml"&gt;

  &lt;id /&gt;&lt;title /&gt;

  &lt;updated&gt;2015-04-03T20:53:34Z&lt;/updated&gt;

  &lt;author&gt;&lt;name /&gt;&lt;/author&gt;

  &lt;content type="application/xml"&gt;

  &lt;m:properties&gt;&lt;d:Id&gt;&lt;/d:Id&gt;


  &lt;d:Name&gt;MyLocalFilter&lt;/d:Name&gt;


  &lt;d:ParentAssetId&gt;nb:cid:UUID:fcef555d-1500-80c4-def5-f1e4d721ea68&lt;/d:ParentAssetId&gt;


  &lt;d:PresentationTimeRange&gt;


  &lt;d:EndTimestamp m:type="Edm.Int64"&gt;9223372036854775807&lt;/d:EndTimestamp&gt;

  &lt;d:LiveBackoffDuration m:type="Edm.Int64"&gt;300000000&lt;/d:LiveBackoffDuration&gt;

  &lt;d:PresentationWindowDuration m:type="Edm.Int64"&gt;3000000000&lt;/d:PresentationWindowDuration&gt;

  &lt;d:StartTimestamp m:type="Edm.Int64"&gt;400000&lt;/d:StartTimestamp&gt;

  &lt;d:Timescale m:type="Edm.Int64"&gt;10000000&lt;/d:Timescale&gt;


  &lt;/d:PresentationTimeRange&gt;


  &lt;d:Tracks&gt;


  &lt;d:element&gt;


  &lt;d:PropertyConditions&gt;


  &lt;d:element&gt;


  &lt;d:Operator&gt;Equal&lt;/d:Operator&gt;&lt;d:Property&gt;Type&lt;/d:Property&gt;&lt;d:Value&gt;audio&lt;/d:Value&gt;


  &lt;/d:element&gt;


  &lt;d:element&gt;


  &lt;d:Operator&gt;Equal&lt;/d:Operator&gt;&lt;d:Property&gt;Language&lt;/d:Property&gt;&lt;d:Value&gt;en&lt;/d:Value&gt;


  &lt;/d:element&gt;


  &lt;/d:PropertyConditions&gt;


  &lt;/d:element&gt;


  &lt;d:element&gt;


  &lt;d:PropertyConditions&gt;


  &lt;d:element&gt;


  &lt;d:Operator&gt;NotEqual&lt;/d:Operator&gt;&lt;d:Property&gt;Type&lt;/d:Property&gt;&lt;d:Value&gt;video&lt;/d:Value&gt;


  &lt;/d:element&gt;


  &lt;d:element&gt;


  &lt;d:Operator&gt;Equal&lt;/d:Operator&gt;&lt;d:Property&gt;Bitrate&lt;/d:Property&gt;&lt;d:Value&gt;0-2427000&lt;/d:Value&gt;


  &lt;/d:element&gt;


  &lt;/d:PropertyConditions&gt;


  &lt;/d:element&gt;


  &lt;/d:Tracks&gt;


  &lt;/m:properties&gt;


  &lt;/content&gt;&lt;/entry&gt;

  </pre>

  <pre class="prettyprint"></pre>

  &nbsp;


  필터를 만든 후에는 아래 예제와 같이 매니페스트 요청에 필터 매개 변수를 추가하여 필터 이름을 URL 요청에 추가하여 사용할 수 있습니다.


  <a href="(filter=MyLocalFilter)">(<span style="background-color: #ffff00;">filter=MyLocalFilter</span>)</a>


  동적 <a href="https://azure.microsoft.com/en-us/documentation/articles/media-services-dynamic-packaging-overview/" target="_blank">패키징</a> 및 <a href="https://msdn.microsoft.com/en-us/library/azure/dn783457.aspx" target="_blank">동적 암호화</a>와 함께 필터를 사용할 수도 있습니다. 예를 들어 위와 동일한 스트림에 대한 요청은 HLS v4 형식입니다.


  <a href="(format=m3u8-aapl,filter=MyLocalFilter)">(format=m3u8-aapl,filter<span style="background-color: #ffff00;">=MyLocalFilter</span>)</a>

  <blockquote><strong>참고:</strong> 전역 필터는 자산 스트리밍 URL에 필터 이름을 추가하여 동일한 미디어 서비스 계정의 모든 자산과 함께 사용할 수 있습니다. 로컬 필터는 연결된 자산에만 사용할 수 있습니다. 로컬 필터 자산 예제를 참조하세요. ("<span style="color: #ff0000; font-family: Consolas;">ParentAssetId</span>")</blockquote>

  <h2>백그라운드에서 발생하는 일</h2>

  스트리밍 엔드포인트에서 필터를 포함하는 요청을 받으면 원래 재생 목록(매니페스트)이 필터 규칙을 사용하여 처리되고 필터링된 재생 목록이 응답에서 제공됩니다. 여러 필터 규칙이 있는 경우 규칙 교차는 출력을 정의합니다. 프레젠테이션 범위(시간) 규칙은 GOP(그림 그룹- 키 프레임) 경계에서 실행되고 가장 가까운 다음 조각으로 반올림됩니다.

  예를 들면 다음과 같습니다.

  <img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="dynamic_manifest9" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/dynamic_manifest9.png" alt="dynamic_manifest9" width="640" height="327" border="0" />


  필터는 재생 목록(매니페스트) 요청에만 적용되고 실제 조각은 처리되지 않으므로 플레이어는 프록시 및 CDN에서 이미 캐시된 조각을 활용할 수 있습니다.

  다음은 원래 재생 목록(매니페스트)과 필터링된 재생 목록을 보여 주는 예제입니다. 프레젠테이션 범위 필터를 적용한 후


  <a href="https://acom.azurecomcdn.net/80C57D/blogmedia/blogmedia/2015/05/26/dynamic_manifest10.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="dynamic_manifest10" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/dynamic_manifest10_thumb.png" alt="dynamic_manifest10" width="640" height="482" border="0" /></a>


  위에서 볼 수 있듯이 출력 매니페스트에는 정의된 필터 시작 및 종료 시간 내의 세그먼트만 포함됩니다.

  <h2>알려진 문제 및 제한 사항</h2>

  <ul>
   <li>동적 매니페스트는 GOP 경계(키 프레임)에서 작동하므로 트리밍에는 GOP 정확도가 있습니다. 프레임 정확한 하위 클리핑을 원하는 경우 렌더링된 하위 클립 기능을 사용할 수 있습니다.</li>
   <li>로컬 및 전역 필터에 동일한 필터 이름을 사용할 수 있습니다. 이 경우 로컬 필터가 우선적으로 적용되고 전역 필터가 재정의됩니다.</li>
   <li>필터를 업데이트 하는 경우, 규칙을 새로 고치는 스트리밍 엔드포인트에서 최대 2분이 소요될 수 있습니다. 또한 콘텐츠가 이미 이전 필터와 함께 제공되고 프록시 및 CDN 캐시에 캐시된 경우 필터를 업데이트하면 플레이어 오류가 발생할 수 있습니다. 필터를 업데이트한 후 캐시를 제거하는 것이 좋습니다. 이 옵션을 사용할 수 없는 경우 다른 필터를 사용하는 것이 좋습니다.</li>
   <li>이 릴리스는 URL에 여러 필터를 결합하는 것을 지원하지 않습니다. 한 번에 하나의 필터만 적용할 수 있습니다.</li>
   <li>주문형 및 라이브 재생 목록 모두에 대해 "EndTimestamp" 규칙을 설정할 수 있습니다. 그러나 이 규칙은 프레젠테이션이 라이브 상태일 때 자동으로 무시되며 라이브 프레젠테이션이 주문형으로 변환될 때 존재합니다.</li>
   <li>"PresentationWindowDuration" 및 "LiveBackoffDuration" 규칙을 주문형 및 라이브 프레젠테이션으로 설정할 수 있습니다. 그러나 주문형 프레젠테이션의 경우 이 규칙은 자동으로 무시됩니다.</li>
  </ul>

  <h2>결론</h2>

  동적 매니페스트(자산 필터)는 사후 프로덕션의 번거로움 없이 동일한 자산의 여러 복사본을 보유하지 않고 다중 엔드 지점에 도달하는 데 도움이 되는 강력한 새 기능입니다. 몇 초 안에 여러 변환 및 보기를 만들 수 있습니다.


  나는 당신이 멋진 기능을 즐길 수 있기를 바랍니다! 기능 요청의 경우 또는 일반적인 피드백을 제공하기 위해 모든 것을 듣고 싶습니다. 아래의 의견 섹션을 사용하세요. 최대한 빨리 응답하겠습니다.
