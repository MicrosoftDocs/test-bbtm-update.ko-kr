### YamlMime:Yaml
ms.openlocfilehash: 47d8b4a5baca0243371121ca657411a57b3c4fcc
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905649"
Slug: azure-firewall-forced-tunneling-and-sql-fqdn-filtering-now-generally-available
Title: Azure Firewall 강제 터널링 및 SQL FQDN 필터링 이제 일반 공급
Summary: Azure Firewall의 두 가지 새로운 주요 기능인 강제 터널링 및 SQL FQDN 필터링이 이제 일반 공급됩니다. 또한 DNAT(대상 네트워크 주소 변환) 및 SNAT(원본 네트워크 주소 변환) 모두에 대해 여러 공용 IP 주소에 대한 제한을 100에서 250으로 늘렸습니다.
Content: >-
  <p>이제 Azure Firewallforced&mdash; 터널링 및 SQL FQDN&nbsp; 필터링&mdash;의 두 가지 새로운 주요 기능이 일반 공급됩니다. 또한 DNAT(대상 네트워크 주소 변환) 및 SNAT(원본 네트워크 주소 변환) 모두에 대해 여러 공용 IP 주소에 대한 제한을 100에서 250으로 늘렸습니다.</p>


  <p>Azure Firewall은 클라우드 네이티브 FWaaS(Firewall as a Service) 제품으로, DevOps 방법을 사용하여 모든 트래픽 흐름을 중앙에서 제어하고 기록할 수 있습니다. 이 서비스는 애플리케이션 및 네트워크 수준 필터링 규칙을 모두 지원하며 알려진 악성 IP 주소 및 도메인을 필터링하기 위해 Microsoft 위협 인텔리전스 피드와 통합됩니다. Azure Firewall은 기본 제공 자동 크기 조정을 통해 고가용성입니다.</p>


  <h2>강제 터널링 지원 이제 일반 공급</h2>


  <p>강제 터널링을 사용하면 Azure Firewall에서 온-프레미스 방화벽으로 모든 인터넷 바인딩된 트래픽을 리디렉션하거나 추가 검사를 위해 가까운 NVA(네트워크 가상 어플라이언스)에 연결할 수 있습니다. 새 방화벽을 만들 때 강제 터널링에 방화벽을 사용하도록 설정합니다. 현재는 기존 방화벽 배포를 강제 터널링 모드로 마이그레이션할 수 없습니다.</p>


  <p>강제 터널링을 지원하기 위해 서비스 관리 트래픽은 고객 트래픽과 구분됩니다. 자체 연결된 공용 IP 주소에는 AzureFirewallManagementSubnet이라는 추가 전용 서브넷이 필요합니다. 이 서브넷에서 허용되는 유일한 경로는 인터넷에 대한 기본 경로이며 BGP(Border Gateway Protocol) 경로 전파를 사용하지 않도록 설정해야 합니다.</p>


  <p>이 구성 내에서 AzureFirewallSubnet은 이제 인터넷에 전달되기 전에 트래픽을 처리하기 위해 온-프레미스 방화벽 또는 NVA에 대한 경로를 포함할 수&#39;. 이 서브넷에서 BGP 경로 전파를 사용하는 경우 BGP를 통해 AzureFirewallSubnet에 이러한 경로를 게시할 수도 있습니다.</p>


  <p><u><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7862737f-7fe6-4ce2-8c06-597c92988839.jpg"><img alt="VNnetFirewall in forced tunneling mode." border="0" height="369" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1db2f887-021c-400e-be73-9fffb77282fd.jpg" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="강제 터널링 모드의 VNnetFirewall입니다." width="1024"></a></u></p>


  <p align="center"><em>그림 1. 강제 터널링 모드의 Azure Firewall.</em></p>


  <h2>강제 터널링을 사용하여 SNAT 방지</h2>


  <p>Azure Firewall은 공용 IP 주소에 대한 모든 아웃바운드 트래픽에 자동 SNAT을 제공합니다. 대상 IP 주소가 <a href="https://tools.ietf.org/html/rfc1918" target="_blank">IANA RFC 1918</a>당 개인 IP 주소 범위인 경우 Azure Firewall은 SNAT를 수행하지 않습니다&rsquo;. 이 논리는 인터넷으로 직접 송신할 때 완벽하게 작동합니다. 그러나 강제 터널링을 사용하도록 설정하면 인터넷 바인딩된 트래픽이 AzureFirewallSubnet의 방화벽 개인 IP 주소 중 하나로 SNATed되고 온-프레미스 방화벽에서 원본이 숨겨집니다. 개인 IP 주소 범위로 0.0.0.0/&rdquo;0을 추가하여 &ldquo;대상 IP 주소에 관계없이 SNAT가 <b>되지 않도록</b> Azure Firewall을 구성할 수 있습니다. 이 구성을 사용하면 Azure Firewall이 인터넷에 직접 송신할 수 없습니다. 자세한 내용은 <a href="https://docs.microsoft.com/en-us/azure/firewall/snat-private-range" target="_blank">Azure Firewall SNAT 개인 IP 주소 범위</a>를 참조하세요.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2e667d43-7f40-4d61-ac90-efd4006810a1.jpg"><img alt="Azure Firewall configured to not SNAT regardless of the destination IP address by adding 0.0.0.0/0 as the private IP address range." border="0" height="617" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a6f156c0-4fa6-45de-80a6-681a8ee31860.jpg" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="Azure Firewall은 개인 IP 주소 범위로 0.0.0.0/0을 추가하여 대상 IP 주소에 관계없이 SNAT가 되지 않도록 구성했습니다." width="1024"></a></p>


  <p align="center"><em>그림 2. Azure Firewall은 SNAT 개인 IP 접두사 구성을 하지 않습니다&rsquo;.</em></p>


  <h2>공용 PaaS 및 Office 365 라우팅</h2>


  <p>Azure Firewall 강제 터널링을 사용하면 모든 인터넷 바인딩된 트래픽을 온-프레미스 방화벽 또는 인근 NVA로 보낼 수 있지만 항상 바람직하지는 않습니다. 예를 들어 퍼블릭 PaaS(Platform as a Service)로 송신하거나 직접 Office 365 것이 좋습니다. 특정 대상에 대해 다음 홉 유형 &ldquo;인터넷&rdquo;이 있는 AzureFirewallSubnet에 <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#custom-routes" target="_blank">UDR(사용자 정의 경로)</a>을 추가하여 이 작업을 수행할 수 있습니다. 이 정의는 기본 경로보다 더 구체적이므로 우선적으로 적용됩니다. <a href="https://www.microsoft.com/en-us/download/details.aspx?id=56519" target="_blank">Azure IP 범위 및 서비스 태그를 참조하세요</a>. 및 <a href="https://docs.microsoft.com/en-us/Office365/Enterprise/office-365-ip-web-service" target="_blank">자세한 내용은 IP 주소를 Office 365</a>.</p>


  <p>공용 PaaS로 직접 송신하는 다른 방법으로 AzureFirewallSubnet에서 <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-service-endpoints-overview" target="_blank">VNet(Virtual Network) 서비스 엔드포인트</a> 를 사용하도록 설정할 수 있습니다. 이러한 엔드포인트는 직접 연결을 통해 가상 네트워크 개인 주소 공간 및 ID를 Azure PaaS 서비스로 확장합니다. 사용하도록 설정하면 해당 PaaS 서비스에 대한 특정 경로가 자동으로 만들어집니다. 서비스 엔드포인트를 사용하면 중요한 Azure 서비스 리소스를 VNet에만 보호할 수 있습니다. VNet에서 Azure 서비스에 대한 트래픽은 Microsoft Azure 백본 네트워크에 항상 유지됩니다.</p>


  <p>이 구성을 사용하면 앞에서 설명한 대로 개인 IP 접두사로 0.0.0.0/0&rdquo;을 추가할 &ldquo;수 없지만 SNATed되지 않는 사용자 지정 범위를 계속 추가할 수 있습니다.</p>


  <p>마지막으로 <a href="https://docs.microsoft.com/en-us/azure/private-link/private-endpoint-overview" target="_blank">Azure 프라이빗 엔드포인트를 사용하여 Azure Private</a> Link를 통해 구동되는 퍼블릭 PaaS 서비스에 비공개 및 안전하게 연결할 수도 있습니다. 그러나 이러한 연결은 이 <a href="https://docs.microsoft.com/en-us/azure/private-link/private-endpoint-overview#limitations" target="_blank">설명서</a>에 설명된 대로 Azure Firewall에 대한 기본 경로를 무시합니다. 방화벽을 통해 이동하는 모든 트래픽이 필요한 경우 프라이빗 엔드포인트 IP 주소와 /32 접미사를 대상으로, Azure Firewall을 다음 홉으로 사용하여 모든 클라이언트 서브넷에 UDR을 추가하여 완화할 수 있습니다. 이 구성이 작동하고 프라이빗 엔드포인트에서 반환된 트래픽이 방화벽을 통해 이동하려면 개인 <a href="https://docs.microsoft.com/en-us/azure/firewall/snat-private-range" target="_blank">IP 주소 범위</a>로 255.255.255.255/32를 사용하여 항상 SNAT를 사용해야 합니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e4f051dd-efe3-46e6-996f-25d0ed667259.jpg"><img alt="A UDR added to a Storage Private Endpoint pointing to the firewall as a next hop to require all traffic to go via the firewall." border="0" height="439" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/358d9ef1-c01c-491f-aecc-8bfa7ea1c8aa.jpg" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="방화벽을 가리키는 Storage 프라이빗 엔드포인트에 모든 트래픽이 방화벽을 통과하도록 요구하는 다음 홉으로 추가된 UDR입니다." width="1024"></a></p>


  <p align="center"><em>그림 3. 방화벽을 다음 홉으로 가리키는 Storage 프라이빗 엔드포인트에 대한 UDR입니다.</em></p>


  <h2>SQL FQDN 필터링 이제 일반 공급</h2>


  <p>이제 <a href="https://aka.ms/sqlazfw" target="_blank">Azure Firewall 애플리케이션 규칙에서 SQL FQDN을</a> 구성할 수 있습니다. 이렇게 하면 VNet에서 지정된 SQL Server 인스턴스로만 액세스를 제한할 수 있습니다. VNet에서 Azure SQL Database, Azure SQL Data Warehouse, Azure SQL Managed Instance 또는 VNet에 배포된 SQL IaaS 인스턴스로 트래픽을 필터링할 수 있습니다.</p>


  <p>SQL FQDN 필터링은 현재 <a href="https://docs.microsoft.com/azure/sql-database/sql-database-connectivity-architecture#connection-policy" target="_blank">프록시 모드</a>에서만 지원됩니다(포트 1433). SQL IaaS(Infrastructure as a Service) 트래픽에 기본이 아닌 포트를 사용하는 경우 방화벽 애플리케이션 규칙에서 해당 포트를 구성할 수 있습니다.</p>


  <p>기본 리디렉션 모드에서 SQL 사용하는 경우 <a href="https://docs.microsoft.com/en-us/azure/firewall/overview#network-traffic-filtering-rules" target="_blank">네트워크 규칙</a>의 일부로 SQL 서비스 태그를 사용하여 액세스를 필터링할 수 있습니다. 애플리케이션 규칙에 리디렉션 모드 지원을 추가하는 것은 로드맵에 있습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/46717eb3-74f9-4f5a-a262-4708e24fc101.png"><img alt="Azure Firewall application rules for SQL FQDN filtering." border="0" height="602" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7030b58d-68ea-44e6-89f0-9a4c18cd0db8.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="SQL FQDN 필터링에 대한 Azure Firewall 애플리케이션 규칙입니다." width="1024"></a></p>


  <p align="center"><em>그림 4. Azure Firewall 애플리케이션 규칙에서 FQDN 필터링을 SQL.</em></p>


  <h2>여러 공용 IP 주소 제한 증가</h2>


  <p>이제 DNAT 및 SNAT 모두에 대해 Azure Firewall에서 최대 250개의 공용 IP 주소를 사용할 수 있습니다.</p>


  <ul>
      <li><b>DNAT</b>&mdash; 여러 표준 포트 인스턴스를 백 엔드 서버로 변환할 수 있습니다. 예를 들어 공용 IP 주소가 2개인 경우 두 IP 주소 모두에 대해 TCP 포트 3389(RDP)를 변환할 수 있습니다.</li>
      <li><b>SNAT</b>&mdash; 아웃바운드 SNAT 연결에 추가 포트를 사용할 수 있으므로 SNAT 포트 소모 가능성이 줄어듭니다. 현재 Azure Firewall은 연결에 사용할 원본 공용 IP 주소를 임의로 선택합니다. 네트워크에 다운스트림 필터링이 있는 경우, 방화벽과 연결된 모든 공용 IP 주소를 허용해야 합니다. <a href="https://docs.microsoft.com/en-us/azure/virtual-network/public-ip-address-prefix" target="_blank">공용 IP 주소 접두사</a>를 사용하여 이 구성을 단순화하세요.</li>
  </ul>


  <p>자세한 내용은 <a href="https://docs.microsoft.com/en-us/azure/firewall/deploy-multi-public-ip-powershell" target="_blank">여러 공용 IP 주소를 사용하여 Azure Firewall 배포를 참조하세요</a>.</p>


  <h2>다음 단계</h2>


  <p>여기서 다루는 모든 항목에 대한 자세한 내용은 다음을 참조하세요.</p>


  <h3>&nbsp;</h3>


  <ul>
      <li><a href="https://docs.microsoft.com/en-us/azure/firewall/" target="_blank">Azure Firewall 설명서</a></li>
      <li><a href="https://docs.microsoft.com/en-us/azure/firewall/forced-tunneling" target="_blank">Azure Firewall 강제 터널링</a></li>
      <li><a href="https://docs.microsoft.com/en-us/azure/firewall/sql-fqdn-filtering" target="_blank">Azure Firewall을 사용하여 FQDN 필터링 SQL</a></li>
      <li><a href="https://docs.microsoft.com/en-us/azure/firewall/overview#multiple-public-ip-addresses" target="_blank">Azure Firewallmultiple&ndash; 공용 IP 주소</a></li>
      <li><a href="https://docs.microsoft.com/en-us/azure/firewall-manager/overview" target="_blank">Azure Firewall Manager 미리 보기란?</a></li>
      <li><a href="https://nam04.safelinks.protection.outlook.com/?url=https%3A%2F%2Fazure.microsoft.com%2Fen-us%2Fblog%2Fuse-azure-firewall-for-secure-and-cost-effective-windows-virtual-desktop-protection%2F&amp;data=01%7C01%7Cliz.wolk%40rationalcx.com%7C5685b1f15a0a4c10575008d802779f07%7C03f0126b518e456cbac9346c34f95bd9%7C1&amp;sdata=ac5yGzTiNpKEdbpTuxzxYijYdXwjWwQlDls0WA%2B9qiA%3D&amp;reserved=0">안전하고 비용 효율적인 Windows Virtual Desktop 보호를 위해 Azure Firewall 사용</a></li>
  </ul>
