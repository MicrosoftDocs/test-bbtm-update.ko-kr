### YamlMime:Yaml
ms.openlocfilehash: 39231d438c860a585caa3473b9f5f2ad4382f8f3
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905267"
Slug: upload-files-from-devices-with-azure-iot-hub
Title: Azure IoT Hub를 사용하여 디바이스에서 파일 업로드
Summary: 오늘 Azure IoT Hub에서 사용자가 IoT Hub의 도움을 받아 디바이스에서 클라우드로 파일을 업로드할 수 있는 새로운 기능을 발표하게 되어 기쁩니다.
Content: >-
  <p>오늘 Azure IoT Hub에서 사용자가 IoT Hub의 도움을 받아 디바이스에서 클라우드로 파일을 업로드할 수 있는 새로운 기능을 발표하게 되어 기쁩니다. 이는 특히 원격 분석 채널을 통해 전송하기에는 너무 큰 파일을 생성하는 기존 시스템을 사용하는 고객으로부터 고객으로부터 들은 가장 일반적인 기능&rsquo; 중 하나입니다.</p>


  <p>IoT Hub를 통해 메시지를 조정하는 대신 IoT Hub는 디스패처 역할을 합니다. 디바이스는 업로드하려는 디바이스&nbsp; 파일과 관련된 IoT Hub에서 스토리지 토큰을&nbsp; 요청합니다. IoT Hub는 짧은 만료 시간(1일)을 사용하여 범위가 지정된 SAS URI를 디바이스에 반환합니다. Storage SAS URI는 매우 긴 만료 시간을 가질 수 있지만, 이 경우 디바이스가 손상될 경우 스토리지에 대한 보안 위험을 제한하기 위해 만료 시간이 의도적으로 짧게 유지됩니다. 디바이스는 SAS URI를 사용하여 파일을 스토리지에 업로드하고 업로드가 완료되면 디바이스가 완료 알림을 IoT Hub에 보냅니다. IoT Hub는 파일이 업로드되었는지 확인한 다음 새 서비스 쪽 파일 알림 메시지 엔드포인트에 파일 업로드 알림을 추가합니다. IoT Hub는 진행 중인 모든 파일 업로드 요청을 추적하고 허브가 디바이스에서 업로드 알림을 받기 전에 SAS URI가 만료될 때 오류를 기록할 수 있습니다. IoT Hub에 SAS URI를 요청하고 완료된 파일 업로드 횟수를 메시지 제한에 맞게 허브에 알리기 위해 전송된 메시지는 그에 따라 청구됩니다.</p>


  <p>IoT Hub 디바이스 클라이언트 SDK(<a href="https://github.com/Azure/azure-iot-sdks">https://github.com/Azure/azure-iot-sdks</a>)를 사용하는 경우 이 모든 것이 정말 간단합니다. 스토리지 계정을 IoT Hub와 연결한 후에는 파일을 업로드하기 위해 디바이스에서 새 UploadFromStringAsync API를 호출하기만 하면&rsquo; 됩니다. 업로드가 완료되면&rsquo; IoT Hub에 대한 파일 업로드 알림을 수신하도록 선택한 경우&rsquo; 새 {iot hub}.azure-devices.net/messages/servicebound/filenotifications 엔드포인트에서 알림을 받게 됩니다.</p>


  <p>IoT Hub 디바이스 클라이언트 SDK를 사용하지 않더라&rsquo;도 IoT Hub를 사용하여 파일을 업로드할 수 있습니다&rsquo;. IoT Hub에는 파일 업로드를 지원하는 두 개의 새로운 REST 엔드포인트가 있습니다. 하나는 스토리지에 대한 SAS URI를 가져오는 것이고 다른 하나는 완료된 업로드를 IoT Hub에 알립니다. 디바이스는 {iot hub}.azure-devices.net/devices/{deviceId}/files/{filename}의 IoT Hub에 GET을 전송하여 파일 업로드 프로세스를 시작합니다. 허브는 업로드할 파일과 관련된 SAS URI와 업로드가 완료되면 사용할 상관 관계 ID를 반환합니다. 디바이스는 Azure Storage SDK를 사용하여 스토리지에 파일을 업로드하는 일을 담당합니다. 업로드가 완료되면 디바이스는 초기 GET에서 받은 상관 관계 ID를 사용하여 {iot hub}.azure-devices.net/devices/{deviceId}/messages/files/notifications/{correlationId}의 IoT Hub에 POST를 보냅니다.</p>


  <p>이 기능을 사용할 때 고객이 솔루션을 디버그할 수 있도록 IoT Hubs&rsquo; 작업 모니터링을 새 &ldquo;파일 업로드&rdquo; 범주로 업데이트했습니다. 새 범주는 IoT Hub와 통신하는 동안 발생하는 오류(예:</p>


  <ul>
      <li>디바이스가 허브에 파일 업로드 실패를 알 수 있습니다.</li>
      <li>디바이스가 완료된 업로드의 허브에 알리기 전에 SAS URI가 만료됨</li>
      <li>IoT Hub 알림 메시지를 만드는 동안 스토리지에서 파일을 찾을 수 없습니다.</li>
      <li>IoT Hub가 연결된 스토리지 계정에서 SAS URI를 만들지 못했습니다(예: 불완전한 키 롤오버).</li>
  </ul>


  <p>파일 업로드를 사용하면 이전에 고객이 클라우드에 파일을 가져오기 위해 많은 사용자 지정 코드를 작성하도록 요구했던 IoT 솔루션을 사용할 수 있습니다. 더 쉬운 업로드 환경 외에도 IoT Hub는 완료된 파일 업로드에 대한 알림과 디버그에 도움이 되는 새로운 작업 모니터링 범주를 제공합니다. 이제 <a href="https://azure.microsoft.com/en-us/documentation/articles/iot-hub-devguide/">설명서</a> 에는 IoT 솔루션에서 파일 업로드를 사용하는 방법에 대한 세부 정보가 포함되어 있으므로 IoT Hub를 사용하여 파일을 업로드합니다.</p>
