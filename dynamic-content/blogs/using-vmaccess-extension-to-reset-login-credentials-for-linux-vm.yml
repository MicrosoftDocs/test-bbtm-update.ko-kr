### YamlMime:Yaml
ms.openlocfilehash: 9dea91dbca3454e04f48886ec1d25f2b457033f9
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139902917"
Slug: using-vmaccess-extension-to-reset-login-credentials-for-linux-vm
Title: VMAccess 확장을 사용하여 로그인 자격 증명 다시 설정, 새 사용자 추가 및 Linux VM용 SSH 키 추가
Summary: VMAccess 확장을 사용하면 암호, SSH 키 또는 SSH 구성을 다시 설정하여 액세스 권한을 다시 얻을 수 있습니다.
Content: "<p><span style=\"font-size: small;\">Azure VM 암호 또는 SSH 키를 잊어버렸고 액세스 권한이 손실된 적이 있나요? VMAccess 확장을 사용하면 암호, SSH 키 또는 SSH 구성을 다시 설정하여 VM에 대한 액세스 권한을 다시 얻을 수 있습니다. 암호 또는 SSH 키를 사용하여 새 사용자를 추가하거나 이 확장을 사용하여 사용자를 삭제할 수도 있습니다.</span> <span style=\"font-size: small;\">이 확장은 Linux VM을 대상으로 합니다. Windows VM</span>의 경우 여기<span style=\"font-size: small;\">를 클릭하여 자세한 내용을 </span> 확인하세요. <span style=\"font-size: small;\">VM 확장을 처음 사용하는 경우 </span><a href=\"https://azure.microsoft.com/blog/2014/04/11/vm-agent-and-extensions-part-1/\"><span style=\"font-size: small;\">여기에서</span></a><span style=\"font-size: small;\"> 몇 가지 배경 정보를</span> 확인할 수 있습니다.</p>\n\n<p><span style=\"font-size: x-large;\">필수 구성 요소</span></p>\n\n<ul>\n <li><span style=\"font-size: small;\">Linux 에이전트 버전 2.0.6 이상을 Microsoft Azure. 대부분의 Azure VM Linux 갤러리 이미지에는 위의 버전 2.0.6이 포함되어 있습니다. <b>waagent -version</b>을 실행하여 VM에 설치된 버전을 확인할 수 있습니다. VM이 2.0.6 이전 버전을 실행하는 경우 다음 </span><a href=\"https://github.com/Azure/WALinuxAgent\"><span style=\"font-size: small;\">지침에</span></a> 따라 <span style=\"font-size: small;\"> 업데이트할</span> 수 있습니다.</li>\n <li><span style=\"font-size: small;\">&nbsp;</span><a href=\"https://azure.microsoft.com/en-us/documentation/articles/xplat-cli/\"><span style=\"font-size: small;\">플랫폼 간 CLI</span></a>&nbsp; 또는 <a href=\"https://azure.microsoft.com/en-us/downloads/\"><span style=\"font-size: small;\">Azure PowerShell</span></a>.</li>\n <li><span style=\"font-size: small;\">다시 설정하거나 <b>사용자 VM</b> 에 대한 새 사용자와 함께 추가하려는 새 암호 또는 SSH 키입니다.</span></li>\n</ul>\n\n<p><strong>2015년 12월 업데이트:</strong><br />\nLinux용 VMAccess 확장은 이제 Azure Resource Manager 모델을 지원하고 있습니다. ARM 모델에서 Linux용 VMAccess 확장을 실행하는 샘플 Powershell 및 CLI 스크립트의 경우 TheGithubrelease&nbsp; documenthere&nbsp;를 참조&nbsp;하세요.<a href=\"https://github.com/Azure/azure-linux-extensions/blob/master/VMAccess/README.md\">https://github.com/Azure/azure-linux-extensions/blob/master/VMAccess/README.md</a></p>\n\n<p>&nbsp;</p>\n\n<p><span style=\"font-size: x-large;\">Xplat CLI를 통해 VMAccess 확장 사용</span></p>\n\n<p>컴퓨터에 플랫폼 간 CLI 환경을 설정하려면 <a href=\"https://azure.microsoft.com/en-us/documentation/articles/xplat-cli/\"><span style=\"font-size: small;\">이 지침을</span></a> <span style=\"font-size: small;\">따르세요 </span><span style=\"font-size: small;\"> . xplat-cli가 설치되면 명령줄 인터페이스(Bash, 터미널, 명령 프롬프트)의 <b>azure</b> 명령을 사용하여 xplat-cli 명령에 액세스할 수 있습니다. 예를 들어 azure vm 확장 집합을 실행&lsquo;합니다. 자세한 확장 사용에 대한 도움말&rsquo;입니다. VMAccess를 사용하여 VM에 대한 액세스 권한을 얻을 수 있는 6개의 시나리오가 있습니다. 시나리오 및 해당 샘플 스크립트는 다음과 같습니다.</span></p>\n\n<p><span style=\"font-size: large;\">1. 암호 재설정 </span></p>\n\n<p><span style=\"font-size: small;\"><b>1단계:</b> 다음 콘텐츠를 사용하여 PrivateConf.json이라는 파일을 만듭니다.</span></p>\n\n<pre class=\"prettyprint\">\n{\n&quot;username&quot;:&quot;currentusername&quot;,\n&quot;password&quot;:&quot;newpassword&quot;,\n&quot;expiration&quot;:&quot;2016-01-01&quot;\n}</pre>\n\n<p><span style=\"font-size: small;\"><b>2단계</b>: azure vm 확장 집합 vmname VMAccessForLinux Microsoft.OSTCExtensions 1.* --private-config-path PrivateConf.json 실행 &lsquo;&rsquo;</span></p>\n\n<p><span style=\"font-size: large;\">2. SSH 키 다시 설정</span></p>\n\n<p><span style=\"font-size: small;\"><b>1단계</b>: 다음 콘텐츠를 사용하여 PrivateConf.json이라는 파일을 만듭니다.</span></p>\n\n<pre class=\"prettyprint\">\n  { \n  &quot;username&quot;:&quot;currentusername&quot;, \n  &quot;ssh_key&quot;:&quot;contentofsshkey&quot;,   \n   }</pre>\n\n<p><span style=\"font-size: small;\"><b>2단계</b>: azure vm 확장 집합 vmname VMAccessForLinux Microsoft.OSTCExtensions 1.* --private-config-path PrivateConf.json 실행 &lsquo;&rsquo;</span></p>\n\n<p><span style=\"font-size: large;\">3. 암호 및 SSH 키 다시 설정</span></p>\n\n<p><b>1단계:</b> 다음 콘텐츠를 사용하여 PrivateConf.json이라는 파일을 만듭니다.</p>\n\n<pre class=\"prettyprint\">\n{\n&quot;username&quot;:&quot;currentusername&quot;,\n&quot;ssh_key&quot;:&quot;contentofsshkey&quot;,\n&quot;password&quot;:&quot;newpassword&quot;,\n}</pre>\n\n<p><b>2단계:</b> azure vm extension set vmname VMAccessForLinux Microsoft.OSTCExtensions 1.* --private-config-path PrivateConf.json 실행 &lsquo;&rsquo;</p>\n\n<p><span style=\"font-size: large;\">4. 새 sudo 사용자 계정 만들기</span></p>\n\n<p><span style=\"font-size: small;\">사용자 이름을 잊어버린 경우 VMAccess를 사용하여 sudo 기관을 사용하여 새 이름을 만들 수 있습니다. 이 경우 기존 사용자 이름 및 자격 증명은 수정되지 않습니다.</span> <span style=\"font-size: small;\">암호 액세스 권한이 있는 새 sudo 사용자를 만들려면 시나리오 1에서 스크립트를 사용합니다. SSH 키 액세스 권한이 있는 새 sudo 사용자를 만들려면 시나리오 2에서 스크립트를 사용합니다. 시나리오 3을 사용하여 암호 및 키 액세스 권한이 있는 새 사용자를 만들 수도 있습니다. UserName&rdquo; 필드의 &ldquo;경우 새 사용자 이름을 입력해야 합니다.</span></p>\n\n<p><span style=\"font-size: large;\">5. SSH 구성 다시 설정</span></p>\n\n<p><span style=\"font-size: small;\">SSH 구성이 원치 않는 상태인 경우 VM에 대한 액세스 권한이 손실될 수도 있습니다. VMAccess 확장을 사용하여 구성을 기본값으로 다시 설정할 수 있습니다. 이렇게 하려면 reset_ssh&rdquo; 키를 True&rdquo;로 설정&ldquo;하기&ldquo;만 하면 됩니다. 확장은 SSH 서버를 다시 시작하고, VM에서 SSH 포트를 열고, SSH 구성을 기본값으로 다시 설정합니다. 사용자 계정(이름, 암호 또는 SSH 키)은 변경되지 않습니다. </span> <span style=\"font-size: small;\">참고: 다시 설정되는 SSH 구성 파일은 /etc/ssh/sshd_config 있습니다.</span></p>\n\n<p><span style=\"font-size: small;\"><b>1단계: </b> 다음 콘텐츠를 사용하여 PrivateConf.json이라는 파일을 만듭니다.</span></p>\n\n<pre class=\"prettyprint\">\n{\n&quot;reset_ssh&quot;:&quot;True&quot;,\n}</pre>\n\n<p><span style=\"font-size: small;\"><b>2단계:</b> azure vm extension set vmname VMAccessForLinux Microsoft.OSTCExtensions 1.* --private-config-path PrivateConf.json 실행 &lsquo;&rsquo;</span></p>\n\n<p><span style=\"font-size: large;\">6. 기존 사용자 제거</span></p>\n\n<p><span style=\"font-size: small;\">VM에 직접 로그인하지 않고 사용자 계정을 삭제하려는 경우 다음 스크립트를 활용할 수 있습니다.</span></p>\n\n<p><span style=\"font-size: small;\"><b>1단계: </b> 다음 콘텐츠를 사용하여 PrivateConf.json이라는 파일을 만듭니다.</span></p>\n\n<pre class=\"prettyprint\">\n{\n&quot;remove_user&quot;:&quot;usertoberemoveed&quot;,\n}</pre>\n\n<p><span style=\"font-size: small;\"><b>2단계: </b>azure vm 확장 집합 vmname VMAccessForLinux Microsoft.OSTCExtensions 1.* --private-config-path PrivateConf.json&rsquo; 실행 &lsquo;</span> &nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><span style=\"font-size: x-large;\">PowerShell을 통해 VMAccess 확장 사용</span></p>\n\n<p><span style=\"font-size: small;\">VMAccess를 사용하여 VM에 대한 액세스 권한을 얻을 수 있는 6개의 시나리오가 있습니다. 다음은 시나리오 및 해당 샘플 PowerShell 스크립트입니다. 각 시나리오에 대해 서로 다른 매개 변수를 지정하기만 하면 됩니다. Begin 실행&rdquo; 후&ldquo;의 섹션은 아래 시나리오와 관계없이 동일합니다.</span></p>\n\n<p><span style=\"font-size: large;\">1. 암호 재설정 </span></p>\n\n<pre class=\"prettyprint\">\n$vm = Get-AzureVM -ServiceName &#39;MyServiceName&#39; -Name &#39;MyVMName&#39;\n#Enter your current user name and new password\n$UserName = &quot;MyCurrentUserName&quot;\n$Password = &quot;MyNewPassWord&quot;\n[hashtable]$Param=@{};\n$Param[&#39;username&#39;] = $UserName;\n$Param[&#39;password&#39;] = $Password;\n$Param[&#39;expiration&#39;] = &#39;2016-01-01&#39;;\n$PrivateConfig = ConvertTo-Json $Param;\n#Begin execution\n$ExtensionName = &#39;VMAccessForLinux&#39;\n$Publisher = &#39;Microsoft.OSTCExtensions&#39;\n$Version = &#39;1.*&#39;\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM \n</pre>\n\n<p>&nbsp;<span style=\"font-size: large;\">2. SSH 키 다시 설정</span></p>\n\n<pre class=\"prettyprint\">\n#Sample script for you to reset your SSH keys \n#Identify the VM \n$vm = Get-AzureVM -ServiceName &#39;MyServiceName&#39; -Name &#39;MyVMName&#39; \n#Enter the current user name and the path of your new public SSH key \n$UserName = &quot;CurrentName&quot; \n$cert = Get-Content &quot;CertPath&quot; \n$PrivateConfig = &#39;{&quot;username&quot;:&quot;&#39; + $UserName + &#39;&quot;, &quot;ssh_key&quot;:&quot;&#39; + $cert + &#39;&quot;}&#39;  \n# Begin execution \n$ExtensionName = &#39;VMAccessForLinux&#39; \n$Publisher = &#39;Microsoft.OSTCExtensions&#39; \n$Version =  &#39;1.X&#39; \nSet-AzureVMExtension -ExtensionName $ExtensionName -VM  $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</pre>\n\n<p><span style=\"font-size: large;\">3. 암호 및 SSH 키 다시 설정</span></p>\n\n<pre class=\"prettyprint\">\n#Sample script to reset your password and SSH key\n#Identify the VM\n$vm = Get-AzureVM -ServiceName &#39;MyServiceName&#39; -Name &#39;MyVMName&#39;\n#Enter the new password, and cert path of the new SSH public key, with the current user name\n$UserName = &quot;CurrentName&quot;\n$Password = &quot;NewPassword&quot;\n$cert = Get-Content &quot;CertPath&quot;\n$PrivateConfig = &#39;{&quot;username&quot;:&quot;&#39; + $UserName + &#39;&quot;, &quot;password&quot;: &quot;&#39; + $Password + &#39;&quot;, &quot;ssh_key&quot;:&quot;&#39; + $cert + &#39;&quot;}&#39;\n# Begin execution\n$ExtensionName = &#39;VMAccessForLinux&#39;\n$Publisher = &#39;Microsoft.OSTCExtensions&#39;\n$Version = &#39;1.*&#39;\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</pre>\n\n<p><span style=\"font-size: large;\">4. 새 sudo 사용자 계정 만들기</span></p>\n\n<p><span style=\"font-size: small;\">사용자 이름을 잊어버린 경우 VMAccess를 사용하여 sudo 기관을 사용하여 새 이름을 만들 수 있습니다. 이 경우 기존 사용자 이름 및 자격 증명은 수정되지 않습니다.</span> <span style=\"font-size: small;\">암호 액세스 권한이 있는 새 sudo 사용자를 만들려면 시나리오 1에서 스크립트를 사용합니다. SSH 키 액세스 권한이 있는 새 sudo 사용자를 만들려면 시나리오 2에서 스크립트를 사용합니다. 시나리오 3을 사용하여 암호 및 키 액세스 권한이 있는 새 사용자를 만들 수도 있습니다. UserName&rdquo; 필드에는&ldquo; 새 사용자 이름을 입력해야 합니다.</span></p>\n\n<p><span style=\"font-size: large;\">5. SSH 구성 다시 설정</span></p>\n\n<p><span style=\"font-size: small;\">SSH 구성이 원치 않는 상태인 경우 VM에 대한 액세스 권한이 손실될 수도 있습니다. VMAccess 확장을 사용하여 구성을 기본값으로 다시 설정할 수 있습니다. 이렇게 하려면 reset_ssh&rdquo; 키를 True&rdquo;로 설정&ldquo;하기&ldquo;만 하면 됩니다. 확장은 SSH 서버를 다시 시작하고, VM에서 SSH 포트를 열고, SSH 구성을 기본값으로 다시 설정합니다. 사용자 계정(이름, 암호 또는 SSH 키)은 변경되지 않습니다. </span> <span style=\"font-size: small;\">참고: 다시 설정되는 SSH 구성 파일은 /etc/ssh/sshd_config 있습니다.</span></p>\n\n<pre class=\"prettyprint\">\n#Sample script to reset the SSH configuration on your VM \n#Identify the VM\n$vm = Get-AzureVM -ServiceName &#39;MyServiceName&#39; -Name &#39;MyVMName&#39;\n$PrivateConfig = &#39;{&quot;reset_ssh&quot;: &quot;True&quot;}&#39;\n# Begin execution\n$ExtensionName = &#39;VMAccessForLinux&#39;\n$Publisher = &#39;Microsoft.OSTCExtensions&#39;\n$Version = &#39;1.*&#39;\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</pre>\n\n<p><span style=\"font-size: large;\">6. 기존 사용자 제거</span></p>\n\n<p><span style=\"font-size: small;\">VM에 직접 로그인하지 않고 사용자 계정을 삭제하려는 경우 다음 스크립트를 활용할 수 있습니다.</span></p>\n\n<pre class=\"prettyprint\">\n#Sample script to delete the a user account \n#Identify the VM\n$vm = Get-AzureVM -ServiceName &#39;MyServiceName&#39; -Name &#39;MyVMName&#39;\n#Identify the user account you want to delete\n$UserName = &quot;SomeUser&quot;\n$PrivateConfig = &#39;{&quot;remove_user&quot;: &quot;&#39; + $UserName + &#39;&quot;}&#39;\n# Begin execution\n$ExtensionName = &#39;VMAccessForLinux&#39;\n$Publisher = &#39;Microsoft.OSTCExtensions&#39;\n$Version = &#39;1.*&#39;\nSet-AzureVMExtension -ExtensionName $ExtensionName -VM $vm -Publisher $Publisher -Version $Version -PrivateConfiguration $PrivateConfig | Update-AzureVM</pre>\n\n<p>&nbsp;</p>\n\n<p><span style=\"font-size: x-large;\">결과 쿼리</span></p>\n\n<p><span style=\"font-size: small;\"><span style=\"font-size: small;\">xplat 명령 &lsquo;azure vm 확장 get&rsquo; 또는&nbsp;</span>PowerShell cmdlet Get-AzureVM, Get-Deployment를 사용하여 VMAccess 확장의 상태를 검색할 수 있습니다.</span></p>\n\n<p><span style=\"font-size: x-large;\">다시 설정 후 VM에 액세스</span></p>\n\n<p><span style=\"font-size: small;\">VMAccess 확장이 완료되면 새 계정 이름, 암호 또는 SSH 키를 사용하여 인스턴스에 로그온할 수 있습니다.</span></p>\n\n<p><span style=\"font-size: x-large;\">추가 참고 사항</span></p>\n\n<p><span style=\"font-size: small;\">기존 사용자 계정의 암호 또는 SSH 키만 다시 설정하려면 입력한 사용자 이름이 원래 사용자 이름과 일치하는지 확인해야 합니다. 원래 이름과 다른 이름을 입력하면 VMAccess 확장에서 이를 새 사용자&rdquo; 만들기 시나리오로 &ldquo;처리하고 지정된 암호 또는 키를 사용하여 새 사용자 계정을 만듭니다.</span></p>\n\n<p><span style=\"font-size: x-large;\">알려진 문제</span></p>\n\n<p><span style=\"font-size: small;\">PowerShell 명령을 &ldquo; 실행하는 경우 Linux VM에서 Set-AzureVMExtension&rdquo; 을 사용하면 다음과 같은 오류가 발생할 수 있습니다. &quot;IaaS VM 액세스 확장을&quot; 설정하기 전에 VM 개체에서 게스트 에이전트 프로비저닝을 사용하도록 설정해야 합니다. 이 문제는 새 포털에서 발생하지 않습니다 </span><a href=\"https://portal.azure.com/\"><span style=\"font-size: small;\">.</span></a></p>\n\n<p><span style=\"font-size: small;\"><strong>근본 원인:</strong> Azure Portal을 통해 이미지를 만들 때 VM의 게스트 에이전트 값이 항상 True&rdquo;로 &ldquo;설정되지는 않습니다. PowerShell을 사용하여 VM을 만든 경우 이 문제가 표시되지 않습니다.</span></p>\n\n<p><span style=\"font-size: small;\"><strong>해상도:</strong> 다음 PowerShell 명령을 추가하여 ProvisionGuestAgent를 True&rdquo;로 &ldquo;설정합니다.</span></p>\n\n<pre class=\"prettyprint\">\n$vm = Get-AzureVM -ServiceName &#39;MyServiceName&#39; -Name &#39;MyVMName&#39;\n$vm.GetInstance().ProvisionGuestAgent = $true</pre>"
