### YamlMime:Yaml
ms.openlocfilehash: 012616766441cdd1fec0d6a20e2e933cf6c0e95c
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139899367"
Slug: azure-automation-monitoring-and-troubleshooting-your-runbook-jobs-2
Title: 'Azure Automation: Runbook 작업 모니터링 및 문제 해결'
Summary: 매일 Azure Automation Runbook을 실행하면 Automation 작업이 어떻게 작동하는지 알고 싶을 것입니다. 예기치 않은 문제가 발생하는 경우 신속하게 문제를 해결하고 자동화를 다시 온라인으로 만들 수 있어야 합니다. 이 게시물은 방법을 보여줍니다.
Content: >-
  <h2>소개</h2>

  Microsoft Azure 환경의 관리 및 유지 관리를 자동화하는 정통한 고객은 물론 <a href="https://azure.microsoft.com/en-us/services/automation/">Azure의 새로운 Automation 서비스에</a> 대해 매우 잘 알고 있습니다. Azure Automation 서비스를 사용하면 클라우드 서비스를 가동 및 실행하는 데 시간이 많이 걸리고, 수동적이고, 반복적이며, 복잡한 작업을 자동화하고, 시간, 비용을 절약하고 오류를 줄이기 위해 다른 시스템과 통합할 수 있습니다. Azure Automation은 클라우드 오케스트레이션을 구동하는 Runbook(PowerShell 워크플로)을 만들고 관리하기 위한 완벽한 솔루션을 제공합니다.


  Runbook 및 관련 모듈 및 자산 만들기를 시작하고 매일 사용하기 시작하면 Runbook이 실행 중일 때, 현재 상태, 수행 방법 및 비용을 절약하는 방법 등 시스템에 있는 리소스에 대한 운영자의 보기를 원할 것입니다. 간단히 말해서 모든 자동화가 항상 어떻게 수행되는지 알고 싶을 것입니다. 예기치 않은 문제가 발생하는 경우 신속하게 문제를 해결하고 디버그하고 자동화를 다시 온라인으로 만들 수 있어야 합니다.


  Azure Automation은 여기에서 도움을 줍니다. Automation은 Runbook의 상태를 모니터링하고 Runbook 작업 문제를 해결하는 기능을 제공합니다. 이 게시물에서는 Azure Automation의 이러한 기능을 둘러보겠습니다.


  &nbsp;

  <h2>Automation 대시보드</h2>

  Azure Portal을 처음 열고 Automation 서비스로 이동하고 Automation 계정을 선택하면 전체 Automation 대시보드가 표시됩니다.


  <strong><img style="padding-left: 0px; padding-right: 0px; float: none; margin-left: auto; margin-right: auto; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="598" height="610" border="0" /></strong>


  이 대시보드에는 시스템에 대해 알려주는 네 가지 주요 섹션이 있습니다.

  <ol>
   <li>대시보드 맨 위에는 선택한 기간(마지막 1시간에서 지난 30일까지) 동안 각 Runbook 작업의 상태를 보여 주는 <b>차트</b> 가 있습니다. 이 차트에서는 지금 실행 중인 작업 수, 완료된 작업 수, 주의가 필요한 작업(일시 중단되거나 실패한 작업)을 빠르게 확인할 수 있습니다. 차트 맨 위에는 가능한 각 작업 상태를 나타내는 아이콘 행이 있습니다. 이러한 아이콘을 클릭하여 특정 상태 줄을 켜고 끌 수 있으므로 특정 관심 있는 작업 상태에 집중할 수 있습니다.</li>
   <li>차트 바로 아래에 <b>사용 개요</b>가 있습니다. 이 섹션에서는 작업 실행 시간, Runbook 수 및 모듈 크기에 대한 할당량에 대한 현재 사용량을 식별합니다. 이는 Azure Automation(사후 미리 보기)에 대한 요금을 지불하기 전에 시스템의 사용량을 측정하는 데 사용할 수 있습니다. 또는 이미 요금을 지불하고 있는 경우 업그레이드된 플랜으로 이동하기 전에 서비스를 사용할 수 있는 금액을 측정할 수 있습니다.</li>
   <li>사용 섹션 아래에 <b>는 작업</b> <b>테이블이 있습니다</b>. 이 테이블에는 지난 30일 동안 시작된 각 작업에 대한 항목이 포함되어 있으며 Runbook의 이름(워크플로), 작업이 마지막으로 업데이트된 시간 및 작업의 현재 상태를 보여 줍니다. 따라서 주의가 필요한 최근 Runbook 작업이 있는 경우 이 테이블을 사용하여 정확한 작업을 신속하게 식별한 다음, 드릴인하여 문제를 해결할 수 있습니다.</li>
   <li>사용 개요 및 작업 테이블의 오른쪽에 있는 <b>간단한 개요</b> 섹션입니다. 이 섹션에는 Runbook, 모듈 및 자산 수와 같은 Automation 계정에 대한 유용한 정적 정보가 포함되어 있습니다. 또한 현재 작성 상태에 있는 Runbook 수를 나타냅니다.</li>
  </ol>

  &nbsp;


  이제 위의 그래프가 정상적으로 표시되지만 대시보드로 이동하여 다음과 같은 항목을 확인한다고 가정해 보겠습니다.


  <strong><img style="margin: 0px auto; padding-left: 0px; padding-right: 0px; float: none; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="610" height="272" border="0" /></strong>


  글쎄, 그건 좋은 아니에요! 위에서 볼 수 있듯이 많은 일시 중단된 Runbook 작업(스크린샷의 연한 파란색)이 있으며 시간 범위에서는 이전에 이러한 종류의 일시 중단된 동작이 없었습니다. Automation 작업은 완료될 것으로 예상되므로(Runbook 작성자가 일시 중단하도록 의도하지 않은 경우) 문제이며 문제를 해결하려고 합니다.


  작업 테이블을 보면 동일한 Runbook인 Update-AzureVM이 실행될 때마다 일시 중단됩니다.


  <strong><img style="margin: 0px auto; padding-left: 0px; padding-right: 0px; float: none; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/3.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="610" height="418" border="0" /></strong>


  이 시점에서 작업 테이블에서 작업 마지막 업데이트 링크 중 하나를 클릭하고 작업 세부 정보로 직접 드릴할 수 있습니다. 그러나 이 경우 작업이 일시 중단되기 시작한 시기를 확인하려고 하므로 작업 테이블에서 Update-AzureVM<b> </b>Runbook 이름을 클릭하고 해당 Runbook에 대한 대시보드로 이동하여 해당 Runbook의 실행 기록을 확인합니다.


  &nbsp;

  <h2>Runbook 대시보드</h2>

  <b>Runbook 대시보드</b>는 차트, 작업 테이블 및 간략한 개요 섹션이 있는 <b>Automation 대시보드</b>와 매우 유사합니다. 그러나 Runbook 대시보드의 정보는 전적으로 단일 Runbook으로 범위가 지정됩니다.


  <strong><img style="margin: 0px auto; padding-left: 0px; padding-right: 0px; float: none; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="610" height="395" border="0" /></strong>


  <b>간략하게 살펴보면</b> 이 Runbook이 마지막으로 게시된 시기와 해당 Runbook을 게시한 사람 및 이 Runbook이 이번 달에 수행한 작업 실행 시간과 같은 기타 정보를 확인할 수 있습니다. 현재 편집 중이거나 완료되고 게시된 작성 상태도 확인할 수 있습니다. 그리고 Runbook이 일정에 따라 실행되도록 구성되었는지 확인할 수 있습니다.


  이 Runbook이 마지막으로 세 번 실행된 동안 일시 중단된 이유를 파악하려고 하므로 자세한 정보가 필요하므로 <b>작업</b> 테이블에서 각 작업에 대한 <b>작업 마지막 업데이트</b> 시간을 클릭하여 연결된 <b>작업 요약</b>으로 이동합니다.


  &nbsp;

  <h2>작업 요약</h2>

  작업 요약에는 특정 작업에 대한 요약이 표시됩니다. Runbook의 이름 및 현재 작업 상태와 작업을 시작한 사람, 작업을 시작한 사람, 마지막으로 업데이트된 시간(이 경우 일시 중단된 경우)을 볼 수 있습니다. 또한 Runbook에 대한 입력 매개 변수의 이름 및 값과 Runbook의 출력 또는 예외를 볼 수 있습니다.


  <strong><img style="margin: 0px auto; padding-left: 0px; padding-right: 0px; float: none; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="471" height="610" border="0" /></strong>


  이는 유용하지만 문제의 맨 아래에 도달하기에 충분한 정보를 제공하지 않았습니다. Runbook에서 일부 변수가 null로 끝난 것처럼 보이지만, 왜 그런 일이 일어났습니까? 알아보려면 <b>기록</b> 탭을 클릭하여 Runbook 실행의 각 단계에 대한 자세한 정보를 확인해 보겠습니다.


  &nbsp;

  <h2>작업 기록</h2>

  실행되는 모든 PowerShell 워크플로에 대해 워크플로 엔진은 유용한 정보를 포함하는 여러 스트림을 내보낸다. 이러한 스트림은 진행률, 출력, 경고, 오류 및 자세한 정보 표시 스트림입니다. 기본적으로 Azure Automation에서 진행률 및 자세한 정보 표시 스트림은 각 작업에 대해 저장되지 않습니다(특히 진행률 스트림의 경우 데이터 스토리지가 커질 수 있기 때문). 그러나 디버깅 및 문제 해결을 위해 이 정보가 필요한 경우 Runbook 구성 페이지에서 이러한 스트림에 대한 로깅을 사용하도록 설정할 수 있습니다.


  작업의 <b>기록</b> 페이지에는 레코드 생성 시간을 기준으로 정렬된 모든 스트림 레코드가 포함된 목록이 포함되어 있습니다. 따라서 이 페이지를 사용하여 신속하게 드릴다운하고 Runbook이 실행될 때 Runbook의 각 단계에서 어떤 일이 일어났는지 확인할 수 있습니다. Automation은 이 정보를 저장한 다음 검색할 수 있으므로 문제 해결을 염두에 두고 Runbook을 작성해야 합니다. 나중에 Runbook의 작업이 일시 중단되는 경우 근본 원인을 더 쉽게 찾을 수 있습니다.


  <strong><img style="margin: 0px auto; padding-left: 0px; padding-right: 0px; float: none; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="610" height="280" border="0" /></strong>


  위에서 볼 수 있듯이 작업 기록에 오류가 있는 것처럼 보입니다. Runbook이 패치하려는 Azure 가상 머신으로 원격으로 연결할 수 없는 것 같습니다.


  더 자세한 정보를 원하는 경우 스트림 레코드의 세부 정보를 보거나 이 작업의 소스 코드를 확인하여 PowerShell 워크플로 코드에서 발생하는 문제를 알려줄 수 있습니다. 이 작업이 실행된 이후 Runbook이 변경된 경우에도 이 특정 작업에 사용되는 소스 코드가 표시됩니다.


  <img style="margin: 0px auto; padding-left: 0px; padding-right: 0px; float: none; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/7.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="480" height="426" border="0" />


  잘 아는 Automation 사용자는 일시 중단된 각 작업에 대한 <b>기록에</b> 들어가서 생성된 오류에 대한 세부 정보를 확인했습니다. 위에서 이 오류는 Runbook이 패치하려고 했던 Azure 가상 머신에 대한 인증 실패로 인한 것임을 보여 주는 세부 정보를 볼 수 있습니다. 코드의 빠른 보기에서 Update-AzureVM Runbook은 "joeAzureVMCred" Automation 자격 증명 자산을 VM에 원격으로 사용하는 데 사용할 자격 증명으로 사용합니다.


  <strong><img style="margin: 0px auto; padding-left: 0px; padding-right: 0px; float: none; padding-top: 0px; border: 0px;" title="Azure Automation: Runbook 작업 모니터링 및 문제 해결" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8.png" alt="Azure Automation: Monitoring and Troubleshooting Your Runbook Jobs" width="610" height="424" border="0" /></strong>


  그런 다음 이 가상 머신의 암호가 최근에 변경되었음을 기억합니다. 이제 문제가 무엇인지 이해했습니다! 해결 방법은 간단합니다. joeAzureVMCred 자격 증명 자산을 편집하여 암호를 올바른 값으로 업데이트합니다.


  이 수정 사항을 적용하면 일시 중단된 각 작업을 다시 시작할 수 있으며, 마지막 검사점(향후 블로그 게시물의 검사점 지정에 대한 자세한 정보)에서 시작하여 수행 중인 작업을 완료합니다. 백업하고 실행 중입니다!


  &nbsp;

  <h2>요약</h2>

  Azure Automation에서는 Azure 클라우드 환경을 완전히 자동화할 수 있는 도구가 제공됩니다. 새 Runbook 만들기부터 실행 중인 작업, 모니터링 및 문제 해결에 이르기까지 전체 자동화 환경을 제어할 수 있습니다.


  Azure Automation을 시작하기만 하면 되었나요?<a href="https://aka.ms/Q2p1ap" target="_blank">여기서</a> 서비스에 대해 알아보고 <a href="https://twitter.com/AzureAutomation" target="_blank">Twitter</a>에서 Azure Automation을 따르세요.


  개인적으로 저와 연락하고 싶으신가요? <a href="https://jodoglevy.com" target="_blank">내 블로그</a>를 통해 연락하거나 <a href="https://twitter.com/jodoglevy" target="_blank">트위터에서</a> 나를 따르세요.
