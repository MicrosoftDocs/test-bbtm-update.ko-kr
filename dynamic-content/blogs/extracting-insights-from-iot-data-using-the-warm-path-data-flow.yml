### YamlMime:Yaml
ms.openlocfilehash: b81cc86927230f5b6384d3c20e87ca217ccf9d4b
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905972"
Slug: extracting-insights-from-iot-data-using-the-warm-path-data-flow
Title: 웜 경로 데이터 흐름을 사용하여 IoT 데이터에서 인사이트 추출
Summary: 이 블로그는 Microsoft의 산업 환경 팀이 게시한 솔루션 가이드의 적용 범위를 계속합니다. 이 가이드에는 데이터 수집, 핫 경로 처리, 콜드 경로 처리 및 분석 클라이언트와 같은 구성 요소가 포함되어 있습니다. 이 블로그 게시물에서는 솔루션 가이드의 웜 경로 처리 구성 요소를 다룹니다.
Content: >-
  <p>이 블로그는 Microsofts&rsquo; Industry Experiences 팀이 게시한 <a href="https://aka.ms/manufacturingsolutionguide" target="_blank">솔루션 가이드</a>의 적용 범위를 계속합니다. 이 가이드에는 다음 구성 요소가 포함되어 있습니다.</p>


  <ul>
   <li>데이터 수집</li>
   <li>핫 경로 처리</li>
   <li>콜드 경로 처리</li>
   <li>분석 클라이언트</li>
  </ul>


  <p>솔루션 가이드에서 IoT 애플리케이션에 대한 데이터를 처리하기 위한 권장 사항을 이미 다루었으며 데이터 흐름에 람다 아키텍처를 사용하는 것이 좋습니다. 데이터 경로를 반복하려면 다음을 수행합니다.</p>


  <ul>
   <li>일괄 처리 계층(콜드 경로)은 들어오는 모든 데이터를 원시 형식으로 저장하고 데이터에 대한 일괄 처리를 수행합니다. 이러한 처리의 결과는 일괄 처리 보기로 저장됩니다. 느린 처리 파이프라인으로, 복잡한 분석을 실행하고, 더 긴 기간(예: 시간 또는 일)에 걸쳐 여러 원본의 데이터를 결합하고, 보고서, 기계 학습 모델 등과 같은 새로운 정보를 생성합니다.</li>
   <li>속도 계층 및 서비스 계층(웜 경로)은 실시간으로 데이터를 분석합니다. 이 계층은 정확도는 떨어지지만 짧은 대기 시간을 제공하도록 디자인되었습니다. 들어오는 메시지를 보관하고 표시하고 이러한 레코드를 분석하여 경보와 같은 단기 중요 정보 및 작업을 생성하는 더 빠른 처리 파이프라인입니다.</li>
  </ul>


  <p>이 블로그 게시물에서는 솔루션 가이드의 웜 경로 처리 구성 요소를 다룹니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d0f330e7-e4aa-44bc-b990-4abfeca7aab9.png"><img alt="Warm path processing components of the solution guide" border="0" height="613" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/4be09c59-5546-4113-ae90-d883c6206bf6.png" style="margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="솔루션 가이드의 웜 경로 처리 구성 요소" width="1286"></a></p>


  <p><a href="https://docs.microsoft.com/en-us/azure/event-hubs/?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">Azure Event Hubs</a> 는 빅 데이터 스트리밍 플랫폼 및 이벤트 수집 서비스이며 데이터 스트림에서 데이터를 수집하기 위한 훌륭한 옵션입니다. 이 문서에서는 관련 Azure 네이티브 서비스를 살펴봅니다. 그러나 Apache Software Foundations&rsquo; 도구 및 기술을 사용하려는 경우 Event Hubs는 Apache Kafka 에코시스템에서 Apache Kafka MirrorMaker, Apache Flink 및 Kafka 스트림 지원합니다.</p>


  <p>Event Hubs를 통해 스트리밍되는 데이터의 양이 증가함에 따라 확장 가능한 방식으로 Event Hubs를 사용하는 것이 중요합니다. Event Hubs <a href="https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-features?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">기능</a> 의 문서와 파티션 및 소비자 그룹 개념에 대한 <a href="https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-programming-guide?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">프로그래밍 가이드</a> 를 검토하세요. 파티션과 소비자 그룹의 최상의 조합을 선택하는 것은 데이터의 특성과 처리 방법에 따라 달라집니다. 이벤트 허브의 파티션 집계 수는 TU(처리량 단위) &mdash; 와 일치해야 합니다. 자세한 내용은 <a href="https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-faq?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">자주 묻는 질문을</a> 참조하세요. 파티션을 사용하여 하나의 이벤트 허브에서 메시지 수집의 크기를 조정할 수 있습니다. 기본 최대값이 충분하지 않은 경우 지원 요청을 제출하여 최대값을 늘릴 수 있습니다. 또 다른 옵션은 시나리오에 따라 여러 Event Hubs를 사용하여 팬아웃 솔루션에 대한 별도의 허브에 다른 메시지 유형을 보내는 것입니다.</p>


  <p>다음 그림과 같이 Event Hub의 소비자 그룹을 사용하여 들어오는 데이터 스트림의 처리를 팬아웃하고 비즈니스 요구 사항에 따라 복잡한 처리 토폴로지 작성할 수 있습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/5b6d839c-e02a-4137-9032-b7a05875ccd9.png"><img alt="Figure showing complext processing topologies" border="0" height="368" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/bf9108c9-8261-4fa2-9afe-a9430002e2b7.png" style="margin: 0px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="복합 처리 토폴로지 그림" width="796"></a></p>


  <p>ASA(<a href="https://docs.microsoft.com/en-us/azure/stream-analytics/?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">Azure Stream Analytics</a>)는 디바이스에서 대량의 데이터 스트리밍을 검사할 수 있는 이벤트 처리 엔진입니다. Event Hub, IoT Hub 또는 Blob Storage 데이터를 수락할 수 있습니다. 들어오는 데이터 스트림을 처리하기 위해 Apache Flink와 같은 다른 스트림 처리 프레임워크를 사용할 수 있습니다. Apache Kafka용 Event Hubs에서 Apache Flink를 사용하는 방법에 대한 이 <a href="https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-kafka-flink-tutorial?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">자습서</a> 를 참조하세요.</p>


  <p>기계에서 회전 구성 요소의 온도에 대한 변경 내용을 스트리밍하려는 경우를 가정해 보겠습니다&rsquo;. 연속 창을 사용하여 5초마다 평균을 가져오는 쿼리를 다음과 같이 작성할 수 있습니다.</p>


  <pre>

  SELECT  System.TimeStamp AS WindowTime, DeviceName, ComponentName, avg(cast(SampleValue as float)) AS Average

  FROM s2tempsamples timestamp by SampleTimestamp

  WHERE SampleName = &#39;S2temp&#39; AND TRY_CAST(SampleValue AS float) IS NOT NULL   AND DeviceName = &#39;Machine1&#39;

  GROUP BY SampleTimestamp, DeviceName, ComponentName, tumblingwindow(second, 5)</pre>


  <p>ASA는 텀블링, 호핑, 슬라이딩 및 세션의 네 가지 임시 창을 제공합니다. 다음 다이어그램에서는 이러한 창 함수를 순서대로 설명하고 <a href="https://docs.microsoft.com/en-us/azure/stream-analytics/stream-analytics-window-functions?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">자세한 내용은 설명서</a>에서 확인할 수 있습니다.</p>


  <p>ASA의 최근 기능은 <strong>AnomalyDetection</strong> 연산자입니다. 세 가지 유형의 변칙을 검색하는 데 사용됩니다.</p>


  <ul>
   <li><strong>양방향 수준 변경.</strong> 값 수준의 지속적인 증가 또는 감소, 상향 및 하향. 이 값은 순간 또는 단기 변화인 스파이크(spike) 및 딥(dip)과는 다릅니다.</li>
   <li><strong>느린 긍정 추세.</strong> 시간 경과에 따른 추세의 느린 증가.</li>
   <li><strong>느린 음수 추세.</strong> 시간 경과에 따른 추세의 느린 감소.</li>
  </ul>


  <p>회전 구성 요소에서 점진적 증가 또는 양방향 온도 변화를 감지하려는 경우 설명서의 샘플 쿼리를 수정하여 들어오는 스트림을 다음과 같이 분석할 수 있습니다.</p>


  <pre>

  WITH AggregationStep AS
       (
            SELECT System.Timestamp as tumblingWindowEnd, AVG(SampleValue) as avgValue
            FROM s2tempsamples timestamp by SampleTimestamp
            WHERE SampleName = &#39;S2temp&#39;
  AND TRY_CAST(SampleValue AS float) IS NOT NULL

  AND DeviceName = &#39;Machine01&#39;
            GROUP BY TumblingWindow(second, 5)
       ),

      FillInMissingValuesStep AS
       (
             SELECT System.Timestamp AS hoppingWindowEnd,
                   TopOne() OVER (ORDER BY tumblingWindowEnd DESC) AS lastEvent
            FROM AggregationStep
            GROUP BY HOPPINGWINDOW(second, 300, 5)
       ),

      AnomalyDetectionStep AS
       (
             SELECT
                   hoppingWindowEnd,
                   lastEvent.tumblingWindowEnd as lastTumblingWindowEnd,
                   lastEvent.avgValue as lastEventAvgValue,
                   system.timestamp as anomalyDetectionStepTimestamp,
                   ANOMALYDETECTION(lastEvent.avgValue) OVER (LIMIT DURATION(hour, 1)) as
                   scores
             FROM FillInMissingValuesStep
       )

      SELECT
             alert = 1,
             hoppingWindowEnd,
             lastTumblingWindowEnd,
             lastEventAvgValue,
             anomalyDetectionStepTimestamp,
             scores
       INTO output
       FROM AnomalyDetectionStep
       WHERE
           CAST(GetRecordPropertyValue(scores, &#39;BiLevelChangeScore&#39;) as float) &gt;= 3.25
          OR CAST(GetRecordPropertyValue(scores, &#39;SlowNegTrendScore&#39;) as float) &gt;=
          3.25</pre>

  <p>쿼리 출력은 쿼리에서 INTO&rdquo; 절을 사용하여 다양한 출력으로 &ldquo;전달될 수 있습니다. 이 <a href="https://docs.microsoft.com/en-us/azure/stream-analytics/stream-analytics-define-outputs?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">문서에서</a> 현재 사용 가능한 출력 형식을 찾을 수 있습니다. 출력 형식 중 하나는 실시간 시각화 옵션을 허용하는 <a href="https://powerbi.microsoft.com/en-us/?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">Power BI</a>. ASA 작업은 <a href="https://docs.microsoft.com/en-us/azure/stream-analytics/stream-analytics-documentdb-output?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">Azure Cosmos DB 또는 Azure SQL Database</a> 같은 데이터 저장소로 전달될 수도 있습니다.</p>


  <p>이전 게시물의 되풀이 테마를 확인할 수 있습니다. IoT 데이터 분석은 컨텍스트에 따라 달라집니다. &ldquo;&rdquo; 예를 들어, 머신이 부품을 생산하는 시간을 결정하는 것은 기계가 지원하는 통신 프로토콜 및 구성과 같은 기술 구성 요소 외에도 교대 근무의 구성 방식, 제조 중인 부품 유형 및 사용 중인 컴퓨터에 따라 달라집니다.</p>


  <p>이 블로그는 들어오는 데이터 스트림을 처리하기 위한 Azure의 기술 옵션을 제시했지만 예제만 제공합니다. 실제 솔루션 아키텍처 및 구현은 비즈니스 요구 사항 및 컨텍스트에 따라 달라집니다.</p>


  <h2>다음 단계</h2>


  <ul>
   <li>Apache Kafka용 Event Hubs와 함께 Apache Flink를 사용하려는 경우 이 <a href="https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-kafka-flink-tutorial?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">자습서</a> 를 완료합니다.</li>
   <li>Power BI 및 Stream Analytics <a href="https://docs.microsoft.com/en-us/azure/stream-analytics/stream-analytics-power-bi-dashboard?WT.mc_id=iotinsightsblog-blog-ercenk" target="_blank">자습서</a>를 완료합니다.</li>
   <li><a href="https://aka.ms/manufacturingsolutionguide" target="_blank">솔루션 가이드</a>에서 IoT 데이터에서 인사이트를 추출하기 위한 더 큰 그림을 가져옵니다.</li>
  </ul>
