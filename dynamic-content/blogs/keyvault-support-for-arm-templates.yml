### YamlMime:Yaml
ms.openlocfilehash: 1a6c42fb39466fdf018c1f56adb936fe3dbfb043
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139905482"
Slug: keyvault-support-for-arm-templates
Title: ARM 템플릿의 Key Vault 지원
Summary: ARM 템플릿에서 Azure KeyVault의 비밀을 참조하는 방법에 대해 자세히 알아봅니다.
Content: >-
  <p>Azure Resource Manager 템플릿을 사용하여 코드로서의 인프라 또는 지속적인 배포 워크플로를 관리할&#39;있는 경우 비밀 저장소&quot;와 도구 간에 &quot;비밀을 마샬링하여 Azure에 템플릿을 배포해야 할&#39;있습니다. 그다지 드문 패턴은 이러한 비밀을 매개 변수 파일에 넣은 다음 소스 제어에 체크 인하는 것입니다. 비밀 관리에 대한 모범 사례는&hellip; 아닙니다.</p>


  <p>Azure Resource Manager 템플릿에서 <a href="https://azure.microsoft.com/en-us/documentation/articles/resource-manager-keyvault-parameter/">Azure KeyVault</a> 및 2.9 Azure SDK에서 비밀에 대한 참조를 제공할 수 있으며 VS에서 사용할 수 있는 도구를 사용하여 비밀을 저장하는 것만큼 간단하게 만들 수 있습니다. 이 작업을 수행하는 데 필요한 몇 가지 단계가 있지만&rsquo; 이 릴리스에서는 쉽게 만들 수 있습니다.</p>


  <ol>
   <li>배포 중에 사용하려는 비밀에 대한 Key Vault 만들기</li>
   <li>자격 증명 모음에 비밀 배치</li>
   <li>배포 중에 Azure Resource Manager가 비밀을 검색할 수 있도록 Key Vault의 속성을 설정합니다.</li>
   <li>Key Vault에서 secureStrings를 참조하는 배포 템플릿 작성</li>
  </ol>


  <p>또한 배포를 수행하는 사용자는 자격 증명 모음의 비밀에 대한 읽기 권한이 필요합니다. 따라서 서비스 주체를 사용하여 자동화된 워크플로에 배포할&#39;있는 경우 해당 서비스 주체는 사용하려는 비밀에 액세스해야 합니다.</p>


  <p>여기서는 Visual Studio 사용하여 Key Vault의 비밀을 사용하는 템플릿을 작성하는 방법에 대한 빠른 연습을&#39;.</p>


  <p>먼저 배포하려는 Azure 리소스 그룹 프로젝트가 있어야 합니다. 아직 만들지&#39;경우 <a href="https://azure.microsoft.com/en-us/documentation/articles/vs-azure-tools-resource-groups-deployment-projects-create-deploy/">여기에서</a> 간략한 개요를 읽을 수 있습니다. 내 예제에서는 Virtual Machine Scale Set을 기반으로 프로젝트를 만든&#39;가상 머신의 관리자 암호에 KeyVault를 사용합니다.</p>


  <p>프로젝트를 배포할 준비가 되면 프로젝트 노드를 마우스 오른쪽 단추로 클릭하여 새 배포를 시작합니다.</p>


  <p><img alt="Resource Group Deployment Dialog" border="0" height="411" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/f78e21bd-c5c3-4b25-89e8-748dda8050f8.jpg" style="border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="리소스 그룹 배포 대화 상자" width="480"></p>


  <p>여기에서 매개 변수&hellip; 편집 단추를 클릭하여 템플릿에서 사용 가능한 매개 변수를 확인합니다.</p>


  <p><img alt="Edit Parameters dialog" border="0" height="305" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0d7bd28b-1f6c-46f3-be26-21ff884167fc.jpg" style="border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="매개 변수 편집 대화 상자" width="610"></p>


  <p>암호에 대한 매개 변수를 제외한 모든 매개 변수를 이미 입력한&#39;. 값을 입력하는 대신 KeyVault 단추를 사용하여 KeyVault에서 비밀을 선택할&#39;있습니다. 여기에서 몇 가지 사항을 알 수 있습니다.&hellip;</p>


  <p>먼저 구독에 Key Vault가&#39;없는 경우 이를 만드는 <a href="https://gist.github.com/bmoore-msft/710284c0bd791a688e21">스크립트</a> 가 있습니다. 현재는 Azure Portal을 통해 Key Vault를 만들 수 없으므로 스크립팅이 진행됩니다. 스크립트를 사용하면 수행 중인&#39;*정확히* 확인하고 다른 워크플로에서 수정하고 다시 사용할 수 있습니다. 템플릿을 선호하는 경우 템플릿을 사용하여 자격 증명 모음(및 비밀 <a href="https://github.com/rjmax/ArmExamples/tree/master/keyvaultexamples">)을 만들</a> 수도 있습니다.</p>


  <p><img alt="Select KeyVault Secret dialog" border="0" height="257" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/293b21d0-709f-41c6-b940-adcbb27e8911.jpg" style="border-width: 0px; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="KeyVault 비밀 대화 상자 선택" width="480"></p>


  <p>구독에 Key Vault가 이미 있는 경우 템플릿 배포 중에 사용할 수 없는 자격 증명 모음을 볼 수 있습니다. 위의 스크립트에 &quot;사용된 것으로 표시되는 enabledForTemplateDeployment&quot; 속성입니다.</p>


  <p><img alt="KeyVault not enabled" border="0" height="257" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/78c000d7-ff80-423f-a9f3-539d8af07829.jpg" style="border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="KeyVault를 사용할 수 없음" width="610"></p>


  <p>이 자격 증명 모음을 선택하면 권한이 있는 경우 Visual Studio 속성을 설정합니다. 이 속성은 배포를 위해 선택한 자격 증명 모음뿐만 아니라 전체 자격 증명 모음 및 모든 비밀에 대한 것입니다.</p>


  <p>자격 증명 모음을 선택한&#39;자격 증명 모음에 있는 비밀을 선택하거나 새 비밀을 만들 수 있습니다.</p>


  <p><img alt="KeyVault Secret Selection" border="0" height="326" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/8e1477ae-a2ea-4e20-b996-c560858527e0.jpg" style="border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="KeyVault 비밀 선택" width="610"></p>


  <p>이제 매개 변수 편집 대화 상자로 돌아가서 매개 변수 파일의 리터럴 값이 아니라 비밀에 대한 참조를 사용할&#39;있음을 알리기 위해 비밀 값에 대한 워터마크가&#39;.</p>


  <p><img alt="KeyVault Edit Parameters watermark" border="0" height="305" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6063b8c0-b716-4647-a98e-d96e87b90d85.jpg" style="border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="KeyVault 매개 변수 편집 워터마크" width="610"></p>


  <p>JSON에서 참조되는 방식을 확인하려면 매개 변수 파일을 열고 변경된&#39;확인할 수 있습니다.</p>


  <p><img alt="KeyVault JSON" border="0" height="316" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9a97a6e9-385b-4a11-800b-27a7d8b073d7.jpg" style="border: 0px currentColor; border-image: none; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="KeyVault JSON" width="720"></p>


  <p>또한 이 작업을 수행하려면 템플릿 자체에 대한 변경 내용이 없으며 매개 변수 파일만 적용됩니다. 따라서 다른 매개 변수 파일만 사용하여 워크플로의 여러 단계에서 다른 참조를 사용하여 자격 증명 모음을 변경할 수 있습니다. 또는 각 개발자가 서로 다른 비밀을 가진 자체 리소스 그룹 또는 환경을 가질 수 있습니다.</p>


  <p>그게&rsquo; 전부입니다. 언제나처럼 피드백이 있는지 알려주세요.</p>
