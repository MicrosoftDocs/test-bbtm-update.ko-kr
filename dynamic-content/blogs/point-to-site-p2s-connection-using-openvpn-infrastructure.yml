### YamlMime:Yaml
ms.openlocfilehash: 749ccce03f60b51814376a7957515cb8bf25f9b9
ms.sourcegitcommit: d03bdc7fe5447adb6530886aab848b75fe8fa8ee
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/11/2022
ms.locfileid: "139911630"
Slug: point-to-site-p2s-connection-using-openvpn-infrastructure
Title: OpenVPN 인프라를 사용하는 P2S(지점 및 사이트 간) 연결
Summary: '자주 묻는 질문 중 하나는 Unix와 유사한 운영 체제(예: Linux 및 FreeBSD) 및 Virtual...을 기반으로 클라이언트 컴퓨터에서 P2S(지점 및 사이트 연결) 연결을 설정하는 것입니다.'
Content: >-
  <p>자주 묻는 질문 중 하나는 클라우드에 배포된 가상 머신을 관리하기 위한 목적으로 Unix와 유사한 운영 체제(예: Linux 및 FreeBSD) 및 Azure의 VNet(Virtual Network)을 기반으로 클라이언트 컴퓨터에서 P2S(지점 및 사이트 연결) 연결을 설정하는 것입니다. 이 문서에서는 이 요청을 처리하고 Azure에서 아키텍처 설정을 자동화하는 <a href="https://github.com/simonesavi/p2s-with-openvpn" target="_blank">샘플 코드를</a> 제공하는 ARM(Azure Resource Manager) 배포 모델에 대한 사용자 지정 솔루션을 설명합니다.</p>


  <p>제안된 인프라는 Azure Virtual Network 게이트웨이를 기반으로 하는 것이 아니라 Azure IaaS 리소스와 오픈 소스 커뮤니티 소프트웨어가 혼합된 것입니다. &#39;원하는 사용자를 위한 솔루션입니다.</p>


  <ul>
   <li>VPN 서버의 완전한 제어</li>
   <li>성능에 대한 우려 없이 매우 낮은 비용</li>
   <li>P2S 자동 설정</li>
  </ul>


  <p>모든 IaaS 접근 방식과 마찬가지로 클라이언트는 인프라 관리 및 보안에 대한 책임을 집니다.</p>


  <h2>대상 아키텍처</h2>


  <p>빌드하려는 대상 아키텍처의 스키마를 따릅니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/a0c09277-6a0c-4a04-8b11-e812f679c8dc.png"><img alt="target-architecture" border="0" height="405" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/1e601941-1e84-42bd-92d2-5e91a069ecd9.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="target-architecture" width="866"></a></p>


  <p>다음과 같은 구성 요소가 있습니다.</p>


  <ul>
   <li>대상 VNet: <ul>
    <li>하나의 OpenVPN 서브넷</li>
    <li>OpenVPN 서브넷용 NSG(네트워크 보안 그룹) 1개</li>
    <li>관리할 Virtual Machines를 포함하는 정의되지 않은 수의 서브넷</li>
   </ul>
   </li>
   <li>OpenVPN Server &ndash; CentOS 기반 가상 머신</li>
   <li>인터넷에 연결된 &ndash; 클라이언트 데스크톱에는 OpenVPN 클라이언트가 포함되어 있습니다.</li>
  </ul>


  <p>CentOS 기반 Virtual Machine에는 SSLv3/TLSv1 프로토콜을 기반으로 VPN을 만드는 데 사용되는 OpenVPN 서버가 포함됩니다.</p>


  <p>프록시 서버를 통해 작업하는 기능을 위해 이 제품을 선택했습니다. 많은 클라이언트 네트워크 구현에서는 인터넷 액세스가 프록시 서버를 통해 라우팅되어야 합니다. 이러한 이유로 OpenVPN 서버는 HTTPS 기본 포트인 포트 443에서 수신 대기합니다. 일반적으로 이 포트는 프록시 서버에 의해 필터링되지 않습니다. 이렇게 하면 인터넷 액세스가 제한된 네트워크에서도 클라이언트와 서버 간에 관리 VPN을 설정할 수 있습니다.</p>


  <p>또한 OpenVPN 서버는 오픈 소스 커뮤니티에서 잘 알려져 있으며 다양한 운영 체제에서 사용할 수 있는 많은 클라이언트가 있습니다.</p>


  <p><strong>참고:</strong> 이 구현은 단일 OpenVPN 서버를 기반으로 합니다. 고가용성이 요구 사항이거나 VPN 연결이 서비스 제공의 일부로 사용되는 프로덕션 환경에는 사용하지 않는 것이 좋습니다.</p>


  <h2>아키텍처 작동 방식</h2>


  <p>OpenVPN 서버는 Azure 서브넷에 있으며 VPN 연결에서 들어오는 모든 요청을 수신합니다. 서버가 실행할 가장 중요한 작업은 IP 위장입니다.</p>


  <p>IP 위장은 NAT(네트워크 주소 변환)의 한 형태이며, 이를 통해 VPN 서버 들어오는 통신을 해당 통신에서 시작된 것처럼 보이게 변경할 수 있습니다.</p>


  <p>이러한 방식으로 작동하면 패키지를 VNet에서 자유롭게 라우팅할 수 있으며 관리할 VM의 대상에 도달할 수 있습니다.</p>


  <p><a href="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/6345db88-8cdc-415a-8914-5fd7bbf0b63a.png"><img alt="how-architecture-works" border="0" height="245" src="https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/d98be70a-beb0-457b-804d-b94c092d3162.png" style="border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" title="how-architecture-works" width="737"></a></p>


  <p>당신이 볼 수 있듯이 우리는 몇 가지 특정 경로 규칙을 추가 할 필요성을 인용하지 않았다. 실제로 패킷이 OpenVPN에서 시작된 것을 시뮬레이션하여 모든 패킷은 시스템 경로 규칙 &ldquo;로컬 Vnet Roule&rdquo;을 사용하여 다양한 서브넷에서 라우팅됩니다.</p>


  <p><strong>참고:</strong> 네트워크 트래픽의 실제 대상이 아닌 NIC로 트래픽을 보내는 경로 규칙이 없으므로 IP 전달도 필요하지&#39;. 들어오는 모든 트래픽은 &ldquo;VPN 터널에서 포위&rdquo; 되고 OpenVPN 서버에서 래핑을 해제한 다음 Azure 인프라 작업 없이 해당 대상으로 전송됩니다.</p>


  <h2>샘플 코드</h2>


  <p>자동화를 위해 제안된 <a href="https://github.com/simonesavi/p2s-with-openvpn" target="_blank">코드</a> 에는 다음 두 가지 주요 구성 요소가 있습니다.</p>


  <ol>
   <li>Azure 인프라를 준비하는 데 사용되는 PowerShell 스크립트</li>
   <li>CentOS 서버 자동 구성을 실행하는 데 사용되는 Bash 스크립트</li>
  </ol>


  <p>첫 번째 단계는 제안된 인프라를 만드는 데 필요한 단계를 실행하고, 마지막 단계로 프로비전이 끝날 때 컴퓨터에서 제공된 Bash 스크립트의 실행을 허용하는 Virtual Machine 확장을 설정합니다.</p>


  <p>Bash 스크립트는 CentOS 이미지의 필요한 사용자 지정을 처리합니다. 또한 서버와의 연결을 설정하기 위해 OpenVPN 클라이언트에 필요한 자격 증명인 새 프라이빗 Azure Blob에서 업로드를 처리합니다.</p>


  <p>코드에 대한 자세한 가이드는 <a href="https://github.com/simonesavi/p2s-with-openvpn" target="_blank">GitHub 프로젝트에서</a> 찾을 수 있습니다.</p>


  <h2>결론</h2>


  <p>이 문서에서는 일부 사용자의 특정 요구 사항을 해결하기 위해 Azure IaaS 리소스와 오픈 소스 커뮤니티 소프트웨어를 혼합하여 아키텍처를 설명했습니다. <a href="https://github.com/simonesavi/p2s-with-openvpn" target="_blank">샘플 코드</a>도 릴리스했습니다.</p>


  <p>이는 Azure에서 사용할 수 있는 리소스와 서비스의 조합으로 다양한 상황을 쉽게 해결할 수 있는 방법에 대한 추가 증거입니다.</p>


  <p><strong>참고:</strong> 이러한 종류의 솔루션에 관심이 있는 사람들을 위해 Azure VPN Gateway에서 OpenVPN 지원을 사용하도록 공식 구현을 사용할 수 있다는 것을 공유하게 되어&#39;. Microsoft Azure Docs 페이지에서 <a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-openvpn" target="_blank">Azure 지점 및 사이트 간 VPN Gateway(미리 보기)</a>&rdquo;에 대한 OpenVPN 구성을 참조 &ldquo; 하세요.</p>
