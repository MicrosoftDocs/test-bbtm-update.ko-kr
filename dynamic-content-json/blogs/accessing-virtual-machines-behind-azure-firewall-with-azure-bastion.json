{
    "Slug": "accessing-virtual-machines-behind-azure-firewall-with-azure-bastion",
    "Title": "Azure Bastion을 사용하여 Azure Firewall 뒤에 있는 가상 머신에 액세스",
    "Summary": "Azure Virtual Network enables a flexible foundation for building advanced networking architectures. Managing heterogeneous environments with various types of filtering components, such as Azure Firewall or your favorite network virtual appliance, requires a little bit of planning.",
    "Content": "<p>Azure Virtual Network 고급 네트워킹 아키텍처를 빌드하기 위한 유연한 기반을 제공합니다. Azure Firewall 또는 즐겨 찾는 NVA(네트워크 가상 어플라이언스)와 같은 다양한 유형의 필터링 구성 요소로 다른 유형의 환경을 관리하려면 약간의 계획이 필요합니다.</p>\n\n<p><a href=\"https://azure.microsoft.com/en-us/blog/announcing-the-preview-of-microsoft-azure-bastion/\" target=\"_blank\">현재 미리 보기 상태</a>인 Azure Bastion은 Azure Portal 통해 VM(가상 머신)에 대한 안전하고 원활한 RDP(원격 데스크톱 프로토콜) 및 SSH(보안 셸) 액세스를 제공하는 완전히 관리되는 PaaS(Platform as a Service)입니다. Azure Bastion은 가상 네트워크에서 직접 프로비전되어 공용 IP 주소를 통해 노출되지 않고 연결된 모든 VM을 지원합니다.</p>\n\n<p>Azure Firewall 또는 NVA를 배포할 때 서브넷의 모든 트래픽을 항상 강제로 터널합니다. 0.0.0.0/0 사용자 정의 경로를 적용하면 가상 네트워크의 워크로드에 대한 수신 및 송신 트래픽에 대한 비대칭 라우팅이 발생할 수 있습니다.</p>\n\n<p>간단하지는 않지만 모든 애플리케이션에서 이 문제를 해결할 수 있도록 DS NAT, 전달 등을 비롯한 증가하는 네트워크 규칙 집합을 만들고 관리하는 경우가 많습니다. 이는 모든 애플리케이션에 영향을 미칠 수 있지만 RDP 및 SSH가 가장 일반적인 예입니다. 이 시나리오에서는 인터넷의 수신 트래픽이 가상 네트워크 내의 가상 머신으로 직접 전송될 수 있지만 송신 트래픽은 결국 NVA로 이동합니다. 대부분의 NVA는 상태 저장이므로 처음에 수신하지 않았기 때문에 이 트래픽이 삭제됩니다.</p>\n\n<p>Azure Bastion을 사용하면 상태 저장 NVA 또는 강제 터널링을 사용하도록 설정된 Azure Firewall 포함하는 가상 네트워크 내의 워크로드에 RDP/SSH를 간소화할 수 있습니다. 이 블로그에서는 원활하게 작동하는 방법을 살펴보겠습니다.</p>\n\n<p style=\"text-align: center;\"><iframe allow=\"autoplay; encrypted-media\" allowfullscreen=\"\" frameborder=\"0\" height=\"315\" scrolling=\"no\" src=\"https://www.microsoft.com/en-us/videoplayer/embed/RE39JYA\" width=\"560\"></iframe></p>\n\n<ul>\n <li>가상 네트워크에 Azure Bastion(미리 보기)을 배포하는 방법에 대한 참조는 <a href=\"https://docs.microsoft.com/en-us/azure/bastion/bastion-create-host-portal\" target=\"_blank\">Azure Bastion 호스트 만들기(미리 보기)</a> 설명서를 &ldquo; 참조하세요.&rdquo;</li>\n <li>가상 네트워크에서 Azure Firewall 구현하는 방법을 알아보려면 Azure Portal <a href=\"https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal\" target=\"_blank\">사용하여 Azure Firewall 배포 및 구성</a> 설명서를 &ldquo; 참조하세요.&rdquo;</li>\n</ul>\n\n<p>가상 네트워크에 Azure Bastion과 Azure Firewall 모두 배포한 후 이 시나리오에서 작동하도록 Azure Bastion을 구성하는 방법을 살펴보겠습니다.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/e22d790b-e4f5-4f45-9dca-39528683a333.png\"><img alt=\"Azure Bastion architecture\" border=\"0\" height=\"563\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/66f4fbe8-a443-440f-b4a4-8b2de1c96fc8.png\" style=\"border: 0px currentcolor; border-image: none; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;\" title=\"Azure Bastion 아키텍처\" width=\"1024\"></a></p>\n\n<h2>Azure Bastion 구성</h2>\n\n<p>Azure Firewall 또는 가상 어플라이언스를 배포할 때 Azure Firewall 배포하는 동안 생성된 <strong>RouteTable</strong>을 가상 네트워크의 모든 서브넷에 연결하게 될 수 있습니다. <strong>AzureBastionSubnet 서브넷</strong>도 포함할 수 있습니다.&nbsp;</p>\n\n<p>이는 모든 Azure Bastion 트래픽을 Azure Firewall 전송하는 AzureBastionSubnet 서브넷에 사용자 정의 경로를 적용하여 Azure Bastion에 필요한 트래픽을 차단합니다. 이를 방지하기 위해 Azure Bastion을 구성하는 것은 매우 쉽지만 <strong>RouteTable</strong> 을 <strong>AzureBastionSubnet 서브넷</strong> 에 연결하지 마세요.</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/2c59a68a-72bf-440b-8a60-790af4ee09b5.png\"><img alt=\"myRoute table in Microsoft Azure\" border=\"0\" height=\"1141\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/fbb546cb-7244-479d-917b-6461cd14e326.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"Microsoft Azure myRoute 테이블\" width=\"3000\"></a></p>\n\n<p>위에서 알 수 있듯이 <strong>myRouteTable</strong> 은 <strong>AzureBastionSubnet</strong>과 연결되지 않고 <strong>Workload-SN</strong>과 같은 다른 서브넷과 연결됩니다.</p>\n\n<p><strong>AzureBastionSubnet 서브넷</strong>은 안전한 플랫폼 관리 서브넷이며 Azure Bastion을 제외한 다른 Azure 리소스는 이 서브넷에 배포할 수 없습니다. Azure Bastion에 대한 모든 연결은 2FA를 사용하는 Azure Active Directory 토큰 기반 인증을 통해 적용되며 모든 트래픽은 HTTPS를 통해 암호화됩니다.&nbsp;</p>\n\n<p>Azure Bastion은 내부적으로 강화되며 포트 443을 통해서만 트래픽을 허용하므로 서브넷에 추가 NSG(네트워크 보안 그룹) 또는 사용자 정의 경로를 적용하는 작업이 절약됩니다.</p>\n\n<p>이를 통해 RDP/SSH 요청은 Azure Bastion에 배치됩니다. 위의 예제를 사용하여 구성된 기본 경로(0.0.0.0/0)는 이 서브넷과 연결되지&#39;<strong>AzureBastionSubnet</strong> 에 적용되지 않습니다. 들어오는 RDP/SSH 요청에 따라 Azure Bastion은 기본 경로가 연결된 Workload-SN과 같은 다른 서브넷의 가상 머신에 연결합니다. 가상 머신의 반환 트래픽은 반환 트래픽이 가상 네트워크의 특정 개인 IP로 전달되므로 가상 네트워크에서 NVA로 이동하는 대신 Azure Bastion으로 직접 이동합니다. 가상 네트워크의 특정 개인 IP 주소는 보다 구체적인 경로이므로 NVA에 대한 강제 터널 경로보다 우선하므로 NVA 또는 Azure Firewall 가상 네트워크에 배포될 때 RDP/SSH 트래픽이 Azure Bastion과 원활하게 작동합니다.</p>\n\n<p>고객과 커뮤니티의 참여와 흥분에 감사드리며, 서비스를 더욱 개선하고 곧 일반 공급할 수 있도록 <a href=\"https://feedback.azure.com/forums/922378-azure-bastion\" target=\"_blank\">피드백을</a> 기대하고 있습니다.</p>\n"
}