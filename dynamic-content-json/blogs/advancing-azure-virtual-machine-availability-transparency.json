{
    "Slug": "advancing-azure-virtual-machine-availability-transparency",
    "Title": "Azure Virtual Machine 가용성 투명성 향상",
    "Summary": "Now, in addition to getting a fast notification when a VM’s availability is impacted, customers can expect a root cause to be added at a later point once our automated Root Cause Analysis (RCA) system identifies the failing Azure platform component that led to the VM failure.",
    "Content": "<p><em>&ldquo;<a href=\"https://www.aka.ms/AdvancingReliability\" target=\"_blank\">향상된 안정성 블로그 시리즈</a>&rsquo; 전체에서 기술 문제가 고객에게&rsquo; VM(가상 머신) 또는 기타 리소스&mdash;와 같은 호스트 복원력에 영향을 주지 않도록 하기 위해 Azure 플랫폼에서 사용하는 다양한 기술을 설명했습니다. <a href=\"https://azure.microsoft.com/blog/improving-azure-virtual-machines-resiliency-with-project-tardigrade/\" target=\"_blank\">Project Tardigrade</a>를 통해 신중한 <a href=\"https://azure.microsoft.com/blog/advancing-safe-deployment-practices/\" target=\"_blank\">안전한 배포 방법은</a> <a href=\"https://azure.microsoft.com/blog/advancing-safe-deployment-with-aiops-introducing-gandalf/\" target=\"_blank\">물론 ML 기반 AIOps 인사이트를 활용합니다.</a><a href=\"https://azure.microsoft.com/blog/advancing-failure-prediction-and-mitigation-introducing-narya/\" target=\"_blank\"> Project Narya를 사용하여 하드웨어 오류를 예측하고 완화합니다</a>. 이러한 노력에도 불구하고 Azure 규모로 운영할 때 고객 리소스&mdash;에 영향을 주는 몇 가지 오류가 불가피하게 발생할 수 있다는 것을 알고 있으므로 영향을 받은 고객과 통신하는 방식의 투명성을 위해 노력합니다. 그래서 시리즈의 오늘&rsquo; 게시물에 대 한, 나는 주요 소프트웨어 엔지니어링 관리자 <strong>닉 스완슨</strong> 공간&mdash;의 최근 개선을 강조 하도록 요청 했습니다., 어떻게 우리가 Azure 리소스 상태를 통해 더 자세한 근본 원인 문을 표면.&rdquo;</em>&mdash; Mark Russinovich, CTO, Azure</p>\n\n<hr>\n<p>&nbsp;</p>\n\n<p>기존 Azure 리소스 상태 기능은 Azure 리소스에 영향을 주는 서비스 문제를 진단하고 지원하는 데 도움이 됩니다. 리소스의 현재 및 과거 상태를 보고하여 각 리소스를 사용할 수 없는 시간 범위를 표시합니다. 그러나 우리는 고객과 파트너가 근본적인 기술 문제의 원인을 이해하고, 모니터링 프로세스에 공급하기 위해 문제에&mdash; 대한 통신을 받을 수 있는 방법을 개선하고, 다른 이해 관계자에게 딸결정을 설명하고, 궁극적으로 비즈니스 결정을 알리는 데&rdquo; 특히 관심이 &ldquo;있다는 것을 알고 있습니다.</p>\n\n<h2>Azure 리소스 상태의 VM 문제에&mdash; 대한 근본 원인 소개</h2>\n\n<p>최근에 문제를 야기한 근본 원인에 대한 추가 컨텍스트를 통해 VM 오류에 대해 고객과 공유하는 정보를 향상시키는 리소스 상태 환경이 개선되었습니다. 이제 VM 가용성에 영향을 줄 때 빠른 알림을 받는 것 외에도 자동화된 RCA(근본 원인 분석) 시스템이 VM&rsquo; 실패로 이어진 실패한 Azure 플랫폼 구성 요소를 식별하면 나중에 근본 원인이 추가될 것으로 예상할 수 있습니다. 예제를 통해 실제로 작동하는 방식을 살펴보겠습니다&rsquo;.</p>\n\n<ol>\n    <li>T1 시 네트워킹 문제로 인해 서버 랙이 오프라인 상태가 되어 랙의 VM이 연결이 끊깁니다. (네트워크 아키텍처와 관련된 최근의 안정성 개선 사항은 향후 <a href=\"https://www.aka.ms/AdvancingReliability\" target=\"_blank\">고급 안정성</a> 블로그 포스트&mdash;워치에서 공유될 예정입니다.)</li>\n    <li>T2 시 Azures&rsquo; 내부 모니터링은 랙의 VM에 연결할 수 없음을 인식하고 영향을 받는 VM을 새 랙에 다시 배포하여 완화를 시작합니다. 이 시간 동안 VM이 현재 영향을 받고 사용할 수 없음을 고객에게 알리는 주석이 리소스 상태로 전송됩니다.\n    <p>&nbsp;</p>\n    <a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/12785145-3b38-495b-84c2-8d0d9ee927be.png\"><img alt=\"A screenshot of the Azure portal “resource health” blade showing the health history of a resource.\" border=\"0\" height=\"974\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/993840fc-e567-46bc-a3d1-c89e1f36cb51.png\" style=\"border-image: none; display: inline; background-image: none;\" title=\"그림 1: 상태 기록\" width=\"1430\"></a>\n\n    <p><em><strong>그림 1</strong>: 리소스의 상태 기록을 보여 주는 Azure Portal &ldquo;리소스 상태&rdquo; 블레이드의 스크린샷</em></p>\n    </li>\n    <li>T3 시 랙 스위치 상단의 플랫폼 원격 분석, 호스트 컴퓨터 및 내부 모니터링 시스템은 모두 RCA 엔진에서 함께 상호 연결되어 오류의 근본 원인을 도출합니다. 일단 계산되면 RCA는 고객이 향후 영향 가능성을 최소화하기 위해 구현할 수 있는 관련 아키텍처 복원력 권장 사항과 함께 리소스 상태에 다시 게시됩니다.</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p><a href=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/9392bf23-e34d-4352-a9bc-a9738d21af02.png\"><img alt=\"A screenshot of the Azure portal &quot;health history&quot; blade showing root cause details for an example of a VM issue.\" border=\"0\" height=\"944\" src=\"https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/0e155d0b-d963-4495-bbcc-b2ee2c690b3a.png\" style=\"border: 0px currentcolor; border-image: none; display: inline; background-image: none;\" title=\"그림 2\" width=\"1430\"></a></p>\n\n<p><em><strong>그림 2:</strong> VM 문제의 예에 대한 근본 원인 세부 정보를 보여 주는 Azure Portal &quot;상태 기록&quot; 블레이드의 스크린샷</em></p>\n\n<p>초기 가동 중지 시간 알림 기능은 몇 년 동안 존재하지만 근본 원인 설명의 게시는 새로운 추가 기능입니다. &rsquo;이제 이러한 근본 원인을 도출하는 방법에 대한 세부 정보를 살펴보겠습니다.</p>\n\n<h2>근본 원인 분석 엔진</h2>\n\n<p>&rsquo;이전 예제를 자세히 살펴보고 RCA 엔진의 작동 방식과 그 뒤에 있는 기술에 대한 세부 정보를 살펴보겠습니다. VM용 RCA 엔진의 핵심은 대용량 로그 원격 분석용으로 최적화된 빅 데이터 서비스인 <a href=\"https://docs.microsoft.com/en-us/azure/data-explorer/data-explorer-overview\" target=\"_blank\">ADX(Azure</a> Data Explorer)입니다. Azure Data Explorer 사용하면 Azure 플랫폼을 구성하는 디바이스 및 서비스에서 테라바이트의 로그 원격 분석을 쉽게 구문 분석하고, 함께 조인하고, 상호 관련된 정보 스트림을 해석하여 다양한 오류 시나리오에 대한 근본 원인을 도출할 수 있습니다. 결국 다단계 데이터 엔지니어링 프로세스가 됩니다.</p>\n\n<h3>1단계: 가동 중지 시간 검색</h3>\n\n<p>근본 원인 분석의 첫 번째 단계는 분석이 실행되는 트리거를 정의하는 것입니다. Virtual Machines 경우 VM이 예기치 않게 다시 부팅할 때마다 근본 원인을 확인하려고 하므로 트리거는 업 상태에서 다운 상태로 전환되는 VM입니다. 플랫폼 원격 분석에서 이러한 전환을 식별하는 것은 대부분의 시나리오에서 간단하지만 디바이스 오류 또는 전원 손실로 인해 플랫폼 원격 분석이 손실될 수 있는 특정 종류의 인프라 오류와 관련하여 더 복잡합니다. 이러한 오류 클래스를 처리하기 위해 VM 상태 전환의 가능한 표시로 데이터 손실을 추적하는 것과 같은 다른 기술이 필요합니다&mdash;. Azure Data Explorer 이 계열 분석 시 뛰어난 기능을 제공하며, 이에 대한 자세한 내용은 Microsoft 기술 Community: <a href=\"https://techcommunity.microsoft.com/t5/azure-data-explorer/calculating-downtime-using-window-functions-and-time-series/ba-p/1345430\" target=\"_blank\">Azure Data Explorer Window 함수 및 시계열 함수를 사용하여 가동 중지 시간 계산에서</a> 찾을 수 있습니다.</p>\n\n<h3>2단계: 상관 관계 분석</h3>\n\n<p>트리거 이벤트가 정의되면(이 경우 VM이 비정상 상태로 전환됨) 다음 단계는 상관 관계 분석입니다. 이 단계에서는 트리거 이벤트의 존재를 사용하여 다음과 같이 Azure 플랫폼 전체의 지점에서 원격 분석을 상호 연결합니다.</p>\n\n<ul style=\"margin-left: 40px;\">\n    <li>Azure 호스트: VM을 호스팅하는 물리적 블레이드입니다.</li>\n    <li>TOR: 랙 네트워크 스위치의 위쪽입니다.</li>\n    <li>Azure Storage: Azure Virtual Machines 대한 Virtual Disks를 호스트하는 서비스입니다.</li>\n</ul>\n\n<p>이러한 각 시스템에는 VM 가동 중지 시간 트리거 이벤트와 구문 분석 및 상관 관계를 설정해야 하는 자체 원격 분석 피드가 있습니다. 이 작업은 VM 및 VM이 실패할 수 있는 기본 시스템에 대한 종속성 그래프를 이해한 다음, 이러한 모든 종속 시스템&rsquo; 상태 원격 분석을 함께 조인하여 시간에 따라 VM 전환에 상대적으로 가까운 이벤트를 필터링하여 수행합니다. Azure Data Explorer&rsquo; 직관적이고 강력한 쿼리 언어를 사용하면 시간 <a href=\"https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/join-timewindow\" target=\"_blank\">범위 조</a>인과 같은 문서화된 패턴을 통해 임시 원격 분석 스트림의 상관 관계를 함께 지정하는 데 도움이 됩니다. 이 상관 관계 프로세스의 끝부분에는 VM 오류의 원인을 파악하는 데 유용할 수 있거나 유용한 정보를 가질 수 있는 모든 종속 시스템의 상관 관계가 있는 플랫폼 원격 분석을 사용하여 VM 가동 중지 시간 전환을 나타내는 데이터 세트가 있습니다.</p>\n\n<h3>3단계: 근본 원인 특성</h3>\n\n<p>프로세스의 다음 단계는 특성입니다. &rsquo;이제 모든 관련 데이터를 단일 데이터 세트에서 함께 수집했으므로 특성 규칙이 적용되어 정보를 해석하고 고객 관련 근본 원인 설명으로 변환합니다. TOR 오류의 원래 예제로 돌아가서 상관 관계 분석 후 해석할 흥미로운 정보가 많이 있을 수 있습니다. 예를 들어 Azure 호스트를 모니터링하는 시스템에는 이 시간 동안 호스트에 대한 연결이 끊어 되었음을 나타내는 로그가 있을 수 있습니다. 또한 가상 디스크 연결 문제와 관련된 신호와 오류에 대한 TOR 디바이스의 명시적 신호가 있을 수 있습니다. 이제 이러한 모든 정보가 검사되고 명시적 TOR 실패 신호가 근본 원인으로 다른 신호보다 우선 순위가 지정됩니다. 이 우선 순위 지정 프로세스와 그 뒤에 있는 규칙은 도메인 전문가와 함께 구성되고 Azure 플랫폼이 발전함에 따라 수정됩니다. 기계 학습 및 변칙 검색 메커니즘은 이러한 특성이 있는 근본 원인을 기반으로 하여 이러한 분류 규칙을 개선할 기회를 식별하고 이러한 오류 비율의 패턴 변경을 감지하여 <a href=\"https://azure.microsoft.com/blog/advancing-safe-deployment-with-aiops-introducing-gandalf/\" target=\"_blank\">안전한 배포 파이프라인</a>으로 다시 공급할 수 있도록 합니다.</p>\n\n<h3>4단계: RCA 게시</h3>\n\n<p>마지막 단계는 고객에게 표시되는 Azure 리소스 상태에 근본 원인을 게시하는 것입니다. 이 작업은 Azure <a href=\"https://azure.microsoft.com/en-us/services/functions/\" target=\"_blank\">Data Explorer</a> 처리된 근본 원인 데이터를 주기적으로 쿼리하고 결과를 리소스 상태 백 엔드로 내보내는 매우 간단한 Azure Functions 애플리케이션에서 수행됩니다. 정보 스트림에 다양한 데이터 지연이 발생할 수 있기 때문에 이 프로세스에서 RCA를 업데이트하여 원래 게시된 것이 더 구체적인 근본 원인으로 이어지는 더 나은 정보 원본을 반영할 수 있습니다.</p>\n\n<h2>앞으로 이동</h2>\n\n<p>고객과 파트너에게 영향을 미치는 문제의 근본 원인을 식별하고 전달하는 것은 시작에 불과합니다. 고객은 이러한 RCA를 가져와서 고객 및 동료와 공유해야 할 수 있습니다. 리소스 RCA를 보다 쉽게 식별하고 추적할 수 있을 뿐만 아니라 쉽게 공유할 수 있도록 이 작업을 빌드하려고 합니다. 이를 위해 백 엔드 변경 작업을 수행하여 리소스당 고유한 리소스 및 가동 중지 시간별 추적 ID를 생성하여 사용자에게 노출할 수 있으므로 가동 중지 시간을 해당 RCA에 쉽게 일치시킬 수 있습니다. 또한 더 쉽게 RCA를 전자 메일로 전송하고 결국 VM에 대한 RCA를 구독할 수 있도록 새로운 기능에 대해 노력하고 있습니다. 이렇게 하면 사용 불가 이벤트가 발생한 후 추가 작업이 필요하지 않은 상태에서 받은 편지함에서 직접 RCA에 등록할 수 있습니다.</p>\n"
}